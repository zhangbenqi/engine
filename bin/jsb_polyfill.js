!function t(e,i,n){function o(s,c){if(!i[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){var i=e[s][1][t];return o(i?i:t)},l,l.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){function n(t){if("object"!=typeof t)return t;try{return JSON.stringify(t)}catch(e){return""}}cc._LogInfos={ActionManager:{addAction:"cc.ActionManager.addAction(): action must be non-null",removeAction:"cocos2d: removeAction: Target not found",removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found"},configuration:{loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",loadConfigFile_2:"Please load the resource first : %s"},Director:{resume:"cocos2d: Director: Error in gettimeofday",setProjection:"cocos2d: Director: unrecognized projection",popToSceneStackLevel:"cocos2d: Director: unrecognized projection",popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",popScene:"running scene should not null",pushScene:"the scene should not null"},Array:{verifyType:"element type is wrong!"},deprecated:'"%s" is deprecated, please use "%s" instead.',Scheduler:{scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null"},Node:{getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",getRotation:"RotationX != RotationY. Don't know which one to return",getScale:"ScaleX != ScaleY. Don't know which one to return",addChild:"An Node can't be added as a child of itself.",addChild_2:"child already added. It can't be added again",addChild_3:"child must be non-null",removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",removeChildByTag:"argument tag is an invalid tag",removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",reumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",_arrayMakeObjectsPerformSelector:"Unknown callback function",reorderChild:"child must be non-null",runAction:"cc.Node.runAction(): action must be non-null",schedule:"callback function must be non-null",schedule_2:"interval must be positive",initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_requestDirtyFlag:"_ccsg.Node._requestDirtyFlag: failed to satisfy the request, key (%s) for flag have already been taken"},AtlasNode:{_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",_initWithTileFile:"",_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture."},_checkEventListenerAvailable:{keyboard:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",touchOneByOne:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",touchAllAtOnce:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",acceleration:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil"},EventListener:{create:"Invalid parameter."},__getListenerID:"Don't call this method if the event is for touch.",LayerMultiplex:{initWithLayers:"parameters should not be ending with null in Javascript",switchTo:"Invalid index in MultiplexLayer switchTo message",switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",addLayer:"cc.Layer.addLayer(): layer should be non-null"},view:{setDesignResolutionSize:"Resolution not valid",setDesignResolutionSize_2:"should set resolutionPolicy"},inputManager:{handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s"},checkGLErrorDebug:"WebGL error %s",spriteFrameAnimationCache:{_addAnimationsWithDictionary:"cocos2d: cc.SpriteFrameAnimationCache: No animations were found in provided dictionary.",_addAnimationsWithDictionary_2:"cc.SpriteFrameAnimationCache. Invalid animation format",addAnimations:"cc.SpriteFrameAnimationCache.addAnimations(): File could not be found",_parseVersion1:"cocos2d: cc.SpriteFrameAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",_parseVersion1_2:"cocos2d: cc.SpriteFrameAnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",_parseVersion1_3:"cocos2d: cc.SpriteFrameAnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",_parseVersion1_4:"cocos2d: cc.SpriteFrameAnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",_parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",_parseVersion2_2:"cocos2d: cc.SpriteFrameAnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",addAnimations_2:"cc.SpriteFrameAnimationCache.addAnimations(): Invalid texture file name"},Sprite:{reorderChild:"cc.Sprite.reorderChild(): this child is not in children list",ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",_updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",initWithSpriteFrameName1:" is null, please check.",initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",reorderChild_2:"cc.Sprite.reorderChild(): child should be non-null",addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",addChild_3:"cc.Sprite.addChild(): child should be non-null",setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",setSpriteFrame:"Invalid spriteFrameName",setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null"},SpriteBatchNode:{addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",addChild_2:"cc.Sprite.addChild(): child should be non-null",setSpriteFrame:"Invalid spriteFrameName",setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null"},spriteFrameCache:{_getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",_checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",_getFrameConfig_2:"Please load the resource first : %s",addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",addSpriteFrames_3:"Argument must be non-nil"},TextureAtlas:{initWithFile:"cocos2d: Could not open file: %s",insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex"},textureCache:{addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",addPVRImage:"addPVRImage does not support on HTML5",addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",invalidKey:"TextureCache: url should be non-null"},Texture2D:{initWithETCFile:"initWithETCFile does not support on HTML5",initWithPVRFile:"initWithPVRFile does not support on HTML5",initWithPVRTCData:"initWithPVRTCData does not support on HTML5",addImage:"cc.Texture.addImage(): path should be non-null",initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",initWithString:"initWithString isn't supported on cocos2d-html5",initWithETCFile_2:"initWithETCFile does not support on HTML5",initWithPVRFile_2:"initWithPVRFile does not support on HTML5",initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",_initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",addImage_2:"cc.Texture.addImage(): path should be non-null",initWithData:"NSInternalInconsistencyException"},MissingFile:"Missing file: %s",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager:{addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",removeListeners:"Invalid listener type!",setPriority:"Can't set fixed priority with scene graph based listener.",addListener_2:"Invalid parameters.",addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",addListener_4:"The listener has been registered, please don't register it again.",_forceAddEventListener:"Invalid scene graph priority!",_updateListeners:"If program goes here, there should be event in dispatch.",_updateListeners_2:"_inDispatch should be 1 here."}},cc._logToWebPage=function(t){if(cc._canvas){var e=cc._logList,i=document;if(!e){var n=i.createElement("Div"),o=n.style;n.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",cc._canvas.height),o.zIndex="99999",o.position="absolute",o.top="0",o.left="0",e=cc._logList=i.createElement("textarea");var r=e.style;e.setAttribute("rows","20"),e.setAttribute("cols","30"),e.setAttribute("disabled",!0),n.appendChild(e),r.backgroundColor="transparent",r.borderBottom="1px solid #cccccc",r.borderRightWidth="0px",r.borderLeftWidth="0px",r.borderTopWidth="0px",r.borderTopStyle="none",r.borderRightStyle="none",r.borderLeftStyle="none",r.padding="0px",r.margin=0}e.value=e.value+t+"\r\n",e.scrollTop=e.scrollHeight}};var o=t("./cocos2d/core/value-types/CCEnum");cc.DebugMode=o({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});var r=cc.log||console.log;cc._initDebugSetting=function(t){if(cc.log=cc.warn=cc.error=cc._throw=cc.assert=function(){},t!==cc.DebugMode.NONE){console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(t,e){if(!t&&e){for(var i=2;i<arguments.length;i++)e=e.replace(/(%s)|(%d)/,n(arguments[i]));throw new Error(e)}},t!==cc.DebugMode.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=function(){return console.warn.apply(console,arguments)}),t===cc.DebugMode.INFO&&(cc.log=r,cc.info=function(){(console.info||console.log).apply(console,arguments)})),cc._throw=function(t){var e=t.stack;e?cc.error(t+"\n"+e):cc.error(t)}}}},{"./cocos2d/core/value-types/CCEnum":132}],2:[function(t,e,i){cc.Action=cc._Class.extend({ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(t){cc.log("[Action step]. override me")},update:function(t){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){if(!t)throw new Error("cc.Speed.initWithAction(): action must be non nil");return this._innerAction=t,this._speed=e,!0},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();return i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(t){var e=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO),n=cc.pSub(e,i),o=this.target.parent.convertToNodeSpaceAR(cc.pAdd(n,this._halfScreenSize));if(this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(cc.clampf(o.x,this.leftBoundary,this.rightBoundary),cc.clampf(o.y,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(o.x,o.y)},isDone:function(){return!this._followedNode.isRunning()},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)}},{}],3:[function(t,e,i){function n(t){for(var e=[],i=t.length-1;i>=0;i--)e.push(cc.p(t[i].x,t[i].y));return e}function o(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.p(t[i].x,t[i].y));return e}cc.cardinalSplineAt=function(t,e,i,n,o,r){var s=r*r,c=s*r,a=(1-o)/2,h=a*(-c+2*s-r),l=a*(-c+s)+(2*c-3*s+1),u=a*(c-2*s+r)+(-2*c+3*s),d=a*(c-s),p=t.x*h+e.x*l+i.x*u+n.x*d,_=t.y*h+e.y*l+i.y*u+n.y*d;return cc.p(p,_)},cc.getControlPointAt=function(t,e){var i=Math.min(t.length-1,Math.max(e,0));return t[i]},cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(!e||0===e.length)throw new Error("Invalid configuration. It must at least have one control point");return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this.setPoints(e),this._tension=i,!0):!1},clone:function(){var t=new cc.CardinalSplineTo;return t.initWithDuration(this._duration,o(this._points),this._tension),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(t){t=this._computeEaseTime(t);var e,i,n=this._points;if(1===t)e=n.length-1,i=1;else{var o=this._deltaT;e=0|t/o,i=(t-o*e)/o}var r=cc.cardinalSplineAt(cc.getControlPointAt(n,e-1),cc.getControlPointAt(n,e-0),cc.getControlPointAt(n,e+1),cc.getControlPointAt(n,e+2),this._tension,i);if(cc.macro.ENABLE_STACKABLE_ACTIONS){var s,c;if(s=this.target.getPositionX()-this._previousPosition.x,c=this.target.getPositionY()-this._previousPosition.y,0!==s||0!==c){var a=this._accumulatedDiff;s=a.x+s,c=a.y+c,a.x=s,a.y=c,r.x+=s,r.y+=c}}this.updatePosition(r)},reverse:function(){var t=n(this._points);return cc.cardinalSplineTo(this._duration,t,this._tension)},updatePosition:function(t){this.target.setPosition(t),this._previousPosition=t},getPoints:function(){return this._points},setPoints:function(t){this._points=t}}),cc.cardinalSplineTo=function(t,e,i){return new cc.CardinalSplineTo(t,e,i)},cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(t,e,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void 0!==i&&this.initWithDuration(t,e,i)},startWithTarget:function(t){cc.CardinalSplineTo.prototype.startWithTarget.call(this,t),this._startPosition.x=t.getPositionX(),this._startPosition.y=t.getPositionY()},reverse:function(){for(var t,e=this._points.slice(),i=e[0],o=1;o<e.length;++o)t=e[o],e[o]=cc.pSub(t,i),i=t;var r=n(e);i=r[r.length-1],r.pop(),i.x=-i.x,i.y=-i.y,r.unshift(i);for(var o=1;o<r.length;++o)t=r[o],t.x=-t.x,t.y=-t.y,t.x+=i.x,t.y+=i.y,r[o]=t,i=t;return cc.cardinalSplineBy(this._duration,r,this._tension)},updatePosition:function(t){var e=this._startPosition,i=t.x+e.x,n=t.y+e.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var t=new cc.CardinalSplineBy;return t.initWithDuration(this._duration,o(this._points),this._tension),t}}),cc.cardinalSplineBy=function(t,e,i){return new cc.CardinalSplineBy(t,e,i)},cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomTo;return t.initWithDuration(this._duration,o(this._points)),t}}),cc.catmullRomTo=function(t,e){return new cc.CatmullRomTo(t,e)},cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(t,e){cc.CardinalSplineBy.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomBy;return t.initWithDuration(this._duration,o(this._points)),t}}),cc.catmullRomBy=function(t,e){return new cc.CatmullRomBy(t,e)}},{}],4:[function(t,e,i){cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ActionEase.initWithAction(): action must be non nil");return this.initWithDuration(t.getDuration())?(this._inner=t,!0):!1},clone:function(){var t=new cc.ActionEase;return t.initWithAction(this._inner.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(t){return new cc.ActionEase(t)},cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},setRate:function(t){this._rate=t},getRate:function(){return this._rate},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t)?(this._rate=e,!0):!1},clone:function(){var t=new cc.EaseRateAction;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(t,e){return new cc.EaseRateAction(t,e)},cc.EaseIn=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseIn;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseOut;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(t){t*=2,1>t?this._inner.update(.5*Math.pow(t,this._rate)):this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var t=new cc.EaseInOut;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.easeInOut=function(t){return{_rate:t,easing:function(t){return t*=2,1>t?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInObj={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:-Math.pow(2,-10*t)+1)},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialOutObj={easing:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(t){1!==t&&0!==t&&(t*=2,t=1>t?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)),this._inner.update(t)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialInOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeExponentialInOutObj={easing:function(t){return 1!==t&&0!==t?(t*=2,1>t?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)):t},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var t=new cc.EaseSineIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineInObj={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var t=new cc.EaseSineOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeSineOutObj={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var t=new cc.EaseSineInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc._easeSineInOutObj={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return this._period},setPeriod:function(t){this._period=t},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t),this._period=null==e?.3:e,!0},reverse:function(){return cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var t=new cc.EaseElastic;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticIn=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;t-=1,e=-Math.pow(2,10*t)*Math.sin((t-i)*Math.PI*2/this._period)}this._inner.update(e)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticIn;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticInObj={easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;e=Math.pow(2,-10*t)*Math.sin((t-i)*Math.PI*2/this._period)+1;
}this._inner.update(e)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc._easeElasticOutObj={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t=2*t,i||(i=this._period=.3*1.5);var n=i/4;t-=1,e=0>t?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticInOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.easeElasticInOut=function(t){return t=t||.3,{_period:t,easing:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t=2*t,i||(i=this._period=.3*1.5);var n=i/4;t-=1,e=0>t?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}return e},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?(t-=1.5/2.75,7.5625*t*t+.75):2.5/2.75>t?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},clone:function(){var t=new cc.EaseBounce;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounceIn=cc.EaseBounce.extend({update:function(t){var e=1-this.bounceTime(1-t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceIn;return t.initWithAction(this._inner.clone()),t}}),cc._bounceTime=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?(t-=1.5/2.75,7.5625*t*t+.75):2.5/2.75>t?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},cc._easeBounceInObj={easing:function(t){return 1-cc._bounceTime(1-t)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(t){var e=this.bounceTime(t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBounceOutObj={easing:function(t){return cc._bounceTime(t)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(t){var e=0;.5>t?(t=2*t,e=.5*(1-this.bounceTime(1-t))):e=.5*this.bounceTime(2*t-1)+.5,this._inner.update(e)},clone:function(){var t=new cc.EaseBounceInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc._easeBounceInOutObj={easing:function(t){var e;return.5>t?(t=2*t,e=.5*(1-cc._bounceTime(1-t))):e=.5*cc._bounceTime(2*t-1)+.5,e},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(t){var e=1.70158;t=0===t||1===t?t:t*t*((e+1)*t-e),this._inner.update(t)},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBackIn;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackInObj={easing:function(t){var e=1.70158;return 0===t||1===t?t:t*t*((e+1)*t-e)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(t){var e=1.70158;t-=1,this._inner.update(t*t*((e+1)*t+e)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBackOut;return t.initWithAction(this._inner.clone()),t}}),cc._easeBackOutObj={easing:function(t){var e=1.70158;return t-=1,t*t*((e+1)*t+e)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(t){var e=2.5949095;t=2*t,1>t?this._inner.update(t*t*((e+1)*t-e)/2):(t-=2,this._inner.update(t*t*((e+1)*t+e)/2+1))},clone:function(){var t=new cc.EaseBackInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc._easeBackInOutObj={easing:function(t){var e=2.5949095;return t=2*t,1>t?t*t*((e+1)*t-e)/2:(t-=2,t*t*((e+1)*t+e)/2+1)},reverse:function(){return cc._easeBackInOutObj}},cc.easeBackInOut=function(){return cc._easeBackInOutObj},cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,o){return Math.pow(1-o,3)*t+3*o*Math.pow(1-o,2)*e+3*Math.pow(o,2)*(1-o)*i+Math.pow(o,3)*n},update:function(t){var e=this._updateTime(this._p0,this._p1,this._p2,this._p3,t);this._inner.update(e)},clone:function(){var t=new cc.EaseBezierAction;return t.initWithAction(this._inner.clone()),t.setBezierParamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var t=new cc.EaseBezierAction(this._inner.reverse());return t.setBezierParamer(this._p3,this._p2,this._p1,this._p0),t},setBezierParamer:function(t,e,i,n){this._p0=t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.easeBezierAction=function(t,e,i,n){return{easing:function(o){return cc.EaseBezierAction.prototype._updateTime(t,e,i,n,o)},reverse:function(){return cc.easeBezierAction(n,i,e,t)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(t){return Math.pow(t,2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionOut;return t.initWithAction(),t},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(t){var e=t;return t*=2,1>t?e=t*t*.5:(--t,e=-.5*(t*(t-2)-1)),e},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,-(t*t*t*t-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t=2*t,1>t?.5*t*t*t*t:(t-=2,-.5*(t*t*t*t-2))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,t*t*t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t=2*t,1>t?.5*t*t*t*t*t:(t-=2,.5*(t*t*t*t*t+2))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,Math.sqrt(1-t*t)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t=2*t,1>t?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t=2*t,1>t?.5*t*t*t:(t-=2,.5*(t*t*t+2))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut}},{}],5:[function(t,e,i){cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i){var n=e[i];n.enabled=!0}},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Hide=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i){var n=e[i];n.enabled=!1}},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.ToggleVisibility=cc.ActionInstant.extend({update:function(t){for(var e=this.target.getComponentsInChildren(cc._SGComponent),i=0;i<e.length;++i){var n=e[i];n.enabled=!n.enabled}},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.init(t)},update:function(t){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(t){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(t){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==t&&(void 0!==t.x&&(e=t.y,t=t.x),this.initWithPosition(t,e))},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return t&&(this._function=t),e&&(this._selectorTarget=e),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(t){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){t!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)}},{}],6:[function(t,e,i){cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.macro.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(t){this._easeList?this._easeList.length=0:this._easeList=[];for(var e=0;e<arguments.length;e++)this._easeList.push(arguments[e]);return this},_computeEaseTime:function(t){var e=this._easeList;if(!e||0===e.length)return t;for(var i=0,n=e.length;n>i;i++)t=e[i].easing(t);return t},step:function(t){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=t;var e=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(t){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),0},speed:function(t){return 0>=t?(cc.log("The speed parameter error"),this):(this._speedMethod=!0,this._speed*=t,this)},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){return t=Math.round(t),isNaN(t)||1>t?(cc.log("The repeat parameter error"),this):(this._repeatMethod=!0,this._timesForRepeat*=t,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var e=t instanceof Array?t:arguments,i=e.length-1;if(i>=0&&null==e[i]&&cc.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,o=e[0],r=1;i>r;r++)e[r]&&(n=o,o=cc.Sequence._actionOneTwo(n,e[r]));this.initWithTwoActions(o,e[i])}},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");var i=t._duration+e._duration;return this.initWithDuration(i),this._actions[0]=t,this._actions[1]=e,!0},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var e,i,n=0,o=this._split,r=this._actions,s=this._last;t=this._computeEaseTime(t),o>t?(e=0!==o?t/o:1,0===n&&1===s&&(r[1].update(0),r[1].stop())):(n=1,e=1===o?1:(t-o)/(1-o),-1===s&&(r[0].startWithTarget(this.target),r[0].update(1),r[0].stop()),s||(r[0].update(1),r[0].stop())),i=r[n],s===n&&i.isDone()||(s!==n&&i.startWithTarget(this.target),e*=i._timesForRepeat,i.update(e>1?e%1:e),this._last=n)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments;e.length>0&&null==e[e.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i,n,o,r;e&&e.length>0;)for(n=Array.prototype.shift.call(e),r=n._timesForRepeat||1,n._repeatMethod=!1,n._timesForRepeat=1,o=0,i||(i=n,o=1),o;r>o;o++)i=cc.Sequence._actionOneTwo(i,n);return i},cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){var i=t._duration*e;return this.initWithDuration(i)?(this._times=e,this._innerAction=t,t instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0):!1},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,o=this._nextDt;if(t>=o){for(;t>o&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),o+=e._duration/i,this._nextDt=o;t>=1&&this._total<n&&(e.update(1),this._total++),this._actionInstant||(this._total===n?e.stop():e.update(t-(o-e._duration/i)))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.RepeatForever.initWithAction(): action must be non null");return this._innerAction=t,!0},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var e=t instanceof Array?t:arguments,i=e.length-1;if(i>=0&&null==e[i]&&cc.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,o=e[0],r=1;i>r;r++)e[r]&&(n=o,o=cc.Spawn._actionOneTwo(n,e[r]));this.initWithTwoActions(o,e[i])}},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");var i=!1,n=t._duration,o=e._duration;return this.initWithDuration(Math.max(n,o))&&(this._one=t,this._two=e,n>o?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-o)):o>n&&(this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(o-n))),i=!0),i},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;e.length>0&&null==e[e.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.Spawn._actionOneTwo(i,e[n]));return i},cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._dstAngleX=e||0,this._dstAngleY=i||this._dstAngleX,!0):!1},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.rotationX%360,i=this._dstAngleX-e;i>180&&(i-=360),-180>i&&(i+=360),this._startAngleX=e,this._diffAngleX=i,this._startAngleY=t.rotationY%360;var n=this._dstAngleY-this._startAngleY;n>180&&(n-=360),-180>n&&(n+=360),this._diffAngleY=n},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*t,this.target.rotationY=this._startAngleY+this._diffAngleY*t)}}),cc.rotateTo=function(t,e,i){return new cc.RotateTo(t,e,i)},cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._angleX=e||0,this._angleY=i||this._angleX,!0):!1},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angleX,this._angleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngleX=t.rotationX,this._startAngleY=t.rotationY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t)},reverse:function(){var t=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e,i){return new cc.RotateBy(t,e,i)},cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(void 0!==e.x&&(i=e.y,e=e.x),this._positionDelta.x=e,this._positionDelta.y=i,!0):!1},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._positionDelta.x*t,i=this._positionDelta.y*t,n=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var o=this.target.getPositionX(),r=this.target.getPositionY(),s=this._previousPosition;n.x=n.x+o-s.x,n.y=n.y+r-s.y,e+=n.x,i+=n.y,s.x=e,s.y=i,this.target.setPosition(e,i)}else this.target.setPosition(n.x+e,n.y+i)}},reverse:function(){var t=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)?(void 0!==e.x&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0):!1},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endSkewX=e,this._endSkewY=i,n=!0),n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),
this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewBy=cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)&&(this._skewX=e,this._skewY=i,n=!0),n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,o){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,o)},initWithDuration:function(t,e,i,n,o){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(void 0===o&&(o=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=o,!0):!1},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=t*this._jumps%1,i=4*this._height*e*(1-e);i+=this._delta.y*t;var n=this._delta.x*t,o=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),s=this.target.getPositionY(),c=this._previousPosition;o.x=o.x+r-c.x,o.y=o.y+s-c.y,n+=o.x,i+=o.y,c.x=n,c.y=i,this.target.setPosition(n,i)}else this.target.setPosition(o.x+n,o.y+i)}},reverse:function(){var t=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,o){return new cc.JumpBy(t,e,i,n,o)},cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,o){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,o)},initWithDuration:function(t,e,i,n,o){return cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,o)?(void 0===o&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0):!1},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,o){return new cc.JumpTo(t,e,i,n,o)},cc.bezierAt=function(t,e,i,n,o){return Math.pow(1-o,3)*t+3*o*Math.pow(1-o,2)*e+3*Math.pow(o,2)*(1-o)*i+Math.pow(o,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._config=e,!0):!1},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.p(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._config,i=0,n=e[0].x,o=e[1].x,r=e[2].x,s=0,c=e[0].y,a=e[1].y,h=e[2].y,l=cc.bezierAt(i,n,o,r,t),u=cc.bezierAt(s,c,a,h,t),d=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var p=this.target.getPositionX(),_=this.target.getPositionY(),f=this._previousPosition;d.x=d.x+p-f.x,d.y=d.y+_-f.y,l+=d.x,u+=d.y,f.x=l,f.y=u,this.target.setPosition(l,u)}else this.target.setPosition(d.x+l,d.y+u)}},reverse:function(){var t=this._config,e=[cc.pAdd(t[1],cc.pNeg(t[2])),cc.pAdd(t[0],cc.pNeg(t[2])),cc.pNeg(t[2])],i=new cc.BezierBy(this._duration,e);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._toConfig=e,!0):!1},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t);var e=this._startPosition,i=this._toConfig,n=this._config;n[0]=cc.pSub(i[0],e),n[1]=cc.pSub(i[1],e),n[2]=cc.pSub(i[2],e)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._endScaleX=e,this._endScaleY=null!=i?i:e,!0):!1},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._times=e,!0):!1},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){if(t=this._computeEaseTime(t),this.target&&!this.isDone()){var e=1/this._times,i=t%e;this.target.opacity=i>e/2?255:0}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._toOpacity=e,!0):!1},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeOut=cc.FadeTo.extend({ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),e instanceof cc.Color&&(n=e.b,i=e.g,e=e.r),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._to=cc.color(e,i,n),!0):!1},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return cc.ActionInterval.prototype.initWithDuration.call(this,t)?(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0):!1},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)?(this._other=t,!0):!1},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,o=e/t.getTotalDelayUnits(),r=t.getFrames();cc.js.array.verifyType(r,cc.AnimationFrame);for(var s=0;s<r.length;s++){var c=r[s],a=n*o/e;n+=c.getDelayUnits(),i.push(a)}return!0}return!1},clone:function(){var t=new cc.Animate;return this._cloneDecoration(t),t.initWithAnimation(this._animation.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._animation.getRestoreOriginalFrame()&&(this._origFrame=t.displayFrame()),this._nextFrame=0,this._executedLoops=0},update:function(t){if(t=this._computeEaseTime(t),1>t){t*=this._animation.getLoops();var e=0|t;e>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),t%=1}for(var i=this._animation.getFrames(),n=i.length,o=this._splitTimes,r=this._nextFrame;n>r&&o[r]<=t;r++)_currFrameIndex=r,this.target.setSpriteFrame(i[_currFrameIndex].getSpriteFrame()),this._nextFrame=r+1},reverse:function(){var t=this._animation,e=t.getFrames(),i=[];if(cc.js.array.verifyType(e,cc.AnimationFrame),e.length>0)for(var n=e.length-1;n>=0;n--){var o=e[n];if(!o)break;i.push(o.clone())}var r=new cc.SpriteFrameAnimation(i,t.getDelayPerUnit(),t.getLoops());r.setRestoreOriginalFrame(t.getRestoreOriginalFrame());var s=new cc.Animate(r);return this._cloneDecoration(s),this._reverseEaseList(s),s},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return this.initWithDuration(e._duration)?(this._forcedTarget=t,this._action=e,!0):!1},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)}},{}],7:[function(t,e,i){t("./CCAction.js"),t("./CCActionInterval.js"),t("./CCActionInstant.js"),t("./CCActionEase.js"),t("./CCActionCatmullRom.js")},{"./CCAction.js":2,"./CCActionCatmullRom.js":3,"./CCActionEase.js":4,"./CCActionInstant.js":5,"./CCActionInterval.js":6}],8:[function(t,e,i){function n(t,e){c.call(this,t),this.animation=e}function o(t){var e=t.split(".");return e.shift(),e.length>0?e:null}function r(t,e){function i(t){if(!Array.isArray(t))return!1;for(var e=0,i=t.length;i>e;e++){var n=t[e];if(!Array.isArray(n)||6!==n.length)return!1}return!0}function n(t,n,r){var c,u=t instanceof cc.Node&&"position"===n,d=[];c=u?new h:new a,c.target=t;var p,_,f=n.indexOf("."),g=-1!==f;g?(p=n.slice(0,f),_=t[p]):p=n,c.prop=p,c.subProps=o(n);for(var v=0,m=r.length;m>v;v++){var y=r[v],C=y.frame/e.duration;if(c.ratios.push(C),u){var T=y.motionPath;T&&!i(T)&&(cc.error("motion path of target ["+t.name+"] in prop ["+n+"] frame ["+v+"] is not valid"),T=null),d.push(T)}var b=y.value;c.values.push(b);var E=y.curve;if(E){if("string"==typeof E){c.types.push(E);continue}if(Array.isArray(E)){E[0]===E[1]&&E[2]===E[3]?c.types.push(a.Linear):c.types.push(a.Bezier(E));continue}}c.types.push(a.Linear)}return u&&l(d,c,s.duration,s.sample),c}function r(t,e){var i=e.props,o=e.comps;if(i)for(var r in i){var s=i[r],a=n(t,r,s);c.push(a)}if(o)for(var h in o){var l=t.getComponent(h);if(l){var u=o[h];for(var r in u){var s=u[r],a=n(l,r,s);c.push(a)}}}}var s=e.clip,c=e.curves;c.length=0,e.duration=s.duration,e.speed=s.speed,e.wrapMode=s.wrapMode,e.frameRate=s.sample,(e.wrapMode&p.Loop)===p.Loop?e.repeatCount=1/0:e.repeatCount=1;var f=s.curveData,g=f.paths;r(t,f);for(var v in g){var m=cc.find(v,t);if(m){var y=g[v];r(m,y)}}var C=s.events;if(C)for(var T,b=0,E=C.length;E>b;b++){T||(T=new u,T.target=t,c.push(T));var S,A=C[b],x=A.frame/e.duration,O=_(T.ratios,x);O>=0?S=T.events[O]:(S=new d,T.ratios.push(x),T.events.push(S)),S.add(A.func,A.params)}}var s=cc.js,c=t("./animators").Animator,a=t("./animation-curves").DynamicAnimCurve,h=t("./animation-curves").SampledAnimCurve,l=t("./motion-path-helper").sampleMotionPaths,u=t("./animation-curves").EventAnimCurve,d=t("./animation-curves").EventInfo,p=t("./types").WrapModeMask,_=t("./binary-search");s.extend(n,c);var f=n.prototype;f.playState=function(t,e){t.clip&&(t.curveLoaded||r(this.target,t),this.addAnimation(t),t.animator=this,t.play(),"number"==typeof e&&t.setTime(e),this.play())},f.addAnimation=function(t){c.prototype.addAnimation.call(this,t);for(var e=this.animation._listeners,i=0,n=e.length;n>i;i++){var o=e[i];t.on(o[0],o[1],o[2],o[3])}},f.removeAnimation=function(t){c.prototype.removeAnimation.call(this,t),t.animator=null},f.sample=function(){for(var t=this.playingAnims,e=0;e<t.length;e++){var i=t[e];i.sample()}},f.stopState=function(t){t&&t.stop()},f.pauseState=function(t){t&&t.pause()},f.resumeState=function(t){t&&t.resume(),this.isPaused&&this.resume()},f.setStateTime=function(t,e){t&&t.setTime(e)},f.onStop=function(){for(var t=this.playingAnims,e=t.length-1;e>=0;e--)t[e].stop();c.prototype.onStop.call(this)},f.onPause=function(){for(var t=this.playingAnims,e=0,i=t.length;i>e;e++)t[e].pause()},f.onResume=function(){for(var t=this.playingAnims,e=0,i=t.length;i>e;e++)t[e].resume()},f._reloadClip=function(t){r(this.target,t)},e.exports=n},{"./animation-curves":10,"./animators":13,"./binary-search":15,"./motion-path-helper":18,"./types":20}],9:[function(t,e,i){var n=cc.Class({name:"cc.AnimationClip","extends":cc.Asset,properties:{_duration:{"default":0,type:"Float"},duration:{get:function(){return this._duration}},sample:{"default":60},speed:{"default":1},wrapMode:{"default":cc.WrapMode.Normal},curveData:{"default":{},visible:!1},events:{"default":[],visible:!1}},statics:{createWithSpriteFrames:function(t,e){if(!Array.isArray(t))return cc.error("sprite frames must be an Array."),null;var i=new n;i.sample=e||i.sample,i._duration=t.length/i.sample;for(var o=[],r=1/i.sample,s=0,c=t.length;c>s;s++)o[s]={frame:s*r,value:t[s]};return i.curveData={comps:{"cc.Sprite":{spriteFrame:o}}},i}}});cc.AnimationClip=e.exports=n},{}],10:[function(t,e,i){function n(t,e){if("string"==typeof e){var i=cc.Easing[e];i?t=i(t):cc.error("Can't find easing type ["+e+"]")}else Array.isArray(e)&&(t=o(e,t));return t}var o=t("./bezier").bezierByTime,r=t("./binary-search"),s=t("./types").WrapModeMask,c=cc.Class({name:"cc.AnimCurve",sample:function(t,e,i){},onTimeChangedManually:function(){}}),a=cc.Class({name:"cc.DynamicAnimCurve","extends":c,properties:{target:null,prop:"",values:[],ratios:[],types:[],subProps:null},_calcValue:function(t,e){var i,n=this.values,o=n[t-1],r=n[t];return i="number"==typeof o?o+(r-o)*e:o&&o.lerp?o.lerp(r,e):o},_applyValue:function(t,e,i){t[e]=i},_findFrameIndex:r,sample:function(t,e,i){var o=this.values,r=this.ratios,s=r.length;if(0!==s){var c,a=this._findFrameIndex(r,e);if(0>a)if(a=~a,0>=a)c=o[0];else if(a>=s)c=o[s-1];else{var h=r[a-1],l=r[a],u=this.types[a-1],d=(e-h)/(l-h);d=n(d,u),c=this._calcValue(a,d)}else c=o[a];var p=this.subProps;if(p){for(var _=this.target[this.prop],f=_,g=0;g<p.length-1;g++){var v=p[g];if(!f)return;f=f[v]}var m=p[p.length-1];if(!f)return;this._applyValue(f,m,c),c=_}this._applyValue(this.target,this.prop,c)}}});a.Linear=null,a.Bezier=function(t){return t};var h=cc.Class({name:"cc.SampledAnimCurve","extends":a,_findFrameIndex:function(t,e){var i=t.length-1;if(0===i)return 0;var n=t[0];if(n>e)return 0;var o=t[i];if(e>o)return i;e=(e-n)/(o-n);var r=1/i,s=e/r,c=0|s,a=1e-6;return a>s-c?c:~(c+1)}}),l=function(){this.events=[]};l.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var u=cc.Class({name:"cc.EventAnimCurve","extends":c,properties:{target:null,ratios:[],events:[],_lastWrappedInfo:null,_ignoreIndex:NaN},_wrapIterations:function(t){return t-(0|t)===0&&(t-=1),0|t},sample:function(t,e,i){var n=this.ratios.length,o=i.getWrappedInfo(i.time),c=o.direction,a=r(this.ratios,o.ratio);0>a&&(a=~a-1,0>c&&(a+=1)),this._ignoreIndex!==a&&(this._ignoreIndex=NaN);var h=this._lastWrappedInfo;if(o.frameIndex=a,this._lastWrappedInfo=o,!h)return void this._fireEvent(a);var l=h.frameIndex,u=i.wrapMode,d=this._wrapIterations(o.iterations),p=this._wrapIterations(h.iterations),_=-1!==p&&d!==p;if(l===a&&_&&1===n)this._fireEvent(0);else if(l!==a||_){c=h.direction;do{if(l!==a){if(-1===c&&0===l&&a>0?((u&s.PingPong)===s.PingPong?c*=-1:l=n,p++):1===c&&l===n-1&&n-1>a&&((u&s.PingPong)===s.PingPong?c*=-1:l=-1,p++),l===a)break;if(p>d)break}l+=c,cc.director.getAnimationManager().pushDelayEvent(this,"_fireEvent",[l])}while(l!==a&&l>-1&&n>l)}},_fireEvent:function(t){if(!(0>t||t>=this.events.length||this._ignoreIndex===t))for(var e=this.events[t],i=e.events,n=this.target._components,o=0;o<i.length;o++)for(var r=i[o],s=r.func,c=0;c<n.length;c++){var a=n[c],h=a[s];h&&h.apply(a,r.params)}},onTimeChangedManually:function(t,e){this._lastWrappedInfo=null,this._ignoreIndex=NaN;var i=e.getWrappedInfo(t),n=i.direction,o=r(this.ratios,i.ratio);0>o&&(o=~o-1,0>n&&(o+=1),this._ignoreIndex=o)}});e.exports={AnimCurve:c,DynamicAnimCurve:a,SampledAnimCurve:h,EventAnimCurve:u,EventInfo:l,computeRatioByType:n}},{"./bezier":14,"./binary-search":15,"./types":20}],11:[function(t,e,i){var n=(cc.js,cc.Class({ctor:function(){this.animators=[],this.__instanceId=cc.ClassManager.getNewInstanceId(),this._updating=!1,this._removeList=[],this._delayEvents=[]},update:function(t){this._updating=!0;var e,i,n=this.animators;for(e=0,i=n.length;i>e;e++){var o=n[e];o._isPlaying&&!o._isPaused&&o.update(t)}this._updating=!1;var r=this._removeList;for(e=0,i=r.length;i>e;e++)this.removeAnimator(r[e]);r.length=0;var s=this._delayEvents;for(e=0,i=s.length;i>e;e++){var c=s[e];c.target[c.func].apply(c.target,c.args)}s.length=0},destruct:function(){},addAnimator:function(t){var e=this.animators.indexOf(t);-1===e&&this.animators.push(t),e=this._removeList.indexOf(t),-1!==e&&this._removeList.splice(e,1)},removeAnimator:function(t){var e=this.animators.indexOf(t);if(e>=0)if(this._updating){var i=this._removeList;-1===i.indexOf(t)&&i.push(t)}else this.animators.splice(e,1);else cc.error("animator not added or already removed")},pushDelayEvent:function(t,e,i){this._delayEvents.push({target:t,func:e,args:i})}}));cc.AnimationManager=e.exports=n},{}],12:[function(t,e,i){function n(t,e){r.call(this,null,null,{duration:t.length}),this._emit=this.emit,this.emit=function(){cc.director.getAnimationManager().pushDelayEvent(this,"_emit",arguments)},this._clip=t,this._name=e||t.name}var o=cc.js,r=t("./types").AnimationNode;o.extend(n,r);var s=n.prototype;o.get(s,"clip",function(){return this._clip}),o.get(s,"name",function(){return this._name}),o.obsolete(s,"AnimationState.length","duration"),o.getset(s,"curveLoaded",function(){return this.curves.length>0},function(){this.curves.length=0}),s.onPlay=function(){this.setTime(0),r.prototype.onPlay.call(this)},s.onStop=function(){r.prototype.onStop.call(this),this.animator&&this.animator.removeAnimation(this)},s.setTime=function(t){this.time=t||0;var e=this;this.curves.forEach(function(i){i.onTimeChangedManually(t,e)})},cc.AnimationState=e.exports=n},{"./types":20}],13:[function(t,e,i){function n(t){this.target=t,this.playingAnims=[],this._updating=!1,this._removeList=[]}function o(t){n.call(this,t)}function r(t){for(var e=0,i=0,n=t.length,o=0;n>o;o++){var r=t[o],s=r.ratio;if(0===o&&"number"!=typeof s?r.computedRatio=s=0:o===n-1&&"number"!=typeof s&&(r.computedRatio=s=1),"number"==typeof s){if(o>e+1)for(var c=o-e,a=(s-i)/c,h=e+1;o>h;h++)i+=a,t[h].computedRatio=i;e=o,i=s}}}function s(t,e,i){for(var n,o=0;o<t.length;o++)if(n=t[o],n.target===e&&n.prop===i)return n;return null}function c(t,e,i,n,o){var r=s(t,e,i);r||(r=new u,t.push(r),r.target=e,r.prop=i),r.values.push(n),r.ratios.push(o)}var a=cc.js,h=t("./playable"),l=t("./types").AnimationNode,u=t("./animation-curves").DynamicAnimCurve;a.extend(n,h);var d=n.prototype;d.update=function(t){this._updating=!0;var e,i,n=this.playingAnims,o=0;for(e=0,i=n.length;i>e;e++){var r=n[e];r._isPlaying&&!r._isPaused&&(r.update(t),r._isPlaying||o++)}this._updating=!1,(0===n.length||o>=n.length)&&this.stop();var s=this._removeList;for(e=0,i=s.length;i>e;e++)this.removeAnimation(s[e]);s.length=0},d.onPlay=function(){cc.director.getAnimationManager().addAnimator(this)},d.onStop=function(){cc.director.getAnimationManager().removeAnimator(this)},d.addAnimation=function(t){var e=this.playingAnims.indexOf(t);-1===e&&this.playingAnims.push(t),e=this._removeList.indexOf(t),-1!==e&&this._removeList.splice(e,1)},d.removeAnimation=function(t){var e=this.playingAnims.indexOf(t);if(e>=0)if(this._updating){var i=this._removeList;-1===i.indexOf(t)&&i.push(t)}else this.playingAnims.splice(e,1);else cc.error("animation not added or already removed")},a.extend(o,n);var p=o.prototype;p.animate=function(t,e){if(!t)return cc.error("[animate] keyFrames must be non-nil"),null;r(t);var i=this._doAnimate(t,e);return this.play(),i},p._doAnimate=function(t,e){var i=new l(this,null,e);i.play();for(var n=i.curves,o=-1,r=0;r<t.length;r++){var s=t[r],a=s.ratio;if("number"!=typeof a&&(a=s.computedRatio),0>a)cc.error("[animate] ratio should >= 0!");else if(o>a)cc.error("[animate] ratio should in the order of smallest to largest!");else{o=a;for(var h in s){var u=s[h];if("props"===h)for(var d in u)c(n,this.target,d,u[d],a);else if("comps"===h)for(var p in u){var _=this.target.getComponent(p),f=u[p];for(var d in f)c(n,_,d,f[d],a)}}}}return this.playingAnims.push(i),i},e.exports={Animator:n,EntityAnimator:o}},{"./animation-curves":10,"./playable":19,"./types":20}],14:[function(t,e,i){function n(t,e,i,n,o){var r=1-o;return t*r*r*r+3*e*r*r*o+3*i*r*o*o+n*o*o*o}function o(t){return 0>t?-Math.pow(-t,1/3):Math.pow(t,1/3)}function r(t,e){var i,n,r,s,l,p=e-0,_=e-t[0],f=e-t[2],g=e-1,v=3*p,m=3*_,y=3*f,C=-p+m-y+g,T=1/C,b=1/3,E=(v-6*_+y)*T,S=E*b,A=(-v+m)*T,x=p*T,O=(3*A-E*E)*b,N=O*b,w=(2*E*E*E-9*E*A+27*x)/27,I=w/2,P=I*I+N*N*N;if(0>P){var L=-O*b,R=L*L*L,M=d(R),F=-w/(2*M),B=-1>F?-1:F>1?1:F,D=a(B),z=o(M),k=2*z;return r=k*c(D*b)-S,s=k*c((D+u)*b)-S,l=k*c((D+2*u)*b)-S,r>=0&&1>=r?s>=0&&1>=s?l>=0&&1>=l?h(r,s,l):h(r,s):l>=0&&1>=l?h(r,l):r:s>=0&&1>=s?l>=0&&1>=l?h(s,l):s:l}if(0===P)return i=0>I?o(-I):-o(I),r=2*i-S,s=-i-S,r>=0&&1>=r?s>=0&&1>=s?h(r,s):r:s;var W=d(P);return i=o(-I+W),n=o(I+W),r=i-n-S}function s(t,e){var i=r(t,e),n=0,o=t[1],s=t[3],c=1,a=1-i;return n*a*a*a+3*o*i*a*a+3*s*i*i*a+c*i*i*i}var c=Math.cos,a=Math.acos,h=Math.max,l=Math.PI,u=2*l,d=Math.sqrt;e.exports={bezier:n,bezierByTime:s}},{}],15:[function(t,e,i){function n(t,e){for(var i=0,n=t.length-1;n>=i;){var r=i+n>>1;if(Math.abs(t[r]-e)<o)return r;t[r]>e?n=r-1:i=r+1}return~i}var o=1e-6;e.exports=n},{}],16:[function(t,e,i){function n(t,e){return function(i){return.5>i?e(2*i)/2:t(2*i-1)/2+.5}}var o={constant:function(){return 0},linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return 1-Math.cos(t*Math.PI/2)},sineOut:function(t){return Math.sin(t*Math.PI/2)},sineInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},expoIn:function(t){return 0===t?0:Math.pow(1024,t-1)},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)))},elasticOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1)},elasticInOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},bounceOut:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},smooth:function(t){return 0>=t?0:t>=1?1:t*t*(3-2*t)},fade:function(t){return 0>=t?0:t>=1?1:t*t*t*(t*(6*t-15)+10)}};o.quadOutIn=n(o.quadIn,o.quadOut),o.cubicOutIn=n(o.cubicIn,o.cubicOut),o.quartOutIn=n(o.quartIn,o.quartOut),o.quintOutIn=n(o.quintIn,o.quintOut),o.sineOutIn=n(o.sineIn,o.sineOut),o.expoOutIn=n(o.expoIn,o.expoOut),o.circOutIn=n(o.circIn,o.circOut),o.backOutIn=n(o.backIn,o.backOut),o.backOutIn=n(o.backIn,o.backOut),o.bounceIn=function(t){return 1-o.bounceOut(1-t)},o.bounceInOut=function(t){return.5>t?.5*o.bounceIn(2*t):.5*o.bounceOut(2*t-1)+.5;
},o.bounceOutIn=n(o.bounceIn,o.bounceOut),cc.Easing=e.exports=o},{}],17:[function(t,e,i){t("./bezier"),t("./easing"),t("./types"),t("./motion-path-helper"),t("./animation-curves"),t("./animation-clip"),t("./animators"),t("./animation-manager"),t("./animation-state"),t("./animation-animator")},{"./animation-animator":8,"./animation-clip":9,"./animation-curves":10,"./animation-manager":11,"./animation-state":12,"./animators":13,"./bezier":14,"./easing":16,"./motion-path-helper":18,"./types":20}],18:[function(t,e,i){function n(t){this.points=t||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function o(){this.start=l(),this.end=l(),this.startCtrlPoint=l(),this.endCtrlPoint=l()}function r(t,e,i,o){function r(t){return t instanceof cc.Vec2?{"in":t,pos:t,out:t}:Array.isArray(t)&&6===t.length?{"in":l(t[2],t[3]),pos:l(t[0],t[1]),out:l(t[4],t[5])}:{"in":cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}function a(t,e,i){_.push(t),f.push(e),g.push(i)}var u=e.values;if(0!==t.length&&0!==u.length){if(u=u.map(function(t){return l(t[0],t[1])}),1===u.length)return void(e.values=u);for(var d=e.types,p=e.ratios,_=e.values=[],f=e.types=[],g=e.ratios=[],v=0,m=1e-6,y=s.Linear,C=0,T=t.length;T-1>C;C++){var b,E=t[C],S=p[C],A=p[C+1],x=A-S,O=u[C],N=u[C+1],w=d[C],I=[],P=v/x,L=1/(x*i*o);if(E&&E.length>0){var R=[];R.push(r(O));for(var M=0,F=E.length;F>M;M++){var B=r(E[M]);R.push(B)}R.push(r(N));var D=new n(R);D.computeBeziers();for(var z=D.progresses;1-P>m;){b=P,b=c(b,w);var k,W,j,V;if(0>b)W=D.beziers[0],V=(0-b)*W.getLength(),j=W.start.sub(W.endCtrlPoint).normalize(),k=W.start.add(j.mul(V));else if(b>1)W=D.beziers[D.beziers.length-1],V=(b-1)*W.getLength(),j=W.end.sub(W.startCtrlPoint).normalize(),k=W.end.add(j.mul(V));else{var H=h(z,b);0>H&&(H=~H),b-=H>0?z[H-1]:0,b/=D.ratios[H],k=D.beziers[H].getPointAt(b)}I.push(k),P+=L}}else for(;1-P>m;)b=P,b=c(b,w),I.push(O.lerp(N,b)),P+=L;y="constant"===w?w:s.Linear;for(var M=0,F=I.length;F>M;M++){var U=S+v+L*M*x;a(I[M],y,U)}v=Math.abs(P-1)>m?(P-1)*x:0}p[p.length-1]!==g[g.length-1]&&a(u[u.length-1],y,p[p.length-1])}}var s=t("./animation-curves").DynamicAnimCurve,c=t("./animation-curves").computeRatioByType,a=t("./bezier").bezier,h=t("./binary-search"),l=cc.v2;n.prototype.computeBeziers=function(){this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var t,e=1;e<this.points.length;e++){var i=this.points[e-1],n=this.points[e];t=new o,t.start=i.pos,t.startCtrlPoint=i.out,t.end=n.pos,t.endCtrlPoint=n["in"],this.beziers.push(t),this.length+=t.getLength()}for(var r=0,e=0;e<this.beziers.length;e++)t=this.beziers[e],this.ratios[e]=t.getLength()/this.length,this.progresses[e]=r+=this.ratios[e];return this.beziers},o.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},o.prototype.getPoint=function(t){var e=a(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,t),i=a(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,t);return new l(e,i)},o.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},o.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1)return this.cacheArcLengths;var e,i,n=[],o=this.getPoint(0),r=0;for(n.push(0),i=1;t>=i;i++)e=this.getPoint(i/t),r+=cc.pDistance(e,o),n.push(r),o=e;return this.cacheArcLengths=n,n},o.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),o=0,r=n.length;i=e?e:t*n[r-1];for(var s,c=0,a=r-1;a>=c;)if(o=Math.floor(c+(a-c)/2),s=n[o]-i,0>s)c=o+1;else{if(!(s>0)){a=o;break}a=o-1}if(o=a,n[o]===i){var h=o/(r-1);return h}var l=n[o],u=n[o+1],d=u-l,p=(i-l)/d,h=(o+p)/(r-1);return h},e.exports={sampleMotionPaths:r,Curve:n,Bezier:o}},{"./animation-curves":10,"./bezier":14,"./binary-search":15}],19:[function(t,e,i){function n(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var o=cc.js,r=n.prototype;o.get(r,"isPlaying",function(){return this._isPlaying},!0),o.get(r,"isPaused",function(){return this._isPaused},!0);var s=function(){};r.onPlay=s,r.onPause=s,r.onResume=s,r.onStop=s,r.onError=s,r.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError("already-playing"):(this._isPlaying=!0,this.onPlay())},r.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1,this.onStop())},r.pause=function(){this._isPlaying&&(this._isPaused=!0,this.onPause())},r.resume=function(){this._isPlaying&&(this._isPaused=!1,this.onResume())},r.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},e.exports=n},{}],20:[function(t,e,i){function n(t,e,i){if(a.call(this),this.animator=t,this.curves=e||[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=c.Normal,i){this.delay=i.delay||this.delay;var n=i.duration;"undefined"!=typeof n&&(this.duration=n);var o=i.speed;"undefined"!=typeof o&&(this.speed=o);var r=i.wrapMode;if("undefined"!=typeof r){var h="number"==typeof r;h?this.wrapMode=r:this.wrapMode=c[r]}var l=i.repeatCount;"undefined"!=typeof l?this.repeatCount=l:this.wrapMode&s.Loop&&(this.repeatCount=1/0)}this.time=0,this._timeNoScale=0,this._firstFramePlayed=!1,this._duringDelay=!1,this.delay>0&&(this._duringDelay=!0)}var o=cc.js,r=t("./playable"),s={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},c=cc.Enum({Default:0,Normal:1,Reverse:s.Reverse,Loop:s.Loop,LoopReverse:s.Loop|s.Reverse,PingPong:s.PingPong,PingPongReverse:s.PingPong|s.Reverse});cc.WrapMode=c;var a=function(){r.call(this)};o.extend(a,r),a.prototype.update=function(t){},o.extend(n,a),o.mixin(n.prototype,{update:function(t){if(this._duringDelay){if(this._timeNoScale+=t,this._timeNoScale<this.delay)return;this._duringDelay=!1}this._firstFramePlayed?this.time+=t*this.speed:this._firstFramePlayed=!0;var e=this.sample();this._lastWrappedInfo||(this._lastWrappedInfo=e);var i=(0|e.iterations)>(0|this._lastWrappedInfo.iterations);this.repeatCount>1&&i&&((this.wrapMode&s.Reverse)===s.Reverse?this._lastWrappedInfo.direction<0&&this.emit("lastframe",this):this._lastWrappedInfo.direction>0&&this.emit("lastframe",this)),e.stopped&&(this.stop(),this.emit("finished",this)),this._lastWrappedInfo=e},_needRevers:function(t){var e=this.wrapMode,i=!1;if((e&s.PingPong)===s.PingPong){var n=t-(0|t)===0;n&&t>0&&(t-=1);var o=1&t;o&&(i=!i)}return(e&s.Reverse)===s.Reverse&&(i=!i),i},getWrappedInfo:function(t){var e=!1,i=this.duration,n=0,o=this.wrapMode,r=Math.abs(t/i);r>this.repeatCount&&(r=this.repeatCount);var c=!1;o&s.ShouldWrap&&(c=this._needRevers(r));var a=c?-1:1;if(this.speed<0&&(a*=-1),r>=this.repeatCount){e=!0;var h=this.repeatCount-(0|this.repeatCount);0===h&&(h=1),t=h*i*(t>0?1:-1)}if(t>i){var l=t%i;t=0===l?i:l}else 0>t&&(t%=i,0!==t&&(t+=i));return o&s.ShouldWrap&&c&&(t=i-t),n=t/i,{ratio:n,time:t,direction:a,stopped:e,iterations:r}},sample:function(){for(var t=this.getWrappedInfo(this.time),e=this.curves,i=0,n=e.length;n>i;i++){var o=e[i];o.sample(t.time,t.ratio,this)}return t},onStop:function(){this.emit("stop",this)},onPlay:function(){this.emit("play",this)},onPause:function(){this.emit("pause",this)},onResume:function(){this.emit("resume",this)}}),cc.defineGetterSetter(n.prototype,"wrapMode",function(){return this._wrapMode},function(t){this._wrapMode=t,this.time=0,t&s.Loop?this.repeatCount=1/0:this.repeatCount=1}),cc.js.mixin(n.prototype,cc.EventTarget.prototype),cc.AnimationNode=n,e.exports={WrapModeMask:s,WrapMode:c,AnimationNode:n}},{"./playable":19}],21:[function(t,e,i){var n=cc.js;cc._LogInfos.deprecated;i.removed=function(t){function e(){cc.error("Sorry, cc.audioEngine.willPlayMusic is removed.")}n.getset(t,"willPlayMusic",e,e)},i.deprecated=function(t){var e=-1,i=1,o=1,r=1,s=1;n.get(t,"playMusic",function(){return function(n,s){return t.stop(e),e=t.play(n,s,r),i=n,o=s,e}}),n.get(t,"stopMusic",function(){return function(){return t.stop(e),e}}),n.get(t,"pauseMusic",function(){return function(){return t.pause(e),e}}),n.get(t,"resumeMusic",function(){return function(){return t.resume(e),e}}),n.get(t,"rewindMusic",function(){return function(){return t.setCurrentTime(e,0),e}}),n.get(t,"getMusicVolume",function(){return function(){return r}}),n.get(t,"setMusicVolume",function(){return function(i){return r=i,t.setVolume(e,r),r}}),n.get(t,"isMusicPlaying",function(){return function(){return t.getState(e)===t.AudioState.PLAYING}}),n.get(t,"playEffect",function(){return function(e,i,n){return t.play(e,i,void 0===n?s:n)}}),n.get(t,"setEffectsVolume",function(i){return function(i){s=i;var n=t._id2audio;for(var o in n)o!==e&&t.setVolume(o,i)}}),n.get(t,"getEffectsVolume",function(){return function(){return s}}),n.get(t,"pauseEffect",function(){return function(e){return t.pause(e)}}),n.get(t,"pauseAllEffects",function(){return function(){var i=t.getState(e)===t.AudioState.PLAYING;t.pauseAll(),i&&t.resume(e)}}),n.get(t,"resumeEffect",function(){return function(e){t.resume(e)}}),n.get(t,"resumeAllEffects",function(){return function(){var i=t.getState(e)===t.AudioState.PAUSED;t.resumeAll(),i&&t.getState(e)===t.AudioState.PLAYING&&t.pause(e)}}),n.get(t,"stopEffect",function(){return function(e){return t.stop(e)}}),n.get(t,"stopAllEffects",function(){return function(){var n=t.getState(e)===t.AudioState.PLAYING,r=t.getCurrentTime(e);t.stopAll(),n&&(e=t.play(i,o),t.setCurrentTime(r))}}),n.get(t,"unloadEffect",function(){return function(e){return t.stop(e)}})}},{}],22:[function(t,e,i){"use strict";function n(t){return t?"string"==typeof t?l.getClassByName(t):t:(cc.error("getComponent: Type must be non-nil"),null)}function o(t,e){for(var i=0;i<t._components.length;++i){var n=t._components[i];if(n instanceof e)return n}return null}function r(t,e,i){for(var n=0;n<t._components.length;++n){var o=t._components[n];o instanceof e&&i.push(o)}}function s(t,e){for(var i=0;i<t.length;++i){var n=t[i],r=o(n,e);if(r)return r;if(n.children.length>0&&(r=s(n.children,e)))return r}return null}function c(t,e,i){for(var n=0;n<t.length;++n){var o=t[n];r(o,e,i),o._children.length>0&&c(o._children,e,i)}}var a=t("./event/event-target"),h=t("./utils/prefab-helper"),l=cc.js,u=cc.Object.Flags,d=u.Destroying,p=u.DontDestroy,_=u.Activating,f=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel"}),g=[f.TOUCH_START,f.TOUCH_MOVE,f.TOUCH_END,f.TOUCH_CANCEL],v=[f.MOUSE_DOWN,f.MOUSE_ENTER,f.MOUSE_MOVE,f.MOUSE_LEAVE,f.MOUSE_UP,f.MOUSE_WHEEL],m=null,y=function(t,e){var i=t.getLocation(),n=this.owner;return n._hitTest(i,this)?(e.type=f.TOUCH_START,e.touch=t,e.bubbles=!0,n.dispatchEvent(e),!0):!1},C=function(t,e){var i=this.owner;e.type=f.TOUCH_MOVE,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},T=function(t,e){var i=t.getLocation(),n=this.owner;n._hitTest(i,this)?e.type=f.TOUCH_END:e.type=f.TOUCH_CANCEL,e.touch=t,e.bubbles=!0,n.dispatchEvent(e)},b=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=f.MOUSE_DOWN,i.dispatchEvent(t),t.stopPropagation())},E=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)?(t.stopPropagation(),this._previousIn||(m&&(t.type=f.MOUSE_LEAVE,m.dispatchEvent(t),m._mouseListener._previousIn=!1),m=this.owner,t.type=f.MOUSE_ENTER,i.dispatchEvent(t),this._previousIn=!0),t.type=f.MOUSE_MOVE,i.dispatchEvent(t)):this._previousIn&&(t.type=f.MOUSE_LEAVE,i.dispatchEvent(t),this._previousIn=!1,m=null)},S=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=f.MOUSE_UP,i.dispatchEvent(t),t.stopPropagation())},A=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=f.MOUSE_WHEEL,i.dispatchEvent(t))},x=function(t){if(cc.Mask)for(var e=0,i=null,n=t;n&&n instanceof cc.Node;n=n.parent,++e)if(i=n.getComponent(cc.Mask))return{index:e,node:n};return null},O=cc.Class({name:"cc.Node","extends":t("./utils/base-node"),mixins:[a],properties:{active:{get:function(){return this._active},set:function(t){if(t=!!t,this._active!==t){this._active=t;var e=this._parent&&this._parent._activeInHierarchy;e&&(this._onActivatedInHierarchy(t),this.emit("active-in-hierarchy-changed",this))}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}},_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return(this._objFlags&p)>0},set:function(t){t?this._objFlags|=p:this._objFlags&=~p}},groupIndex:{"default":0,type:cc.Integer},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(t){this.groupIndex=cc.game.groupList.indexOf(t),this.emit("group-changed")}}},ctor:function(){var t=arguments[0];this._name="undefined"!=typeof t?t:"New Node",this._activeInHierarchy=!1,this._widget=null,this._touchListener=null,this._mouseListener=null,this._retainedActions=[]},destroy:function(){cc.Object.prototype.destroy.call(this)&&this._activeInHierarchy&&this._deactivateChildComponents()},_onPreDestroy:function(){var t,e;this._objFlags|=d;var i=this._parent,n=i&&i._objFlags&d,o=this._children;for(t=0,e=o.length;e>t;++t)o[t]._destroyImmediate();for(t=0,e=this._components.length;e>t;++t){var r=this._components[t];r._destroyImmediate()}for(cc.director.getActionManager().removeAllActionsFromTarget(this),this._releaseAllActions(),m===this&&(m=null),this._touchListener&&(this._touchListener.release(),this._touchListener.owner=null,this._touchListener.mask=null,this._touchListener=null),this._mouseListener&&(this._mouseListener.release(),this._mouseListener.owner=null,this._mouseListener.mask=null,this._mouseListener=null),cc.eventManager.removeListeners(this),t=0,e=this.__eventTargets.length;e>t;++t){var s=this.__eventTargets[t];s&&s.targetOff(this)}if(this.__eventTargets.length=0,this._persistNode&&cc.game.removePersistRootNode(this),n)this._sgNode.release(),this._sgNode._entity=null,this._sgNode=null;else{if(i){var c=i._children.indexOf(this);i._children.splice(c,1),i.emit("child-removed",this)}this._removeSgNode()}},getComponent:function(t){var e=n(t);return e?o(this,e):null},getComponents:function(t){var e=n(t),i=[];return e&&r(this,e,i),i},getComponentInChildren:function(t){var e=n(t);return e?s(this._children,e):null},getComponentsInChildren:function(t){var e=n(t),i=[];return e&&(r(this,e,i),c(this._children,e,i)),i},_checkMultipleComp:!1,addComponent:function(t){var e;if("string"==typeof t){if(e=l.getClassByName(t),!e)return cc.error('addComponent: Failed to get class "%s"',t),cc._RFpeek()&&cc.error('addComponent: Should not add component ("%s") when the scripts are still loading.',t),null}else{if(!t)return cc.error("addComponent: Type must be non-nil"),null;e=t}if("function"!=typeof e)return cc.error("addComponent: The component to add must be a constructor"),null;if(!cc.isChildClassOf(e,cc.Component))return cc.error("addComponent: The component to add must be child class of cc.Component"),null;var i=e._requireComponent;if(i&&!this.getComponent(i)){var n=this.addComponent(i);if(!n)return null}var o=new e;return o.node=this,this._components.push(o),this._activeInHierarchy&&("function"==typeof o.__preload&&cc.Component._callPreloadOnComponent(o),o.__onNodeActivated(!0)),o},_addComponentAt:!1,removeComponent:function(t){return t?("object"!=typeof t&&(t=this.getComponent(t)),void(t&&t.destroy())):void cc.error("removeComponent: Component must be non-nil")},_getDependComponent:!1,_removeComponent:function(t){if(!t)return void cc.error("Argument must be non-nil");if(!(this._objFlags&d)){var e=this._components.indexOf(t);-1!==e?this._components.splice(e,1):t.node!==this&&cc.error("Component not owned by this entity")}},_registerIfAttached:!1,_onBatchCreated:function(){var t=this._prefab;t&&t.sync&&!t._synced&&t.root===this&&h.syncWithPrefab(this),this._updateDummySgNode(),this._parent&&this._parent._sgNode.addChild(this._sgNode),this._activeInHierarchy||(cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this));for(var e=this._children,i=0,n=e.length;n>i;i++)e[i]._onBatchCreated()},_activeRecursively:function(t){var e=!1;if(this._objFlags&_){if(t)return void cc.error('Node "%s" is already activating',this.name);e=!0}else t&&(this._objFlags|=_);this._activeInHierarchy=t;for(var i=this._components.length,n=0;i>n;++n){var o=this._components[n];if(o instanceof cc.Component){if(o.__onNodeActivated(t),t&&!this._activeInHierarchy)return void(this._objFlags&=~_)}else o?this._removeComponent(o):l.array.removeAt(this._components,n),--n,--i}for(var r=0,s=this._children.length;s>r;++r){var c=this._children[r];if(c._active&&(c._activeRecursively(t),t&&!this._activeInHierarchy))return void(this._objFlags&=~_)}return e?void(this._objFlags&=~_):(t?(cc.director.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this),this._touchListener&&(this._touchListener.mask=x(this)),this._mouseListener&&(this._mouseListener.mask=x(this))):(cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this)),void(this._objFlags&=~_))},_onActivatedInHierarchy:function(t){t&&cc.Component._callPreloadOnNode(this),this._activeRecursively(t)},_onHierarchyChanged:function(t){var e=this._parent;!this._persistNode||e instanceof cc.Scene||cc.game.removePersistRootNode(this);var i=this._active&&!(!t||!t._activeInHierarchy),n=this._active&&!(!e||!e._activeInHierarchy);i!==n&&this._onActivatedInHierarchy(n),cc._widgetManager._nodesOrderDirty=!0},_deactivateChildComponents:function(){for(var t=this._components.length,e=0;t>e;++e){var i=this._components[e];i.__onNodeActivated(!1)}for(var n=0,o=this.childrenCount;o>n;++n){var r=this._children[n];r._active&&r._deactivateChildComponents()}},_instantiate:function(){var t=cc.instantiate._clone(this,this);t._parent=null;var e=this._prefab,i=e&&this===e.root&&e.sync;return i&&(t._prefab._synced=e._synced),t._onBatchCreated(),t},on:function(t,e,i,n){var o=!1;return-1!==g.indexOf(t)?this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:x(this),onTouchBegan:y,onTouchMoved:C,onTouchEnded:T}),this._touchListener.retain(),cc.eventManager.addListener(this._touchListener,this),o=!0):-1!==v.indexOf(t)&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:x(this),onMouseDown:b,onMouseMove:E,onMouseUp:S,onMouseScroll:A}),this._mouseListener.retain(),cc.eventManager.addListener(this._mouseListener,this),o=!0)),o&&!this._activeInHierarchy&&cc.director.getScheduler().schedule(function(){this._activeInHierarchy||cc.eventManager.pauseTarget(this)},this,0,0,0,!1),this._EventTargetOn(t,e,i,n)},off:function(t,e,i,n){this._EventTargetOff(t,e,i,n),-1!==g.indexOf(t)?this._checkTouchListeners():-1!==v.indexOf(t)&&this._checkMouseListeners()},targetOff:function(t){this._EventTargetTargetOff(t),this._checkTouchListeners(),this._checkMouseListeners()},_checkTouchListeners:function(){if(!(this._objFlags&d)&&this._bubblingListeners&&this._touchListener){for(var t=0;t<g.length;++t)if(this._bubblingListeners.has(g[t]))return;cc.eventManager.removeListener(this._touchListener),this._touchListener=null}},_checkMouseListeners:function(){if(!(this._objFlags&d)&&this._bubblingListeners&&this._mouseListener){for(var t=0;t<v.length;++t)if(this._bubblingListeners.has(v[t]))return;m===this&&(m=null),cc.eventManager.removeListener(this._mouseListener),this._mouseListener=null}},_hitTest:function(t,e){var i=this.width,n=this.height,o=cc.rect(0,0,i,n),r=this.getNodeToWorldTransform();cc._rectApplyAffineTransformIn(o,r);var s=t.x-o.x,c=o.x+o.width-t.x,a=t.y-o.y,h=o.y+o.height-t.y;if(s>=0&&c>=0&&h>=0&&a>=0){if(e&&e.mask){for(var l=e.mask,u=this,d=0;u&&d<l.index;++d,u=u.parent);if(u===l.node){var p=u.getComponent(cc.Mask);return p&&p.enabledInHierarchy?p._hitTest(t):!0}return e.mask=null,!0}return!0}return!1},_getCapturingTargets:function(t,e){for(var i=this.parent;i;)i.hasEventListener(t,!0)&&e.push(i),i=i.parent},_getBubblingTargets:function(t,e){for(var i=this.parent;i;)i.hasEventListener(t)&&e.push(i),i=i.parent},isRunning:function(){return this._activeInHierarchy},runAction:function(t){return this.active?(cc.assert(t,cc._LogInfos.Node.runAction),this._retainAction(t),this._sgNode._owner=this,cc.director.getActionManager().addAction(t,this,!1),t):void 0},stopAllActions:function(){cc.director.getActionManager().removeAllActionsFromTarget(this)},stopAction:function(t){cc.director.getActionManager().removeAction(t)},stopActionByTag:function(t){return t===cc.Action.TAG_INVALID?void cc.log(cc._LogInfos.Node.stopActionByTag):void cc.director.getActionManager().removeActionByTag(t,this)},getActionByTag:function(t){return t===cc.Action.TAG_INVALID?(cc.log(cc._LogInfos.Node.getActionByTag),null):void cc.director.getActionManager().getActionByTag(t,this)},getNumberOfRunningActions:function(){cc.director.getActionManager().numberOfRunningActionsInTarget(this)},_retainAction:function(t){t instanceof cc.Action&&-1===this._retainedActions.indexOf(t)&&(this._retainedActions.push(t),t.retain())},_releaseAllActions:function(){for(var t=0;t<this._retainedActions.length;++t)this._retainedActions[t].release();this._retainedActions.length=0}}),N=function(){this._activeInHierarchy||cc.eventManager.pauseTarget(this)};cc.js.getset(O.prototype,"_sgNode",function(){return this.__sgNode},function(t){this.__sgNode=t,(this._touchListener||this._mouseListener)&&(this._touchListener&&(this._touchListener.retain(),cc.eventManager.removeListener(this._touchListener),cc.eventManager.addListener(this._touchListener,this),this._touchListener.release()),this._mouseListener&&(this._mouseListener.retain(),cc.eventManager.removeListener(this._mouseListener),cc.eventManager.addListener(this._mouseListener,this),this._mouseListener.release()),cc.director.once(cc.Director.EVENT_BEFORE_UPDATE,N,this))},!0),O.EventType=f,cc.Node=e.exports=O},{"./event/event-target":76,"./utils/base-node":124,"./utils/prefab-helper":128}],23:[function(t,e,i){var n=function(){};cc.Scene=cc.Class({name:"cc.Scene","extends":t("./utils/base-node"),properties:{autoReleaseAssets:void 0},ctor:function(){var t=this._sgNode=new _ccsg.Scene;t.retain(),t.setAnchorPoint(0,0),this._anchorPoint.x=0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning,this.dependAssets=null},destroy:function(){for(var t=this._children,e=cc.Object.Flags.DontDestroy,i=0,n=t.length;n>i;++i){var o=t[i];o.isValid&&(o._objFlags&e||o.destroy())}this._super(),this._activeInHierarchy=!1},_onHierarchyChanged:n,_load:function(){if(!this._inited){this._updateDummySgNode(),cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this);for(var t=this._children,e=0,i=t.length;i>e;e++)t[e]._onBatchCreated();this._inited=!0}},_activate:function(t){t=t!==!1;var e,i,n=this._children,o=n.length;for(this._activeInHierarchy=t,e=0;o>e;++e)i=n[e],i._active&&i._onActivatedInHierarchy(t)}}),e.exports=cc.Scene},{"./utils/base-node":124}],24:[function(t,e,i){var n=t("./CCRawAsset");cc.Asset=cc.Class({name:"cc.Asset","extends":n,properties:{rawUrl:{get:function(){if(this._rawFiles){if(cc.AssetLibrary)return cc.AssetLibrary.getImportedDir(this._uuid)+"/"+this._uuid+"/"+this._rawFiles[0];cc.error("asset.url is not usable in core process")}return""},visible:!1},rawUrls:{get:function(){if(this._rawFiles){if(cc.AssetLibrary){var t=cc.AssetLibrary.getImportedDir(this._uuid)+"/"+this._uuid+"/";return this._rawFiles.map(function(e){return t+e})}cc.error("asset.urls is not usable in core process")}return[]},visible:!1},_rawFiles:null},statics:{deserialize:function(t){return cc.deserialize(t)},preventDeferredLoadDependents:!1},serialize:function(){return Editor.serialize(this)},createNode:null,_setRawFiles:function(t){this._rawFiles=t.length>0?t:null}}),e.exports=cc.Asset},{"./CCRawAsset":29}],25:[function(t,e,i){var n=cc.Class({name:"cc.AudioClip","extends":cc.RawAsset});cc.AudioClip=n,e.exports=n},{}],26:[function(t,e,i){var n=cc.Class({name:"cc.BitmapFont","extends":cc.Font,properties:{texture:{"default":"",url:cc.Texture2D},fontSize:{"default":-1}}});cc.BitmapFont=n,e.exports=n},{}],27:[function(t,e,i){var n=cc.Class({name:"cc.Font","extends":cc.Asset});cc.Font=n,e.exports=n},{}],28:[function(t,e,i){var n=cc.Class({name:"cc.Prefab","extends":cc.Asset,properties:{data:null},createNode:function(t){},_instantiate:function(){this.data._prefab?this.data._prefab._synced=!0:cc.warn("internal error: _prefab is undefined");var t=cc.instantiate(this.data);return t}});cc.Prefab=e.exports=n,cc.js.obsolete(cc,"cc._Prefab","Prefab")},{}],29:[function(t,e,i){var n=t("../platform/CCObject");cc.RawAsset=cc.Class({name:"cc.RawAsset","extends":n,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0})},statics:{createNodeByInfo:null}}),Object.defineProperty(cc.RawAsset,"isRawAssetType",{value:function(t){return cc.isChildClassOf(t,cc.RawAsset)&&!cc.isChildClassOf(t,cc.Asset)}}),e.exports=cc.RawAsset},{"../platform/CCObject":106}],30:[function(t,e,i){var n=cc.Class({name:"cc.SceneAsset","extends":cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=n,e.exports=n},{}],31:[function(t,e,i){var n=cc.Class({name:"cc.Script","extends":cc.Asset});cc._Script=n;var o=cc.Class({name:"cc.JavaScript","extends":n});cc._JavaScript=o;var r=cc.Class({name:"cc.CoffeeScript","extends":n});cc._CoffeeScript=r},{}],32:[function(t,e,i){var n=cc.Class({name:"cc.SpriteAtlas","extends":cc.Asset,properties:{_spriteFrames:{"default":{}}},getTexture:function(){var t=Object.keys(this._spriteFrames);if(t.length>0){var e=this._spriteFrames[t[0]];return e?e.getTexture():null}return null},getSpriteFrame:function(t){return this._spriteFrames[t]},getSpriteFrames:function(){var t=[],e=this._spriteFrames;for(var i in e)t.push(e[i]);return t}});cc.SpriteAtlas=n,e.exports=n},{}],33:[function(t,e,i){var n=cc.Class({name:"cc.TTFFont","extends":cc.Font});cc.TTFFont=n,e.exports=n},{}],34:[function(t,e,i){t("./CCRawAsset"),t("./CCAsset"),t("./CCFont"),t("./CCPrefab"),t("./CCAudioClip"),t("./CCBitmapFont"),t("./CCScripts"),t("./CCSceneAsset"),t("../sprites/CCSpriteFrame"),t("../textures/CCTexture2D"),t("./CCTTFFont"),t("./CCSpriteAtlas")},{"../sprites/CCSpriteFrame":184,"../textures/CCTexture2D":184,"./CCAsset":24,"./CCAudioClip":25,"./CCBitmapFont":26,"./CCFont":27,"./CCPrefab":28,"./CCRawAsset":29,"./CCSceneAsset":30,"./CCScripts":31,"./CCSpriteAtlas":32,"./CCTTFFont":33}],35:[function(t,e,i){function n(t){return t instanceof cc.Scene?cc.visibleRect:!t._sizeProvider||t._sizeProvider instanceof _ccsg.Node?t._contentSize:t.getContentSize()}function o(t,e){var i,o=t._parent,r=n(o),s=o._anchorPoint,c=o instanceof cc.Scene,a=t._position.x,h=t._position.y,l=t.getAnchorPoint();if(e._alignFlags&p){var u,d,f=r.width;c?(i=cc.visibleRect,u=i.left.x,d=i.right.x):(u=-s.x*f,d=u+f),u+=e._isAbsLeft?e._left:e._left*f,d-=e._isAbsRight?e._right:e._right*f;var g,v=l.x,m=t._scaleX;if(0>m&&(v=1-v,m=-m),e.isStretchWidth)g=d-u,t.width=g/m,a=u+v*g;else if(g=t.width*m,e.isAlignHorizontalCenter){var y=e._isAbsHorizontalCenter?e._horizontalCenter:e._horizontalCenter*f,C=(.5-s.x)*f;a=C+(v-.5)*g+y}else a=e.isAlignLeft?u+v*g:d+(v-1)*g}if(e._alignFlags&_){var T,b,E=r.height;c?(i=cc.visibleRect,b=i.bottom.y,T=i.top.y):(b=-s.y*E,T=b+E),b+=e._isAbsBottom?e._bottom:e._bottom*E,T-=e._isAbsTop?e._top:e._top*E;var S,A=l.y,x=t._scaleY;if(0>x&&(A=1-A,x=-x),e.isStretchHeight)S=T-b,t.height=S/x,h=b+A*S;else if(S=t.height*x,e.isAlignVerticalCenter){var O=e._isAbsVerticalCenter?e._verticalCenter:e._verticalCenter*E,N=(.5-s.y)*E;h=N+(A-.5)*S+O}else h=e.isAlignBottom?b+A*S:T+(A-1)*S}t.setPosition(a,h)}function r(t){var e=t._widget;e&&(o(t,e),e.isAlignOnce?e.enabled=!1:f.push(e));for(var i=t._children,n=0;n<i.length;n++){var s=i[n];s._active&&r(s)}}function s(){var t=cc.director.getScene();if(t){if(g.isAligning=!0,g._nodesOrderDirty)f.length=0,r(t),g._nodesOrderDirty=!1;else{var e,i=g._activeWidgetsIterator;for(i.i=0;i.i<f.length;++i.i)e=f[i.i],o(e.node,e)}g.isAligning=!1}}var c=1,a=2,h=4,l=8,u=16,d=32,p=l|u|d,_=c|a|h,f=[],g=cc._widgetManager=e.exports={_AlignFlags:{TOP:c,MID:a,BOT:h,LEFT:l,CENTER:u,RIGHT:d},isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new cc.js.array.MutableForwardIterator(f),init:function(t){t.on(cc.Director.EVENT_BEFORE_VISIT,s)},add:function(t){t.node._widget=t,this._nodesOrderDirty=!0},remove:function(t){t.node._widget=null;var e=f.indexOf(t);e>-1&&this._activeWidgetsIterator.removeAt(e)},_getParentSize:n}},{}],36:[function(t,e,i){var n=cc.Class({name:"cc.BoxCollider","extends":cc.Collider,editor:!1,properties:{_offset:cc.v2(0,0),_size:cc.size(100,100),offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},size:{get:function(){return this._size},set:function(t){this._size.width=t.width<0?0:t.width,this._size.height=t.height<0?0:t.height},type:cc.Size}}});cc.BoxCollider=e.exports=n},{}],37:[function(t,e,i){var n=cc.Class({name:"cc.CircleCollider","extends":t("./CCCollider"),editor:!1,properties:{_offset:cc.v2(0,0),_radius:50,offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},radius:{get:function(){return this._radius},set:function(t){this._radius=0>t?0:t}}}});cc.CircleCollider=e.exports=n},{"./CCCollider":38}],38:[function(t,e,i){var n=cc.Class({name:"cc.Collider","extends":cc.Component,properties:{editing:{"default":!1,serializable:!1,tooltip:"i18n:COMPONENT.collider.editing"},tag:{"default":0,range:[0,1e7],type:cc.Integer}},onDisable:function(){cc.director.getCollisionManager().removeCollider(this)},onEnable:function(){cc.director.getCollisionManager().addCollider(this)}});cc.Collider=e.exports=n},{}],39:[function(t,e,i){var n=t("./CCContact"),o=n.CollisionType,r=cc.Class({mixins:[cc.EventTarget],properties:{enabled:!1,enabledDrawBoundingBox:!1},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._contacts=[],this._colliders=[],this._debugDrawer=null,this._enabledDebugDraw=!1},update:function(t){if(this.enabled){var e,i,n=this._colliders;for(e=0,i=n.length;i>e;e++)this.updateCollider(n[e]);var r=this._contacts,s=[];for(e=0,i=r.length;i>e;e++){var c=r[e].updateState();c!==o.None&&s.push([c,r[e]])}for(e=0,i=s.length;i>e;e++){var a=s[e];this._doCollide(a[0],a[1])}this.drawColliders()}},_doCollide:function(t,e){var i;switch(t){case o.CollisionEnter:i="onCollisionEnter";break;case o.CollisionStay:i="onCollisionStay";break;case o.CollisionExit:i="onCollisionExit"}var n,r,s,c=e.collider1,a=e.collider2,h=c.node._components,l=a.node._components;for(n=0,r=h.length;r>n;n++)s=h[n],s[i]&&s[i](a,c);for(n=0,r=l.length;r>n;n++)s=l[n],s[i]&&s[i](c,a)},shouldCollide:function(t,e){var i=t.node,n=e.node,o=cc.game.collisionMatrix;return i!==n&&o[i.groupIndex][n.groupIndex]},initCollider:function(t){if(!t.world){var e=t.world={};e.aabb=cc.rect(),e.preAabb=cc.rect(),e.radius=0,t instanceof cc.BoxCollider?(e.position=null,e.points=[cc.v2(),cc.v2(),cc.v2(),cc.v2()]):t instanceof cc.PolygonCollider?(e.position=null,e.points=t.points.slice(0,t.points.length)):t instanceof cc.CircleCollider&&(e.position=cc.v2(),e.points=null)}},updateCollider:function(t){var e=t.offset,i=t.world,n=i.aabb,o=i.transform=t.node.getNodeToWorldTransformAR(),r=i.preAabb;if(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height,t instanceof cc.BoxCollider){var s=t.size,c=cc.rect(e.x-s.width/2,e.y-s.height/2,s.width,s.height),a=i.points,h=a[0],l=a[1],u=a[2],d=a[3];cc.obbApplyAffineTransform(c,o,h,l,u,d);var p=Math.min(h.x,l.x,u.x,d.x),_=Math.min(h.y,l.y,u.y,d.y),f=Math.max(h.x,l.x,u.x,d.x),g=Math.max(h.y,l.y,u.y,d.y);n.x=p,n.y=_,n.width=f-p,n.height=g-_}else if(t instanceof cc.CircleCollider){var v=cc.pointApplyAffineTransform(t.offset,o),m=o.tx,y=o.ty;o.tx=o.ty=0;var C=cc.pointApplyAffineTransform(cc.v2(t.radius,0),o),T=cc.v2(C).mag();i.radius=T,i.position=cc.v2(v),o.tx=m,o.ty=y,n.x=m-T,n.y=y-T,n.width=2*T,n.height=2*T}else if(t instanceof cc.PolygonCollider){
for(var b=t.points,E=i.points,p=1e6,_=1e6,f=-1e6,g=-1e6,S=0,A=b.length;A>S;S++){var v=b[S].add(e);v=cc.pointApplyAffineTransform(v,o),E[S]=v,v.x>f&&(f=v.x),v.x<p&&(p=v.x),v.y>g&&(g=v.y),v.y<_&&(_=v.y)}n.x=p,n.y=_,n.width=f-p,n.height=g-_}},addCollider:function(t){var e=this._colliders,i=e.indexOf(t);if(-1===i){for(var o=0,r=e.length;r>o;o++){var s=e[o];if(this.shouldCollide(t,s)){var c=new n(t,s);this._contacts.push(c)}}e.push(t),this.initCollider(t)}t.node.on("group-changed",this.onNodeGroupChanged,this)},removeCollider:function(t){var e=this._colliders,i=e.indexOf(t);if(i>=0){e.splice(i,1);for(var n=this._contacts,r=n.length-1;r>=0;r--){var s=n[r];s.collider1!==t&&s.collider2!==t||(s.touching&&this._doCollide(o.CollisionExit,s),n.splice(r,1))}t.node.off("group-changed",this.onNodeGroupChanged,this)}else cc.error("collider not added or already removed")},onNodeGroupChanged:function(t){for(var e=t.currentTarget,i=e.getComponents(cc.Collider),n=0,o=i.length;o>n;n++)this.removeCollider(i[n]),this.addCollider(i[n])},drawColliders:function(){if(this._enabledDebugDraw&&this._debugDrawer){this._debugDrawer.clear();for(var t=this._colliders,e=0,i=t.length;i>e;e++){var n=t[e];if(n instanceof cc.BoxCollider||n instanceof cc.PolygonCollider?this._debugDrawer.drawPoly(n.world.points.concat(),null,1,cc.Color.WHITE):n instanceof cc.CircleCollider&&this._debugDrawer.drawCircle(n.world.position,n.world.radius,0,30),this.enabledDrawBoundingBox){var o=n.world.aabb,r=[cc.v2(o.xMin,o.yMin),cc.v2(o.xMin,o.yMax),cc.v2(o.xMax,o.yMax),cc.v2(o.xMax,o.yMin)];this._debugDrawer.drawPoly(r,null,1,cc.Color.BLUE)}}}},onSceneLaunched:function(){this._enabledDebugDraw&&this._debugDrawer&&(this._debugDrawer.removeFromParent(),cc.director.getScene()._sgNode.addChild(this._debugDrawer))}});cc.js.getset(r.prototype,"enabledDebugDraw",function(){return this._enabledDebugDraw},function(t){t&&!this._enabledDebugDraw?(this._debugDrawer||(this._debugDrawer=new cc.DrawNode,this._debugDrawer.retain()),cc.director.getScene()._sgNode.addChild(this._debugDrawer),cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onSceneLaunched,this)):!t&&this._enabledDebugDraw&&(this._debugDrawer.clear(),this._debugDrawer.removeFromParent(!1),cc.director.off(cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onSceneLaunched,this)),this._enabledDebugDraw=t}),cc.CollisionManager=e.exports=r},{"./CCContact":40}],40:[function(t,e,i){function n(t,e){this.collider1=t,this.collider2=e,this.touching=!1;var i=t instanceof cc.BoxCollider||t instanceof cc.PolygonCollider,n=e instanceof cc.BoxCollider||e instanceof cc.PolygonCollider,r=t instanceof cc.CircleCollider,s=e instanceof cc.CircleCollider;i&&n?this.testFunc=o.polygonPolygon:r&&s?this.testFunc=o.circleCircle:i&&s?this.testFunc=o.polygonCircle:r&&n?(this.testFunc=o.polygonCircle,this.collider1=e,this.collider2=t):cc.error("Can't find testFunc for (%s, $s).",cc.js.getClassName(t),cc.js.getClassName(e))}var o=t("./CCIntersection"),r=cc.Enum({None:0,CollisionEnter:1,CollisionStay:2,CollisionExit:3});n.prototype.test=function(){var t=this.collider1.world,e=this.collider2.world;return t.aabb.intersects(e.aabb)?this.testFunc===o.polygonPolygon?this.testFunc(t.points,e.points):this.testFunc===o.circleCircle?this.testFunc(t,e):this.testFunc===o.polygonCircle?this.testFunc(t.points,e):!1:!1},n.prototype.updateState=function(){var t=this.test(),e=r.None;return t&&!this.touching?(this.touching=!0,e=r.CollisionEnter):t&&this.touching?e=r.CollisionStay:!t&&this.touching&&(this.touching=!1,e=r.CollisionExit),e},n.CollisionType=r,e.exports=n},{"./CCIntersection":41}],41:[function(t,e,i){function n(t,e,i,n){var o=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),r=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),s=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==s){var c=o/s,a=r/s;if(c>=0&&1>=c&&a>=0&&1>=a)return!0}return!1}function o(t,e,i){var o=new cc.Vec2(i.x,i.y),r=new cc.Vec2(i.x,i.yMax),s=new cc.Vec2(i.xMax,i.yMax),c=new cc.Vec2(i.xMax,i.y);return n(t,e,o,r)?!0:n(t,e,r,s)?!0:n(t,e,s,c)?!0:!!n(t,e,c,o)}function r(t,e,i){for(var o=i.length,r=0;o>r;++r){var s=i[r],c=i[(r+1)%o];if(n(t,e,s,c))return!0}return!1}function s(t,e){var i=t.x,n=t.y,o=t.x+t.width,r=t.y+t.height,s=e.x,c=e.y,a=e.x+e.width,h=e.y+e.height;return a>=i&&o>=s&&h>=n&&r>=c}function c(t,e){var i,n,o=new cc.Vec2(t.x,t.y),s=new cc.Vec2(t.x,t.yMax),c=new cc.Vec2(t.xMax,t.yMax),a=new cc.Vec2(t.xMax,t.y);if(r(o,s,e))return!0;if(r(s,c,e))return!0;if(r(c,a,e))return!0;if(r(a,o,e))return!0;for(i=0,n=e.length;n>i;++i)if(u(e[i],t))return!0;return u(o,e)?!0:u(s,e)?!0:u(c,e)?!0:!!u(a,e)}function a(t,e){var i,n;for(i=0,n=t.length;n>i;++i){var o=t[i],s=t[(i+1)%n];if(r(o,s,e))return!0}for(i=0,n=e.length;n>i;++i)if(u(e[i],t))return!0;for(i=0,n=t.length;n>i;++i)if(u(t[i],e))return!0;return!1}function h(t,e){var i=t.position.sub(e.position).mag();return i<t.radius+e.radius}function l(t,e){var i=e.position;if(u(i,t))return!0;for(var n=0,o=t.length;o>n;n++){var r=0===n?t[t.length-1]:t[n-1],s=t[n];if(d(i,r,s,!0)<e.radius)return!0}return!1}function u(t,e){for(var i=!1,n=t.x,o=t.y,r=e.length,s=0,c=r-1;r>s;c=s++){var a=e[s].x,h=e[s].y,l=e[c].x,u=e[c].y,d=h>o!=u>o&&(l-a)*(o-h)/(u-h)+a>n;d&&(i=!i)}return i}function d(t,e,i,n){var o,r=i.x-e.x,s=i.y-e.y,c=r*r+s*s,a=((t.x-e.x)*r+(t.y-e.y)*s)/c;return o=n?c?0>a?e:a>1?i:cc.v2(e.x+a*r,e.y+a*s):e:cc.v2(e.x+a*r,e.y+a*s),r=t.x-o.x,s=t.y-o.y,Math.sqrt(r*r+s*s)}var p={};p.lineLine=n,p.lineRect=o,p.linePolygon=r,p.rectRect=s,p.rectPolygon=c,p.polygonPolygon=a,p.circleCircle=h,p.polygonCircle=l,p.pointInPolygon=u,p.pointLineDistance=d,cc.Intersection=e.exports=p},{}],42:[function(t,e,i){var n=cc.Class({name:"cc.PolygonCollider","extends":t("./CCCollider"),editor:!1,properties:{_offset:cc.v2(0,0),offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},points:{"default":function(){return[cc.v2(-50,-50),cc.v2(-50,50),cc.v2(50,50),cc.v2(50,-50)]},type:[cc.Vec2]}}});cc.PolygonCollider=e.exports=n},{"./CCCollider":38}],43:[function(t,e,i){t("./CCCollisionManager"),t("./CCCollider"),t("./CCBoxCollider"),t("./CCCircleCollider"),t("./CCPolygonCollider")},{"./CCBoxCollider":36,"./CCCircleCollider":37,"./CCCollider":38,"./CCCollisionManager":39,"./CCPolygonCollider":42}],44:[function(t,e,i){function n(t,e){return t===e?!0:t&&e&&(t.name===e.name||t._uuid===e._uuid)}var o=t("../../animation/animation-animator"),r=t("../../animation/animation-clip"),s=cc.Class({name:"cc.Animation","extends":t("./CCComponent"),editor:!1,ctor:function(){this._animator=null,this._nameToState={},this._didInit=!1,this._currentClip=null,this._listeners=[]},properties:{_defaultClip:{"default":null,type:r},defaultClip:{type:r,get:function(){return this._defaultClip},set:function(t){return},tooltip:"i18n:COMPONENT.animation.default_clip"},currentClip:{get:function(){return this._currentClip},set:function(t){this._currentClip=t},type:r,visible:!1},_clips:{"default":[],type:[r],tooltip:"i18n:COMPONENT.animation.clips",visible:!0},playOnLoad:{"default":!1,tooltip:"i18n:COMPONENT.animation.play_on_load"}},onEnable:function(){if(this.playOnLoad&&this._defaultClip){this.playOnLoad=!1;var t=this.getAnimationState(this._defaultClip.name);this._animator.playState(t)}else this.resume()},onDisable:function(){this.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(t,e){for(var i=this.playAdditive(t,e),n=this._animator.playingAnims,o=n.length;o>=0;o--)n[o]!==i&&this._animator.stopState(n[o]);return i},playAdditive:function(t,e){this._init();var i=this.getAnimationState(t||this._defaultClip.name);if(i){var n=this._animator;n.isPlaying&&i.isPlaying?i.isPaused?n.resumeState(i):(n.stopState(i),n.playState(i,e)):n.playState(i,e),this.currentClip=i.clip}return i},stop:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.stopState(e)}else this._animator.stop()},pause:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.pauseState(e)}else this._animator.pause()},resume:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.resumeState(e)}else this._animator.resume()},setCurrentTime:function(t,e){if(this._init(),e){var i=this._nameToState[e];i&&this._animator.setStateTime(i,t)}else for(var e in this._nameToState)i=this._nameToState[e],this._animator.setStateTime(i,t)},getAnimationState:function(t){this._init();var e=this._nameToState[t];return e&&!e.curveLoaded&&this._animator._reloadClip(e),e||null},addClip:function(t,e){if(!t)return void cc.warn("Invalid clip to add");this._init(),cc.js.array.contains(this._clips,t)||this._clips.push(t),e=e||t.name;var i=this._nameToState[e];if(i){if(i.clip===t)return i;var n=this._clips.indexOf(i.clip);-1!==n&&this._clips.splice(n,1)}var o=new cc.AnimationState(t,e);return this._nameToState[e]=o,o},removeClip:function(t,e){if(!t)return void cc.warn("Invalid clip to remove");this._init();var i;for(var n in this._nameToState){i=this._nameToState[n];var o=i.clip;if(o===t)break}if(t===this._defaultClip){if(!e)return void cc.warn("clip is defaultClip, set force to true to force remove clip and animation state");this._defaultClip=null}if(i&&i.isPlaying){if(!e)return void cc.warn("animation state is playing, set force to true to force stop and remove clip and animation state");this.stop(i.name)}this._clips=this._clips.filter(function(e){return e!==t}),i&&delete this._nameToState[i.name]},sample:function(){this._init(),this._animator.sample()},on:function(t,e,i,n){this._init();for(var o=this._listeners,r=0,s=o.length;s>r;r++){var c=o[r];if(c[0]===t&&c[1]===e&&c[2]===i&&c[3]===n)return}for(var a=this._animator.playingAnims,h=0,l=a.length;l>h;h++)a[h].on(t,e,i,n);o.push([t,e,i,n])},off:function(t,e,i,n){this._init();for(var o=this._listeners,r=this._nameToState,s=o.length-1;s>=0;s--){var c=o[s];if(c[0]===t&&c[1]===e&&c[2]===i&&c[3]===n){for(var a in r){var h=r[a];h.off(t,e,i,n)}o.splice(s,1)}}},_init:function(){this._didInit||(this._didInit=!0,this._animator=new o(this.node,this),this._createStates())},_createStates:function(){this._nameToState={};for(var t=null,e=!1,i=0;i<this._clips.length;++i){var o=this._clips[i];o&&(t=new cc.AnimationState(o),this._nameToState[t.name]=t,n(this._defaultClip,o)&&(e=t))}this._defaultClip&&!e&&(t=new cc.AnimationState(this._defaultClip),this._nameToState[t.name]=t)}});cc.Animation=e.exports=s},{"../../animation/animation-animator":8,"../../animation/animation-clip":9,"./CCComponent":48}],45:[function(t,e,i){var n=cc.Class({name:"cc.AudioSource","extends":t("./CCComponent"),editor:!1,ctor:function(){this.audio=new cc.Audio(this._clip)},properties:{_clip:{"default":"",url:cc.AudioClip},_volume:1,_mute:!1,_loop:!1,_pausedFlag:{"default":!1,serializable:!1},isPlaying:{get:function(){if(!this.audio)return!1;var t=this.audio.getState();return t===cc.Audio.State.PLAYING},visible:!1},clip:{get:function(){return this._clip},set:function(t){this._clip=t,this.audio.stop(),this.audio.src=this._clip,this.audio.preload&&this.audio.preload()},url:cc.AudioClip,tooltip:"i18n:COMPONENT.audio.clip",animatable:!1},volume:{get:function(){return this._volume},set:function(t){this._volume=t;var e=this.audio;return e&&!this._mute&&(e.setVolume(t),e._loaded||e.on("load",function(){e.setVolume(t)})),t},tooltip:"i18n:COMPONENT.audio.volume"},mute:{get:function(){return this._mute},set:function(t){return this._mute=t,this.audio&&this.audio.setVolume(t?0:this._volume),t},animatable:!1,tooltip:"i18n:COMPONENT.audio.mute"},loop:{get:function(){return this._loop},set:function(t){return this._loop=t,this.audio&&this.audio.setLoop(t),t},animatable:!1,tooltip:"i18n:COMPONENT.audio.loop"},playOnLoad:{"default":!1,tooltip:"i18n:COMPONENT.audio.play_on_load",animatable:!1},preload:{"default":!1,animatable:!1}},_pausedCallback:function(){this.audio&&!this.audio.paused&&(this.audio.pause(),this._pausedFlag=!0)},_restoreCallback:function(){this.audio&&(this._pausedFlag&&this.audio.resume(),this._pausedFlag=!1)},onEnable:function(){this.playOnLoad&&this.play(),this.preload&&(this.audio.src=this._clip,this.audio.preload()),cc.game.on(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.on(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDisable:function(){this.stop(),cc.game.off(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.off(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDestroy:function(){this.stop(),cc.audioEngine.uncache(this._clip)},play:function(){if(this._clip){var t=this._mute?0:this._volume,e=this.audio,i=this._loop;if(e._loaded)return e.stop(),e.setCurrentTime(0),void e.play();e.src=this._clip,e.once("load",function(){e.setLoop(i),e.setVolume(t),e.play()}),e.preload()}},stop:function(){this.audio&&this.audio.stop()},pause:function(){this.audio&&this.audio.pause()},resume:function(){this.audio&&this.audio.resume()},rewind:function(){this.audio&&this.audio.setCurrentTime(0)},getCurrentTime:function(){var t=0;return this.audio&&(t=this.audio.getCurrentTime()),t},setCurrentTime:function(t){var e=this.audio;return e?e._loaded?(e.setCurrentTime(t),t):(e.once("load",function(){e.setCurrentTime(t)}),t):t},getDuration:function(){var t=0;return this.audio&&(t=this.audio.getDuration()),t}});cc.AudioSource=e.exports=n},{"./CCComponent":48}],46:[function(t,e,i){var n=cc.Enum({NONE:0,COLOR:1,SPRITE:2,SCALE:3}),o=cc.Class({name:"cc.Button","extends":t("./CCComponent"),ctor:function(){this._resetState(),this._fromColor=null,this._toColor=null,this._time=0,this._transitionFinished=!0,this._fromScale=1,this._toScale=1,this._originalScale=1,this._sprite=null},_resetState:function(){this._pressed=!1,this._hovered=!1},editor:!1,properties:{interactable:{"default":!0,tooltip:"i18n:COMPONENT.button.interactable",notify:function(t){this._updateState(),this.interactable||this._resetState()},animatable:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}},enableAutoGrayEffect:{"default":!1,tooltip:"i18n:COMPONENT.button.auto_gray_effect",notify:function(){this._updateDisabledState()}},transition:{"default":n.NONE,tooltip:"i18n:COMPONENT.button.transition",type:n,animatable:!1},normalColor:{"default":cc.color(214,214,214),displayName:"Normal",tooltip:"i18n:COMPONENT.button.normal_color",notify:function(){this._updateState()}},pressedColor:{"default":cc.color(211,211,211),displayName:"Pressed",tooltip:"i18n:COMPONENT.button.pressed_color"},hoverColor:{"default":cc.Color.WHITE,displayName:"Hover",tooltip:"i18n:COMPONENT.button.hover_color"},disabledColor:{"default":cc.color(124,124,124),displayName:"Disabled",tooltip:"i18n:COMPONENT.button.disabled_color",notify:function(){this._updateState()}},duration:{"default":.1,range:[0,10],tooltip:"i18n:COMPONENT.button.duration"},zoomScale:{"default":1.2,tooltip:"i18n:COMPONENT.button.zoom_scale"},normalSprite:{"default":null,type:cc.SpriteFrame,displayName:"Normal",tooltip:"i18n:COMPONENT.button.normal_sprite",notify:function(){this._updateState()}},pressedSprite:{"default":null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:"i18n:COMPONENT.button.pressed_sprite"},hoverSprite:{"default":null,type:cc.SpriteFrame,displayName:"Hover",tooltip:"i18n:COMPONENT.button.hover_sprite"},disabledSprite:{"default":null,type:cc.SpriteFrame,displayName:"Disabled",tooltip:"i18n:COMPONENT.button.disabled_sprite",notify:function(){this._updateState()}},target:{"default":null,type:cc.Node,tooltip:"i18n:COMPONENT.button.target",notify:function(){this._applyTarget()}},clickEvents:{"default":[],type:cc.Component.EventHandler,tooltip:"i18n:COMPONENT.button.click_events"}},statics:{Transition:n},__preload:function(){this.target||(this.target=this.node)},onEnable:function(){this.normalSprite&&this.normalSprite.ensureLoadTexture(),this.hoverSprite&&this.hoverSprite.ensureLoadTexture(),this.pressedSprite&&this.pressedSprite.ensureLoadTexture(),this.disabledSprite&&this.disabledSprite.ensureLoadTexture(),this._registerEvent()},onLoad:function(){this._applyTarget(),this._updateState()},update:function(t){var e=this.target;if((this.transition===n.COLOR||this.transition===n.SCALE)&&e&&!this._transitionFinished){this.time+=t;var i=1;this.duration>0&&(i=this.time/this.duration),i>=1&&(i=1,this._transitionFinished=!0),this.transition===n.COLOR?e.color=this._fromColor.lerp(this._toColor,i):this.transition===n.SCALE&&(e.scale=cc.lerp(this._fromScale,this._toScale,i))}},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getTargetSprite:function(t){var e=null;return t&&(e=t.getComponent(cc.Sprite)),e},_applyTarget:function(){this._sprite=this._getTargetSprite(this.target),this.target&&(this._originalScale=this.target.scale)},_onTouchBegan:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this.transition===n.SCALE?this._zoomUp():this._updateState(),t.stopPropagation())},_onTouchMove:function(t){if(this.interactable&&this.enabledInHierarchy){var e=t.touch,i=this.node._hitTest(e.getLocation());if(this.transition===n.SCALE&&this.target)i?this.target.scale=this._originalScale*this.zoomScale:this.target.scale=this._originalScale;else{var o;o=i?"pressed":"normal";var r=this[o+"Color"],s=this[o+"Sprite"];this._applyTransition(r,s)}t.stopPropagation()}},_onTouchEnded:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this.transition===n.SCALE?this._zoomBack():this._updateState(),t.stopPropagation())},_zoomUp:function(){this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this.time=0,this._transitionFinished=!1},_zoomBack:function(){this._fromScale=this._originalScale*this.zoomScale,this._toScale=this._originalScale,this.time=0,this._transitionFinished=!1},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==n.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var t;t=this.interactable?this._pressed?"pressed":this._hovered?"hover":"normal":"disabled";var e=this[t+"Color"],i=this[t+"Sprite"];this._applyTransition(e,i),this._updateDisabledState()},onDisable:function(){this._hovered=!1,this._pressed=!1,this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_applyTransition:function(t,e){var i=this.transition;if(i===n.COLOR){var o=this.target;this._fromColor=o.color.clone(),this._toColor=t,this.time=0,this._transitionFinished=!1}else i===n.SPRITE&&this._sprite&&e&&(this._sprite.spriteFrame=e)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(){this._sprite&&this._sprite._sgNode.setState(0),this.enableAutoGrayEffect&&this.transition!==n.COLOR&&(this.transition===n.SPRITE&&this.disabledSprite||this._sprite&&!this.interactable&&this._sprite._sgNode.setState(1))}});cc.Button=e.exports=o},{"./CCComponent":48}],47:[function(t,e,i){var n={getContentSize:function(){return cc.visibleRect},setContentSize:function(t){},_getWidth:function(){return this.getContentSize().width},_getHeight:function(){return this.getContentSize().height}},o=cc.Class({name:"cc.Canvas","extends":t("./CCComponent"),editor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(t){this._designResolution.width=t.width,this._designResolution.height=t.height,this.applySettings()},tooltip:"i18n:COMPONENT.canvas.design_resolution"},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(t){this._fitHeight!==t&&(this._fitHeight=t,this.applySettings())},tooltip:"i18n:COMPONENT.canvas.fit_height"},fitWidth:{get:function(){return this._fitWidth},set:function(t){this._fitWidth!==t&&(this._fitWidth=t,this.applySettings())},tooltip:"i18n:COMPONENT.canvas.fit_width"}},ctor:function(){this._thisOnResized=cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:"window-resize",callback:this.onResized.bind(this)}),this._thisOnResized.retain()},__preload:function(){if(o.instance)return cc.error("Can't init canvas '%s' because it conflicts with the existing '%s', the scene should only have one active canvas at the same time",this.node.name,o.instance.node.name);if(o.instance=this,this.node._sizeProvider);else this.node._sizeProvider=n;cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.eventManager.addListener(this._thisOnResized,1),this.applySettings(),this.onResized()},onDestroy:function(){this.node._sizeProvider===n&&(this.node._sizeProvider=null),cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.eventManager.removeListener(this._thisOnResized),this._thisOnResized.release(),o.instance===this&&(o.instance=null)},alignWithScreen:function(){var t,e=cc.visibleRect,i=!this.fitHeight&&!this.fitWidth,n=0,o=0;i&&(t=cc.view.getDesignResolutionSize(),n=.5*(t.width-e.width),o=.5*(t.height-e.height)),this.node.setPosition(.5*e.width+n,.5*e.height+o)},onResized:function(){this.alignWithScreen()},applySettings:function(){var t,e=cc.ResolutionPolicy;t=this.fitHeight&&this.fitWidth?e.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?e.FIXED_WIDTH:e.FIXED_HEIGHT:e.NO_BORDER;var i=this._designResolution;cc.view.setDesignResolutionSize(i.width,i.height,t)}});cc.Canvas=e.exports=o},{"./CCComponent":48}],48:[function(t,e,i){function n(t,e){var i=t._objFlags&u;if(e){if(!i){t.onEnable&&t.onEnable();var n=!t.node._activeInHierarchy;if(n)return;cc.director.getScheduler().resumeTarget(t),o(t),t._objFlags|=u}}else i&&(t.onDisable&&t.onDisable(),cc.director.getScheduler().pauseTarget(t),r(t),t._objFlags&=~u)}function o(t){!t.start||t._objFlags&g||cc.director.__fastOn(O.EVENT_BEFORE_UPDATE,N,t,t.__eventTargets),(t.update||t.lateUpdate)&&cc.director.__fastOn(O.EVENT_BEFORE_UPDATE,s,t,t.__eventTargets)}function r(t){!t.start||t._objFlags&g||cc.director.__fastOff(O.EVENT_BEFORE_UPDATE,N,t,t.__eventTargets);var e=t.update,i=t.lateUpdate;(e||i)&&(cc.director.__fastOff(O.EVENT_BEFORE_UPDATE,s,t,t.__eventTargets),e&&cc.director.__fastOff(O.EVENT_COMPONENT_UPDATE,w,t,t.__eventTargets),i&&cc.director.__fastOff(O.EVENT_COMPONENT_LATE_UPDATE,I,t,t.__eventTargets))}function s(){var t=this.__eventTargets,e=cc.director;e.__fastOff(O.EVENT_BEFORE_UPDATE,s,this,t),this.update&&e.__fastOn(O.EVENT_COMPONENT_UPDATE,w,this,t),this.lateUpdate&&e.__fastOn(O.EVENT_COMPONENT_LATE_UPDATE,I,this,t)}function c(t){t._activeInHierarchy=!0;for(var e=t._components,i=0,n=e.length;n>i;++i){var o=e[i];!o||o._objFlags&p||"function"!=typeof o.__preload||(o.__preload(),o._objFlags|=p)}var r=t._children;for(i=0,n=r.length;n>i;++i){var s=r[i];s._active&&c(s)}}t("../platform/CCObject"),t("../CCNode");var a=new(t("../platform/id-generater"))("Comp"),h=t("../utils/misc"),l=cc.Object.Flags,u=l.IsOnEnableCalled,d=l.IsEditorOnEnableCalled,p=l.IsPreloadCalled,_=l.IsOnLoadStarted,f=l.IsOnLoadCalled,g=l.IsStartCalled,v,m,y,C,T,b,E,S,A,x,O=cc.Director,N=function(){cc.director.__fastOff(O.EVENT_BEFORE_UPDATE,N,this,this.__eventTargets),this.start(),this._objFlags|=g},w=function(t){this.update(t.detail)},I=function(t){this.lateUpdate(t.detail)},P=cc.Class({name:"cc.Component","extends":cc.Object,ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},properties:{node:{"default":null,visible:!1},name:{get:function(){if(this._name)return this._name;var t=cc.js.getClassName(this),e=t.lastIndexOf(".");return e>=0&&(t=t.slice(e+1)),this.node.name+"<"+t+">"},set:function(t){this._name=t},visible:!1},_id:{"default":"",serializable:!1},uuid:{get:function(){var t=this._id;return t||(t=this._id=a.getNewId()),t},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(t){this._enabled!==t&&(this._enabled=t,this.node._activeInHierarchy&&n(this,t))},visible:!1},enabledInHierarchy:{get:function(){return(this._objFlags&u)>0},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&f}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(t){return this.node.addComponent(t)},getComponent:function(t){return this.node.getComponent(t)},getComponents:function(t){return this.node.getComponents(t)},getComponentInChildren:function(t){return this.node.getComponentInChildren(t)},getComponentsInChildren:function(t){return this.node.getComponentsInChildren(t)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&n(this,!1)},__onNodeActivated:function(t){if(!t||this._objFlags&_||(this._objFlags|=_,this.onLoad&&this.onLoad(),this._objFlags|=f),this._enabled){if(t){var e=!this.node._activeInHierarchy;if(e)return}n(this,t)}},_onPreDestroy:function(){var t,e,i;for(n(this,!1),this.unscheduleAllCallbacks(),t=0,e=this.__eventTargets.length;e>t;++t)i=this.__eventTargets[t],i&&i.targetOff(this);this.__eventTargets.length=0,cc.eventManager.removeListeners(this),this.onDestroy&&this._objFlags&f&&this.onDestroy(),this.node._removeComponent(this)},_destruct:h.destructIgnoreId,_instantiate:function(){var t=cc.instantiate._clone(this,this);return t.node=null,t},isRunning:function(){return this.enabledInHierarchy},schedule:function(t,e,i,n){cc.assert(t,cc._LogInfos.Node.schedule),cc.assert(e>=0,cc._LogInfos.Node.schedule_2),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,cc.director.getScheduler().schedule(t,this,e,i,n,!this.enabledInHierarchy)},scheduleOnce:function(t,e){this.schedule(t,0,0,e)},unschedule:function(t){t&&cc.director.getScheduler().unschedule(t,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});P._requireComponent=null,Object.defineProperty(P,"_registerEditorProps",{value:function(t,e){var i=e.requireComponent;i&&(t._requireComponent=i)}}),Object.defineProperties(P,{_callPreloadOnNode:{value:c},_callPreloadOnComponent:{value:function(t){t.__preload(),t._objFlags|=p}},_callResetOnComponent:{value:!1}}),P.prototype.__scriptUuid="",cc.Component=e.exports=P},{"../CCNode":22,"../platform/CCObject":106,"../platform/id-generater":113,"../utils/misc":126}],49:[function(t,e,i){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{"default":null,type:cc.Node},component:{"default":""},handler:{"default":""},customEventData:{"default":""}},statics:{emitEvents:function(t){"use strict";for(var e=0,i=t.length;i>e;e++){var n=t[e];!n instanceof cc.Component.EventHandler||n.emit(Array.prototype.slice.call(arguments,1))}}},emit:function(t){var e=this.target;if(cc.isValid(e)){var i=e.getComponent(this.component);if(cc.isValid(i)){var n=i[this.handler];"function"==typeof n&&(this.customEventData&&t.push(this.customEventData),n.apply(i,t))}}}})},{}],50:[function(t,e,i){var n=_ccsg.EditBox.KeyboardReturnType,o=_ccsg.EditBox.InputMode,r=_ccsg.EditBox.InputFlag,s=cc.Class({name:"cc.EditBox","extends":cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_string:"",string:{tooltip:"i18n:COMPONENT.editbox.string",get:function(){return this._sgNode.string},set:function(t){this._sgNode.string=this._string=t}},backgroundImage:{tooltip:"i18n:COMPONENT.editbox.backgroundImage","default":null,type:cc.SpriteFrame,notify:function(){var t=this._sgNode,e=t.getBackgroundSprite();if(this.backgroundImage){var i=this._createBackgroundSprite();i.setContentSize(t.getContentSize())}else e.removeFromParent()}},returnType:{"default":n.DEFAULT,tooltip:"i18n:COMPONENT.editbox.returnType",displayName:"KeyboardReturnType",type:n,notify:function(){this._sgNode.returnType=this.returnType}},inputFlag:{tooltip:"i18n:COMPONENT.editbox.input_flag","default":r.DEFAULT,type:r,notify:function(){this._sgNode.inputFlag=this.inputFlag}},inputMode:{tooltip:"i18n:COMPONENT.editbox.input_mode","default":o.ANY,type:o,notify:function(){this._sgNode.inputMode=this.inputMode}},fontSize:{tooltip:"i18n:COMPONENT.editbox.font_size","default":20,notify:function(){this._sgNode.fontSize=this.fontSize}},lineHeight:{tooltip:"i18n:COMPONENT.editbox.line_height","default":40,notify:function(){this._sgNode.setLineHeight(this.lineHeight)}},fontColor:{tooltip:"i18n:COMPONENT.editbox.font_color","default":cc.Color.WHITE,notify:function(){this._sgNode.fontColor=this.fontColor}},placeholder:{tooltip:"i18n:COMPONENT.editbox.placeholder","default":"Enter text here...",notify:function(){this._sgNode.placeholder=this.placeholder}},placeholderFontSize:{tooltip:"i18n:COMPONENT.editbox.placeholder_font_size","default":20,notify:function(){this._sgNode.placeholderFontSize=this.placeholderFontSize}},placeholderFontColor:{tooltip:"i18n:COMPONENT.editbox.placeholder_font_color","default":cc.Color.GRAY,notify:function(){this._sgNode.placeholderFontColor=this.placeholderFontColor}},maxLength:{tooltip:"i18n:COMPONENT.editbox.max_length","default":20,notify:function(){this._sgNode.maxLength=this.maxLength}},stayOnTop:{tooltip:"i18n:COMPONENT.editbox.stay_on_top","default":!1,notify:function(){}},_tabIndex:0,tabIndex:{tooltip:"i18n:COMPONENT.editbox.tab_index",get:function(){return this._tabIndex},set:function(t){this._tabIndex=t,this._sgNode.setTabIndex(t)}},editingDidBegan:{"default":[],type:cc.Component.EventHandler},textChanged:{"default":[],type:cc.Component.EventHandler},editingDidEnded:{"default":[],type:cc.Component.EventHandler},editingReturn:{"default":[],type:cc.Component.EventHandler}},statics:{KeyboardReturnType:n,InputFlag:r,InputMode:o},_applyCapInset:function(t){var e=this.backgroundImage;t.setInsetTop(e.insetTop),t.setInsetBottom(e.insetBottom),t.setInsetRight(e.insetRight),t.setInsetLeft(e.insetLeft)},_createSgNode:function(){return new _ccsg.EditBox(cc.size(160,40))},_createBackgroundSprite:function(){var t=this._sgNode,e=new cc.Scale9Sprite;return e.setRenderingType(cc.Scale9Sprite.RenderingType.SLICED),this.backgroundImage&&(this.backgroundImage.ensureLoadTexture(),e.setSpriteFrame(this.backgroundImage),this._applyCapInset(e)),t.initWithSizeAndBackgroundSprite(cc.size(160,40),e),e},_initSgNode:function(){var t=this._sgNode;this._createBackgroundSprite(),t.setContentSize(this.node.getContentSize()),t.inputMode=this.inputMode,t.maxLength=this.maxLength,t.string=this._string,t.fontSize=this.fontSize,t.fontColor=this.fontColor,t.placeholder=this.placeholder,t.placeholderFontSize=this.placeholderFontSize,t.placeholderFontColor=this.placeholderFontColor,t.inputFlag=this.inputFlag,t.returnType=this.returnType,t.setLineHeight(this.lineHeight),t.stayOnTop(this.stayOnTop),t.setTabIndex(this.tabIndex),t.setDelegate(this)},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this),this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this),this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(t,e){cc.Component.EventHandler.emitEvents(this.textChanged,e,this),this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this),
this.node.emit("editing-return",this)},__preload:function(){this._super(),this._registerEvent()},_registerEvent:function(){},_onTouchBegan:function(t){this._sgNode&&this._sgNode._onTouchBegan(t.touch),t.stopPropagation()},_onTouchEnded:function(t){this._sgNode&&this._sgNode._onTouchEnded(),t.stopPropagation()},setFocus:function(){this._sgNode&&this._sgNode.setFocus()},isFocused:function(){var t=!1;return this._sgNode&&(t=this._sgNode.isFocused()),t}});s.prototype.editBoxEditingDidBegin=function(t){this.editBoxEditingDidBegan(t)},s.prototype.editBoxEditingDidEnd=function(t){this.editBoxEditingDidEnded(t)},cc.EditBox=e.exports=s},{}],51:[function(t,e,i){var n=cc.TextAlignment,o=cc.VerticalTextAlignment,r=_ccsg.Label.Overflow,s=cc.Class({name:"cc.Label","extends":cc._RendererUnderSG,ctor:function(){},editor:!1,_updateSgNodeString:function(){this._sgNode.setString(this.string),this._updateNodeSize()},_updateSgNodeFontSize:function(){this._sgNode&&(this._sgNode.setFontSize(this._fontSize),this._updateNodeSize())},properties:{_useOriginalSize:!0,string:{"default":"Label",multiline:!0,tooltip:"i18n:COMPONENT.label.string",notify:function(){this._sgNode&&this._updateSgNodeString()}},horizontalAlign:{"default":n.LEFT,type:n,tooltip:"i18n:COMPONENT.label.horizontal_align",notify:function(){this._sgNode&&this._sgNode.setHorizontalAlign(this.horizontalAlign)},animatable:!1},verticalAlign:{"default":o.TOP,type:o,tooltip:"i18n:COMPONENT.label.vertical_align",notify:function(){this._sgNode&&this._sgNode.setVerticalAlign(this.verticalAlign)},animatable:!1},_actualFontSize:{"default":40},actualFontSize:{displayName:"Actual Font Size",animatable:!1,readonly:!0,get:function(){return this._sgNode&&(this._actualFontSize=this._sgNode.getFontSize()),this._actualFontSize}},_fontSize:40,fontSize:{get:function(){return this._fontSize},set:function(t){this._fontSize=t,this._updateSgNodeFontSize()},tooltip:"i18n:COMPONENT.label.font_size"},_lineHeight:40,lineHeight:{get:function(){return this._sgNode&&(this._lineHeight=this._sgNode.getLineHeight()),this._lineHeight},set:function(t){this._lineHeight=t,this._sgNode&&(this._sgNode.setLineHeight(t),this._updateNodeSize())},tooltip:"i18n:COMPONENT.label.line_height"},overflow:{"default":r.NONE,type:r,tooltip:"i18n:COMPONENT.label.overflow",notify:function(){this._sgNode&&(this._sgNode.setOverflow(this.overflow),this._updateNodeSize())},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return this._sgNode&&(this._enableWrapText=this._sgNode.isWrapTextEnabled()),this._enableWrapText},set:function(t){this._enableWrapText=t,this._sgNode&&this._sgNode.enableWrapText(t)},animatable:!1,tooltip:"i18n:COMPONENT.label.wrap"},_N$file:null,font:{get:function(){return this._N$file},set:function(t){if(t||(this._isSystemFontUsed=!0),this._N$file=t,this._bmFontOriginalSize=-1,t&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),this._sgNode){"string"==typeof t&&cc.warn("Sorry, the cc.Font has been modified from Raw Asset to Asset.Please load the font asset before using.");var e=t instanceof cc.Font,i=e?t.rawUrl:"",n=e?t.texture:"";this._sgNode.setFontFileOrFamily(i,n)}t instanceof cc.BitmapFont&&(this._bmFontOriginalSize=t.fontSize)},type:cc.Font,tooltip:"i18n:COMPONENT.label.font",animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(t){!t&&this._isSystemFontUsed||(this._isSystemFontUsed=!!t,t&&(this.font=null,this._sgNode&&this._sgNode.setFontFileOrFamily("Arial")))},animatable:!1,tooltip:"i18n:COMPONENT.label.system_font"},_bmFontOriginalSize:{displayName:"BMFont Original Size","default":-1,serializable:!1,readonly:!0,visible:!0,animatable:!1}},statics:{HorizontalAlign:n,VerticalAlign:o,Overflow:r},__preload:function(){this._super();var t=this._sgNode._isUseSystemFont;t&&this._updateNodeSize()},_createSgNode:function(){return null},_initSgNode:function(){"string"==typeof this.font&&cc.warn("Sorry, the cc.Font has been modified from Raw Asset to Asset.Please load the font asset before using.");var t=this.font instanceof cc.Font,e=t?this.font.rawUrl:"",i=t?this.font.texture:"";this.font instanceof cc.BitmapFont&&(this._bmFontOriginalSize=this.font.fontSize);var n=this._sgNode=new _ccsg.Label(this.string,e,i);n.setVisible(!1),n.retain(),n.setHorizontalAlign(this.horizontalAlign),n.setVerticalAlign(this.verticalAlign),n.setFontSize(this._fontSize),n.setOverflow(this.overflow),n.enableWrapText(this._enableWrapText),n.setLineHeight(this._lineHeight),n.setString(this.string),n.setContentSize(this.node.getContentSize()),n.setColor(this.node.color)},_updateNodeSize:function(){var t=this._sgNode&&this._sgNode.parent;if(t&&(this.overflow===r.NONE&&this.node.setContentSize(this._sgNode.getContentSize()),this.overflow===r.RESIZE_HEIGHT)){var e=this.node.getContentSize(),i=this._sgNode.getContentSize();this.node.setContentSize(cc.size(e.width,i.height))}}});cc.Label=e.exports=s},{}],52:[function(t,e,i){var n=cc.Class({name:"cc.LabelOutline","extends":t("./CCComponent"),editor:!1,ctor:function(){this._labelSGNode=null},properties:{_color:cc.color(255,255,255,255),_width:1,color:{get:function(){return this._color},set:function(t){this._color=cc.color(t),this._labelSGNode&&this._labelSGNode.setOutlineColor(cc.color(this._color))}},width:{get:function(){return this._width},set:function(t){this._width=t,this._labelSGNode&&(this._labelSGNode.setOutlineWidth(t),this._labelSGNode.setMargin(t))}}},onEnable:function(){var t=this.node.getComponent("cc.Label"),e=this._labelSGNode=t&&t._sgNode;this._labelSGNode&&(e.setOutlined(!0),e.setOutlineColor(cc.color(this._color)),e.setOutlineWidth(this._width),e.setMargin(this._width))},onDisable:function(){this._labelSGNode&&(this._labelSGNode.setOutlined(!1),this._labelSGNode.setMargin(0)),this._labelSGNode=null}});cc.LabelOutline=e.exports=n},{"./CCComponent":48}],53:[function(t,e,i){var n=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),o=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),r=cc.Enum({HORIZONTAL:0,VERTICAL:1}),s=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),c=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),a=cc.Class({name:"cc.Layout","extends":t("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{"default":!0,serializable:!1},_resize:o.NONE,_N$layoutType:n.NONE,type:{type:n,get:function(){return this._N$layoutType},set:function(t){this._N$layoutType=t;this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.layout_type"},resizeMode:{type:o,tooltip:"i18n:COMPONENT.layout.resize_mode",get:function(){return this._resize},set:function(t){if(this.type!==n.NONE||t!==o.CHILDREN){this._resize=t;this._doLayoutDirty()}},animatable:!1},cellSize:{"default":cc.size(40,40),tooltip:"i18n:COMPONENT.layout.cell_size",type:cc.Size,notify:function(){this._doLayoutDirty()},animatable:!1},startAxis:{"default":r.HORIZONTAL,tooltip:"i18n:COMPONENT.layout.start_axis",type:r,notify:function(){this._doLayoutDirty()},animatable:!1},padding:{"default":0,tooltip:"i18n:COMPONENT.layout.padding",notify:function(){this._doLayoutDirty()},animatable:!1},spacingX:{"default":0,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.space_x"},spacingY:{"default":0,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.space_y"},verticalDirection:{"default":s.TOP_TO_BOTTOM,type:s,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.vertical_direction"},horizontalDirection:{"default":c.LEFT_TO_RIGHT,type:c,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:"i18n:COMPONENT.layout.horizontal_direction"}},statics:{Type:n,VerticalDirection:s,HorizontalDirection:c,ResizeMode:o,AxisDirection:r},__preload:function(){cc.sizeEqualToSize(this.node.getContentSize(),cc.size(0,0))&&this.node.setContentSize(this._layoutSize),this.node.on("size-changed",this._resized,this),this.node.on("anchor-changed",this._doLayoutDirty,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-removed",this._childRemoved,this),this.node.on("child-reorder",this._doLayoutDirty,this),this._updateChildrenEventListener()},_doLayoutDirty:function(){this._layoutDirty=!0},_updateChildrenEventListener:function(){var t=this.node.children;t.forEach(function(t){t.on("size-changed",this._doLayoutDirty,this),t.on("position-changed",this._doLayoutDirty,this),t.on("anchor-changed",this._doLayoutDirty,this),t.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}.bind(this))},_childAdded:function(t){var e=t.detail;e.on("size-changed",this._doLayoutDirty,this),e.on("position-changed",this._doLayoutDirty,this),e.on("anchor-changed",this._doLayoutDirty,this),e.on("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_childRemoved:function(t){var e=t.detail;e.off("size-changed",this._doLayoutDirty,this),e.off("position-changed",this._doLayoutDirty,this),e.off("anchor-changed",this._doLayoutDirty,this),e.off("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize(),this._doLayoutDirty()},_doLayoutHorizontally:function(t,e,i,r){var a=this.node.getAnchorPoint(),h=this.node.children,l=1,u=-a.x*t;this.horizontalDirection===c.RIGHT_TO_LEFT&&(l=-1,u=(1-a.x)*t);var d=u+l*this.padding-l*this.spacingX,p=0,_=0,f=0,g=0,v=0,m=0,y=this.cellSize.width;return this.type!==n.GRID&&this.resizeMode===o.CHILDREN&&(y=(t-2*this.padding-(h.length-1)*this.spacingX)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this._resize===o.CHILDREN&&(h.width=y,this.type===n.GRID&&(h.height=this.cellSize.height));var C=h.anchorX;f>_&&(_=f),h.height>=_&&(f=_,_=h.height,m=h.getAnchorPoint().y),this.horizontalDirection===c.RIGHT_TO_LEFT&&(C=1-h.anchorX),d=d+l*C*h.width+l*this.spacingX;var T=l*(1-C)*h.width;if(e){var b=d+T+l*this.padding,E=this.horizontalDirection===c.LEFT_TO_RIGHT&&b>(1-a.x)*t,S=this.horizontalDirection===c.RIGHT_TO_LEFT&&b<-a.x*t;(E||S)&&(h.height>=_?(0===f&&(f=_),p+=f,f=_):(p+=_,f=h.height,_=0),d=u+l*(this.padding+C*h.width),g++)}var A=i(h,p,g);t>=h.width+2*this.padding&&r&&h.setPosition(cc.p(d,A));var x,O=1,N=0===_?h.height:_;this.verticalDirection===s.TOP_TO_BOTTOM?(v=v||this.node._contentSize.height,O=-1,x=A+O*(N*m+this.padding),v>x&&(v=x)):(v=v||-this.node._contentSize.height,x=A+O*(N*m+this.padding),x>v&&(v=x)),d+=T}}.bind(this)),v},_getVerticalBaseHeight:function(t){var e=0,i=0;return this.resizeMode===o.CONTAINER?(t.forEach(function(t){t.activeInHierarchy&&(i++,e+=t.height)}),e+=(i-1)*this.spacingY+2*this.padding):e=this.node.getContentSize().height,e},_doLayoutVertically:function(t,e,i,r){var a=this.node.getAnchorPoint(),h=this.node.children,l=1,u=-a.y*t;this.verticalDirection===s.TOP_TO_BOTTOM&&(l=-1,u=(1-a.y)*t);var d=u+l*this.padding-l*this.spacingY,p=0,_=0,f=0,g=0,v=0,m=0,y=this.cellSize.height;return this.type!==n.GRID&&this.resizeMode===o.CHILDREN&&(y=(t-2*this.padding-(h.length-1)*this.spacingY)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this.resizeMode===o.CHILDREN&&(h.height=y,this.type===n.GRID&&(h.width=this.cellSize.width));var C=h.anchorY;f>_&&(_=f),h.width>=_&&(f=_,_=h.width,m=h.getAnchorPoint().x),this.verticalDirection===s.TOP_TO_BOTTOM&&(C=1-h.anchorY),d=d+l*C*h.height+l*this.spacingY;var T=l*(1-C)*h.height;if(e){var b=d+T+l*this.padding,E=this.verticalDirection===s.BOTTOM_TO_TOP&&b>(1-a.y)*t,S=this.verticalDirection===s.TOP_TO_BOTTOM&&b<-a.y*t;(E||S)&&(h.width>=_?(0===f&&(f=_),p+=f,f=_):(p+=_,f=h.width,_=0),d=u+l*(this.padding+C*h.height),g++)}var A=i(h,p,g);t>=h.height+2*this.padding&&r&&h.setPosition(cc.p(A,d));var x,O=1,N=0===_?h.width:_;this.horizontalDirection===c.RIGHT_TO_LEFT?(O=-1,v=v||this.node._contentSize.width,x=A+O*(N*m+this.padding),v>x&&(v=x)):(v=v||-this.node._contentSize.width,x=A+O*(N*m+this.padding),x>v&&(v=x)),d+=T}}.bind(this)),v},_doLayoutBasic:function(){var t=this.node.children,e=null;if(t.forEach(function(t){t.activeInHierarchy&&(e=e?cc.rectUnion(e,t.getBoundingBoxToWorld()):t.getBoundingBoxToWorld())}),e){var i=this.node.parent.convertToNodeSpaceAR(cc.p(e.x,e.y)),n=this.node.parent.convertToNodeSpaceAR(cc.p(e.x+e.width,e.y+e.height)),o=cc.size(parseFloat((n.x-i.x).toFixed(2)),parseFloat((n.y-i.y).toFixed(2))),r=this.node.getPosition(),s=(r.x-i.x)/o.width,c=(r.y-i.y)/o.height,a=cc.p(parseFloat(s.toFixed(2)),parseFloat(c.toFixed(2)));this.node.setAnchorPoint(a),this.node.setContentSize(o)}},_doLayoutGridAxisHorizontal:function(t,e){var i=e.width,n=1,r=-t.y*e.height;this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,r=(1-t.y)*e.height);var c=function(t,e,i){return r+n*(e+t.anchorY*t.height+this.padding+i*this.spacingY)}.bind(this),a=0;if(this.resizeMode===o.CONTAINER){var h=this._doLayoutHorizontally(i,!0,c,!1);a=r-h,0>a&&(a*=-1),r=-t.y*a,this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,r=(1-t.y)*a)}this._doLayoutHorizontally(i,!0,c,!0),this.resizeMode===o.CONTAINER&&this.node.setContentSize(i,a)},_doLayoutGridAxisVertical:function(t,e){var i=e.height,n=1,r=-t.x*e.width;this.horizontalDirection===c.RIGHT_TO_LEFT&&(n=-1,r=(1-t.x)*e.width);var s=function(t,e,i){return r+n*(e+t.anchorX*t.width+this.padding+i*this.spacingX)}.bind(this),a=0;if(this.resizeMode===o.CONTAINER){var h=this._doLayoutVertically(i,!0,s,!1);a=r-h,0>a&&(a*=-1),r=-t.x*a,this.horizontalDirection===c.RIGHT_TO_LEFT&&(n=-1,r=(1-t.x)*a)}this._doLayoutVertically(i,!0,s,!0),this.resizeMode===o.CONTAINER&&this.node.setContentSize(a,i)},_doLayoutGrid:function(){var t=this.node.getAnchorPoint(),e=this.node.getContentSize();this.startAxis===r.HORIZONTAL?this._doLayoutGridAxisHorizontal(t,e):this.startAxis===r.VERTICAL&&this._doLayoutGridAxisVertical(t,e)},_getHorizontalBaseWidth:function(t){var e=0,i=0;return this.resizeMode===o.CONTAINER?(t.forEach(function(t){t.activeInHierarchy&&(i++,e+=t.width)}),e+=(i-1)*this.spacingX+2*this.padding):e=this.node.getContentSize().width,e},_doLayout:function(){if(this.type===n.HORIZONTAL){var t=this._getHorizontalBaseWidth(this.node.children),e=function(t){return t.y};this._doLayoutHorizontally(t,!1,e,!0),this.node.width=t}else if(this.type===n.VERTICAL){var i=this._getVerticalBaseHeight(this.node.children),r=function(t){return t.x};this._doLayoutVertically(i,!1,r,!0),this.node.height=i}else this.type===n.NONE?this.resizeMode===o.CONTAINER&&this._doLayoutBasic():this.type===n.GRID&&this._doLayoutGrid()},onEnable:function(){cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this._updateLayout,this)},onDisable:function(){cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this._updateLayout,this)},_updateLayout:function(){this._layoutDirty&&this.node.children.length>0&&(this._doLayout(),this._layoutDirty=!1)}});cc.Layout=e.exports=a},{"./CCComponent":48}],54:[function(t,e,i){var n=cc._RendererInSG,o=cc.Enum({RECT:0,ELLIPSE:1}),r=cc.Class({name:"cc.Mask","extends":n,editor:!1,properties:{_clippingStencil:{"default":null,serializable:!1},_type:0,_segements:64,type:{get:function(){return this._type},set:function(t){this._type=t,this._refreshStencil()},type:o},segements:{get:function(){return this._segements},set:function(t){3>t&&(t=3),this._segements=t,this._refreshStencil()},type:cc.Integer}},statics:{Type:o},_createSgNode:function(){return this._clippingStencil=new cc.DrawNode,this._clippingStencil.retain(),new cc.ClippingNode(this._clippingStencil)},_initSgNode:function(){},_hitTest:function(t){var e=this.node.getContentSize(),i=e.width,n=e.height,r=this.node.getNodeToWorldTransform();if(this._type===o.RECT){var s=cc.rect(0,0,i,n);cc._rectApplyAffineTransformIn(s,r);var c=t.x-s.x,a=s.x+s.width-t.x,h=t.y-s.y,l=s.y+s.height-t.y;return c>=0&&a>=0&&l>=0&&h>=0}var u=i/2,d=n/2,p=r.a*u+r.c*d+r.tx,_=r.b*u+r.d*d+r.ty,f=t.x-p,g=t.y-_;return 1>f*f/(u*u)+g*g/(d*d)},onEnable:function(){this._refreshStencil(),this._super(),this.node.on("size-changed",this._refreshStencil,this),this.node.on("anchor-changed",this._refreshStencil,this)},onDisable:function(){this._super(),this.node.off("size-changed",this._refreshStencil,this),this.node.off("anchor-changed",this._refreshStencil,this)},_calculateCircle:function(t,e,i){for(var n=[],o=2*Math.PI/i,r=0;i>r;++r)n.push(cc.v2(e.x*Math.cos(o*r)+t.x,e.y*Math.sin(o*r)+t.y));return n},_refreshStencil:function(){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=t.width,n=t.height,r=-i*e.x,s=-n*e.y,c=cc.color(255,255,255,0);if(this._clippingStencil.clear(),this._type===o.RECT){var a=[cc.v2(r,s),cc.v2(r+i,s),cc.v2(r+i,s+n),cc.v2(r,s+n)];this._clippingStencil.drawPoly(a,c,0,c)}else{var h=cc.v2(r+i/2,s+n/2),l={x:i/2,y:n/2},u=this._segements;this._clippingStencil.drawPoly(this._calculateCircle(h,l,u),c,0,c)}}});r.prototype.__superOnDestroy=n.prototype.onDestroy,r.prototype.onDestroy=function(){this.__superOnDestroy(),this._clippingStencil.release(),this._clippingStencil=null},cc.Mask=e.exports=r},{}],55:[function(t,e,i){var n=200,o=cc.Enum({Horizontal:0,Vertical:1}),r=cc.Enum({PAGE_TURNING:0}),s=cc.Class({name:"cc.PageView","extends":cc.ScrollView,editor:!1,ctor:function(){this._curPageIdx=0,this._lastPageIdx=0,this._pages=[]},properties:{direction:{"default":o.Horizontal,type:o,tooltip:"i18n:COMPONENT.pageview.direction",notify:function(){this._syncScrollDirection()}},scrollThreshold:{"default":.5,type:cc.Float,slide:!0,range:[0,1,.01],tooltip:"i18n:COMPONENT.pageview.scrollThreshold"},pageTurningEventTiming:{"default":.1,type:cc.Float,range:[0,1,.01],tooltip:"i18n:COMPONENT.pageview.pageTurningEventTiming"},indicator:{"default":null,type:cc.PageViewIndicator,tooltip:"i18n:COMPONENT.pageview.indicator",notify:function(){this.indicator&&this.indicator.setPageView(this)}},pageEvents:{"default":[],type:cc.Component.EventHandler,tooltip:"i18n:COMPONENT.pageview.pageEvents"}},statics:{Direction:o,EventType:r},__preload:function(){this._super(),this.node.on("size-changed",this._updateAllPagesSize,this),this._syncScrollDirection()},_syncScrollDirection:function(){this.horizontal=this.direction===o.Horizontal,this.vertical=this.direction===o.Vertical},onEnable:function(){this._super(),this.node.on("scroll-ended",this._dispatchPageTurningEvent,this)},onDisable:function(){this._super(),this.node.off("scroll-ended",this._dispatchPageTurningEvent,this)},onLoad:function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},onDestroy:function(){this._super(),this.node.off("size-changed",this._updateAllPagesSize,this)},getCurrentPageIndex:function(){return this._curPageIdx},setCurrentPageIndex:function(t){this.scrollToPage(t,!0)},getPages:function(){return this._pages},addPage:function(t){t&&-1===this._pages.indexOf(t)&&this.content&&(this.content.addChild(t),this._pages.push(t),this._updatePageView())},insertPage:function(t,e){if(!(0>e)&&t&&-1===this._pages.indexOf(t)&&this.content){var i=this._pages.length;e>=i?this.addPage(t):(this._pages.splice(e,0,t),this.content.addChild(t),this._updatePageView())}},removePage:function(t){if(t&&this.content){var e=this._pages.indexOf(t);return-1===e?void cc.warn("can not found the %s page.",t.name):void this.removePageAtIndex(e)}},removePageAtIndex:function(t){var e=this._pages;if(!(0>t||t>=e.length)){var i=e[t];i&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var t=this._pages,e=0,i=t.length;i>e;e++)this.content.removeChild(t[e]);this._pages.length=0,this._updatePageView()}},scrollToPage:function(t,e){0>t||t>this._pages.length||(e=void 0!==e?e:.3,this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_updatePageView:function(){var t=this._pages.length,e=this.content.getComponent(cc.Layout);e&&e.enabledInHierarchy&&e._updateLayout(),this._curPageIdx>=t&&(this._curPageIdx=0===t?0:t-1,this._lastPageIdx=this._curPageIdx);for(var i=0;t>i;++i)this._pages[i].setSiblingIndex(i);this.indicator&&this.indicator._refresh()},_updateAllPagesSize:function(){for(var t=this._pages,e=this.node.getContentSize(),i=0,n=t.length;n>i;i++)t[i].setContentSize(e)},_initPages:function(){if(this.content)for(var t=this.content.children,e=0;e<t.length;++e){var i=t[e];this._pages.indexOf(i)>=0||this._pages.push(i)}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,r.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(t){return this.direction===o.Horizontal?Math.abs(t.x)>=this.node.width*this.scrollThreshold:this.direction===o.Vertical?Math.abs(t.y)>=this.node.height*this.scrollThreshold:void 0},_moveOffsetValue:function(t){var e=cc.p(0,0);return this.direction===o.Horizontal?e.x=t*this.node.width:this.direction===o.Vertical&&(e.y=t*this.node.height),e},_updatePageIndex:function(t){var e=0;return this.direction===o.Horizontal?e+=t.x>0?1:-1:this.direction===o.Vertical&&(e+=t.y<0?1:-1),this._curPageIdx+e},_handleReleaseLogic:function(t){var e=this._startBounceBackIfNeeded();if(!e){var i=this._curPageIdx;if(0===i&&1===this._pages.length)return;var o=cc.pSub(this._touchBeganPosition,this._touchEndPosition);if(this._isScrollable(o))i=this._updatePageIndex(o);else{var r=this._calculateTouchMoveVelocity();Math.abs(r.x)>n&&(i=this._updatePageIndex(o))}this.scrollToPage(i)}},_onTouchBegan:function(t){this._touchBeganPosition=t.touch.getLocation(),this._super(t)},_onTouchMoved:function(t){this._super(t)},_onTouchEnded:function(t){this._touchEndPosition=t.touch.getLocation(),this._super(t)},_onTouchCancelled:function(t){this._touchEndPosition=t.touch.getLocation(),this._super(t)},_onMouseWheel:function(){}});cc.PageView=e.exports=s},{}],56:[function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1}),o=cc.Class({name:"cc.PageViewIndicator","extends":t("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{"default":null,type:cc.SpriteFrame,tooltip:"i18n:COMPONENT.pageview_indicator.spriteFrame"},direction:{"default":n.HORIZONTAL,type:n,tooltip:"i18n:COMPONENT.pageview_indicator.direction"},cellSize:{"default":cc.size(20,20),tooltip:"i18n:COMPONENT.layout.cell_size"},spacing:{"default":0,tooltip:"i18n:COMPONENT.pageview_indicator.spacing"}},statics:{Direction:n},onLoad:function(){this._updateLayout()},setPageView:function(t){this._pageView=t,this._refresh()},_updateLayout:function(){this._layout=this.getComponent(cc.Layout),this._layout||(this._layout=this.addComponent(cc.Layout)),this.direction===n.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===n.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL,this._layout.spacingY=this.spacing),this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var t=new cc.Node,e=t.addComponent(cc.Sprite);return e.spriteFrame=this.spriteFrame,t.parent=this.node,t.width=this.cellSize.width,t.height=this.cellSize.height,t},_changedState:function(){var t=this._indicators;if(0!==t.length){var e=this._pageView._curPageIdx;if(!(e>=t.length)){for(var i=0;i<t.length;++i){var n=t[i];n.opacity=127.5}t[e].opacity=255}}},_refresh:function(){if(this._pageView){var t=this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var i=0;if(e.length>t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createIndicator());else{var n=t.length-e.length;for(i=n;i>0;--i){var o=t[i-1];this.node.removeChild(o),t.splice(i-1,1)}}this._layout&&this._layout.enabledInHierarchy&&this._layout._updateLayout(),this._changedState()}}}});cc.PageViewIndicator=e.exports=o},{"./CCComponent":48}],57:[function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),o=cc.Class({name:"cc.ProgressBar","extends":t("./CCComponent"),editor:!1,_initBarSprite:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=this.node.getContentSize(),i=this.node.getAnchorPoint(),o=t.getContentSize();t.parent===this.node&&this.node.setContentSize(o),this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=n.FILLED);var r=t.getContentSize();if(this.mode===n.HORIZONTAL?this.totalLength=r.width:this.mode===n.VERTICAL?this.totalLength=r.height:this.totalLength=this.barSprite.fillRange,t.parent===this.node){var s=-e.width*i.x,c=0;t.setPosition(cc.p(s,c))}}},_updateBarStatus:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e,i,o,r=t.getAnchorPoint(),s=t.getContentSize(),c=t.getPosition(),a=cc.p(0,.5),h=cc.clamp01(this.progress),l=this.totalLength*h;switch(this.mode){case n.HORIZONTAL:this.reverse&&(a=cc.p(1,.5)),e=cc.size(l,s.height),i=this.totalLength,o=s.height;break;case n.VERTICAL:a=this.reverse?cc.p(.5,1):cc.p(.5,0),e=cc.size(s.width,l),i=s.width,o=this.totalLength;break;case n.FILLED:this.reverse&&(l=-1*l),this.barSprite.fillRange=l}if(this.barSprite.type!==cc.Sprite.Type.FILLED){var u=a.x-r.x,d=a.y-r.y,p=cc.p(i*u,o*d);t.setPosition(cc.pAdd(c,p)),t.setAnchorPoint(a),t.setContentSize(e)}}},properties:{barSprite:{"default":null,type:cc.Sprite,tooltip:"i18n:COMPONENT.progress.bar_sprite",notify:function(){this._initBarSprite()},animatable:!1},mode:{"default":n.HORIZONTAL,type:n,tooltip:"i18n:COMPONENT.progress.mode",notify:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=t.getContentSize();this.mode===n.HORIZONTAL?this.totalLength=e.width:this.mode===n.VERTICAL?this.totalLength=e.height:this.mode===n.FILLED&&(this.totalLength=this.barSprite.fillRange)}},animatable:!1},totalLength:{"default":1,range:[0,Number.MAX_VALUE],tooltip:"i18n:COMPONENT.progress.total_length",notify:function(t){this._updateBarStatus()}},progress:{"default":1,type:"Float",range:[0,1,.1],slide:!0,tooltip:"i18n:COMPONENT.progress.progress",notify:function(){this._updateBarStatus()}},reverse:{"default":!1,tooltip:"i18n:COMPONENT.progress.reverse",notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart),this._updateBarStatus()},animatable:!1}},statics:{Mode:n}});cc.ProgressBar=e.exports=o},{"./CCComponent":48}],58:[function(t,e,i){var n=cc.Class({"extends":t("./CCSGComponent"),name:"cc._RendererInSG",ctor:function(){var t=this._sgNode=this._createSgNode();t.setVisible(!1),t.retain(),this._plainNode=new _ccsg.Node,this._plainNode.retain()},__preload:function(){this._initSgNode()},onEnable:function(){cc.director.getActionManager().getNumberOfRunningActionsInTarget(this.node)>0&&(cc.error('The node "%s" has a component inherited from "cc._RendererInSG"',this.node.name),cc.error('JSB environment is not support invoke node.runAction before the "cc._RendererInSG" component enabled.'),cc.error('Please use runAction in the method "start" instead.')),this._replaceSgNode(this._sgNode)},onDisable:function(){this._replaceSgNode(this._plainNode)},onDestroy:function(){this._removeSgNode();var t=this.node._sgNode;this._plainNode!==t&&(this._plainNode.release(),this._plainNode=null)},_replaceSgNode:function(t){var e=this.node,i=e._sgNode;i._entity=null;var n=i.getChildren().slice();i.removeAllChildren(!1),t.getChildrenCount()>0&&t.removeAllChildren(!1);for(var o=0,r=n.length;r>o;++o)t.addChild(n[o]);var s=i.getParent();s&&(cc.runtime?(s.removeChild(i,!1),s.addChild(t),t.arrivalOrder=i.arrivalOrder):(s.insertChildBefore(t,i),s.removeChild(i,!1))),e._sgNode=t,e._sgNode._entity=e,e._updateSgNode()}});cc._RendererInSG=e.exports=n},{"./CCSGComponent":61}],59:[function(t,e,i){var n=cc.Class({"extends":t("./CCSGComponent"),name:"cc._RendererUnderSG",ctor:function(){var t=this._sgNode=this._createSgNode();t&&(t.retain(),t.setVisible(!1))},__preload:function(){this._initSgNode(),this._registSizeProvider(),this._appendSgNode(this._sgNode)},onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),this._removeSgNode()},_appendSgNode:function(t){if(t){var e=this.node;t.setColor(e._color),e._cascadeOpacityEnabled||t.setOpacity(e._opacity),t.setAnchorPoint(e._anchorPoint),t.setIgnoreAnchorPointForPosition(e.__ignoreAnchor),t.setOpacityModifyRGB(e._opacityModifyRGB),t.setLocalZOrder(-1);var i=e._sgNode;i.addChild(t)}}});cc._RendererUnderSG=e.exports=n},{"./CCSGComponent":61}],60:[function(t,e,i){t("../label/CCHtmlTextParser.js"),t("../label/CCTextUtils.js");var n=cc.TextAlignment,o=cc.VerticalTextAlignment,r=cc.Class({name:"cc.RichText","extends":cc._RendererUnderSG,ctor:function(){this._textArray=null,this._labelSegmentsCache=[],this._resetState(),this._updateRichTextStatus=this._updateRichText},editor:!1,properties:{string:{"default":"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,tooltip:"i18n:COMPONENT.richtext.string",notify:function(){this._updateRichTextStatus()}},horizontalAlign:{"default":n.LEFT,type:n,tooltip:"i18n:COMPONENT.richtext.horizontal_align",animatable:!1,notify:function(t){this.horizontalAlign!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{"default":40,tooltip:"i18n:COMPONENT.richtext.font_size",notify:function(t){this.fontSize!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},maxWidth:{"default":0,tooltip:"i18n:COMPONENT.richtext.max_width",notify:function(t){this.maxWidth!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{"default":40,tooltip:"i18n:COMPONENT.richtext.line_height",notify:function(t){this.lineHeight!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{"default":null,type:cc.SpriteAtlas,tooltip:"i18n:COMPONENT.richtext.image_atlas",notify:function(t){this.imageAtlas!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}}},statics:{HorizontalAlign:n,VerticalAlign:o},__preload:function(){this._super(),this._registerEvents()},_createSgNode:function(){var t=new _ccsg.Node;t.setCascadeOpacityEnabled(!0);var e=this;return t.setColor=function(){e._updateLabelSegmentTextAttributes()},t._setContentSize=t.setContentSize,t.setContentSize=function(){},t},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(t){this._applyTextAttribute(t)}.bind(this))},_initSgNode:function(){this._updateRichText()},_measureText:function(t,e){var i=this,n=function(e){var n;0===i._labelSegmentsCache.length?(n=new _ccsg.Label(e),i._labelSegmentsCache.push(n)):(n=i._labelSegmentsCache[0],n.setString(e)),n._styleIndex=t,i._applyTextAttribute(n);var o=n.getContentSize();return o.width};return e?n(e):n},_onTouchEnded:function(t){if(this.enabledInHierarchy)for(var e=this.node.getComponents(cc.Component),i=0;i<this._labelSegments.length;++i){var n=this._labelSegments[i],o=n._clickHandler;o&&this._containsTouchLocation(n,t.touch.getLocation())&&e.forEach(function(e){e.enabledInHierarchy&&e[o]&&e[o](t)})}},_containsTouchLocation:function(t,e){var i=t.getBoundingBoxToWorld();return cc.rectContainsPoint(i,e)},_registerEvents:function(){this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_resetState:function(){var t=this._sgNode;t&&t.removeAllChildren(),this._labelSegments=[],this._labelSegmentsCache=[],this._linesWidth=[],this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},_addLabelSegment:function(t,e){var i;0===this._labelSegmentsCache.length?i=new _ccsg.Label(t):(i=this._labelSegmentsCache.pop(),i.setString(t)),i._styleIndex=e,i._lineCount=this._lineCount,this._applyTextAttribute(i),i.setAnchorPoint(cc.p(0,0)),this._sgNode.addChild(i),this._labelSegments.push(i),i.setOverflow(1);var n=i.getContentSize();return i.setContentSize(n.width,this.lineHeight),i},_updateRichTextWithMaxWidth:function(t,e,i){var n,o=e;if(this._lineOffsetX>0&&o+this._lineOffsetX>this.maxWidth)for(var r=0;this._lineOffsetX<=this.maxWidth;){var s=this._getFirstWordLen(t,r,t.length),c=t.substr(r,s),a=this._measureText(i,c);if(!(this._lineOffsetX+a<=this.maxWidth)){if(r>0){var h=t.substr(0,r);this._addLabelSegment(h,i),t=t.substr(r,t.length),o=this._measureText(i,t);
}this._updateLineInfo();break}this._lineOffsetX+=a,r+=s}if(o>this.maxWidth)for(var l=cc.TextUtils.fragmentText(t,o,this.maxWidth,this._measureText(i)),u=0;u<l.length;++u){var d=l[u];n=this._addLabelSegment(d,i);var p=n.getContentSize();this._lineOffsetX+=p.width,l.length>1&&u<l.length-1&&this._updateLineInfo()}else this._lineOffsetX+=o,this._addLabelSegment(t,i)},_isLastComponentCR:function(t){return t.length-1===t.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;++e){var i=this._textArray[e],n=t[e];if(i.text!=n.text)return!0;if(i.style){if(n.style){if(i.style.size!==n.style.size||i.style.italic!==n.style.italic||i.style.isImage!==n.style.isImage)return!0;if(i.style.isImage===n.style.isImage&&i.style.src!==n.style.src)return!0}else if(i.style.size||i.style.italic||i.style.isImage)return!0}else if(n.style&&(n.style.size||n.style.italic||n.style.isImage))return!0}return!1},_onSpriteFrameLoaded:function(t,e){var i;i=e?e:t.target;var n=i.__sprite;n.setSpriteFrame(i)},_applySpriteFrame:function(t){t&&(t.textureLoaded()?this._onSpriteFrameLoaded(null,t):(t.once("load",this._onSpriteFrameLoaded,this),t.ensureLoadTexture()))},_addRichTextImageElement:function(t){var e=t.style.src,i=this.imageAtlas.getSpriteFrame(e);if(i){var n=new cc.Scale9Sprite;n.setAnchorPoint(cc.p(0,0)),i.__sprite=n,this._sgNode.addChild(n),this._labelSegments.push(n);var o=i.getRect(),r=1;o.height>this.lineHeight&&(r=this.lineHeight/o.height),this.maxWidth>0?(this._lineOffsetX+o.width*r>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=o.width*r):(this._lineOffsetX+=o.width*r,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),this._applySpriteFrame(i),n.setContentSize(cc.size(o.width*r,o.height*r)),n._lineCount=this._lineCount,t.style.event&&t.style.event.click&&(n._clickHandler=t.style.event.click)}else cc.warn("Invalid RichText img tag! The sprite frame name can't be found in the ImageAtlas!")},_updateRichText:function(){if(this.enabled){var t=cc.htmlTextParser.parse(this.string);if(!this._needsUpdateTextLayout(t))return this._textArray=t,void this._updateLabelSegmentTextAttributes();this._textArray=t;var e=this._sgNode;this._resetState();for(var i,n,o=!1,r=0;r<this._textArray.length;++r){var s=this._textArray[r],c=s.text;if(""===c){if(s.style&&s.style.newline){this._updateLineInfo();continue}if(s.style&&s.style.isImage&&this.imageAtlas){this._addRichTextImageElement(s);continue}}for(var a=c.split("\n"),h=0;h<a.length;++h){var l=a[h];if(""!==l)if(o=!1,this.maxWidth>0){var u=this._measureText(r,l);this._updateRichTextWithMaxWidth(l,u,r),a.length>1&&h<a.length-1&&this._updateLineInfo()}else i=this._addLabelSegment(l,r),n=i.getContentSize(),this._lineOffsetX+=n.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),a.length>1&&h<a.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(c)&&h==a.length-1)continue;this._updateLineInfo(),o=!0}}}o||this._linesWidth.push(this._lineOffsetX),this.maxWidth>0&&(this._labelWidth=this.maxWidth),this._labelHeight=this._lineCount*this.lineHeight,e._setContentSize(cc.size(this._labelWidth,this._labelHeight)),this._updateRichTextPosition(),this._layoutDirty=!1}},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(cc.TextUtils.isUnicodeCJK(n)||cc.TextUtils.isUnicodeSpace(n))return 1;for(var o=1,r=e+1;i>r&&(n=t.charAt(r),!cc.TextUtils.isUnicodeSpace(n)&&!cc.TextUtils.isUnicodeCJK(n));++r)o++;return o},_updateRichTextPosition:function(){for(var t=0,e=1,i=this._lineCount,n=0;n<this._labelSegments.length;++n){var o=this._labelSegments[n],r=o._lineCount;r>e&&(t=0,e=r);var s=0;switch(this.horizontalAlign){case cc.TextAlignment.LEFT:s=0;break;case cc.TextAlignment.CENTER:s=(this._labelWidth-this._linesWidth[r-1])/2;break;case cc.TextAlignment.RIGHT:s=this._labelWidth-this._linesWidth[r-1]}o.setPositionX(t+s);var c=o.getContentSize(),a=(i-r)*this.lineHeight;o instanceof cc.Scale9Sprite&&(a+=(this.lineHeight-o.getContentSize().height)/2),o.setPositionY(a),r===e&&(t+=c.width)}},_applyTextAttribute:function(t){if(!(t instanceof cc.Scale9Sprite)){var e=t._styleIndex;t.setLineHeight(this.lineHeight),t.setVerticalAlign(o.CENTER),t.enableBold(!1),t.enableItalics(!1),t.enableUnderline(!1);var i=null;if(this._textArray[e]&&(i=this._textArray[e].style),i&&i.color){var n=i.color.toUpperCase();cc.Color[n]?t.setColor(cc.Color[n]):t.setColor(cc.hexToColor(i.color))}else t.setColor(this.node.color);i&&i.bold&&t.enableBold(!0),i&&i.italic&&t.enableItalics(!0),i&&i.underline&&t.enableUnderline(!0),i&&i.size?t.setFontSize(i.size):t.setFontSize(this.fontSize),i&&i.event&&i.event.click&&(t._clickHandler=i.event.click)}}});cc.RichText=e.exports=r},{"../label/CCHtmlTextParser.js":88,"../label/CCTextUtils.js":89}],61:[function(t,e,i){var n=t("../utils/scene-graph-helper"),o=cc.Class({"extends":t("./CCComponent"),name:"cc._SGComponent",editor:!1,properties:{_sgNode:{"default":null,serializable:!1}},_createSgNode:null,_initSgNode:null,_removeSgNode:n.removeSgNode,_registSizeProvider:function(){if(this.node._sizeProvider);else this.node._sizeProvider=this._sgNode}});cc._SGComponent=e.exports=o},{"../utils/scene-graph-helper":129,"./CCComponent":48}],62:[function(t,e,i){var n=20,o=cc.Enum({HORIZONTAL:0,VERTICAL:1}),r=cc.Class({name:"cc.Scrollbar","extends":t("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{"default":0,serializable:!1},_opacity:255,handle:{"default":null,type:cc.Sprite,tooltip:"i18n:COMPONENT.scrollbar.handle",notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},direction:{"default":o.HORIZONTAL,type:o,tooltip:"i18n:COMPONENT.scrollbar.direction",notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},enableAutoHide:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollbar.auto_hide"},autoHideTime:{"default":1,animatable:!1,tooltip:"i18n:COMPONENT.scrollbar.auto_hide_time"}},statics:{Direction:o},setTargetScrollView:function(t){this._scrollView=t},_convertToScrollViewSpace:function(t){var e=t.convertToWorldSpace(cc.p(0,0)),i=this._scrollView.node.convertToNodeSpace(e);return i},_setOpacity:function(t){this.handle&&this.node.setOpacity(t)},_onScroll:function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e.getContentSize(),n=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(i,n))return;this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var r=0,s=0,c=0,a=0;this.direction===o.HORIZONTAL?(r=i.width,s=n.width,c=t.x,a=-this._convertToScrollViewSpace(e).x):this.direction===o.VERTICAL&&(r=i.height,s=n.height,c=t.y,a=-this._convertToScrollViewSpace(e).y);var h=this._calculateLength(r,s,c),l=this._calculatePosition(r,s,a,c,h);this._updateLength(h),this._updateHanlderPosition(l)}}},_updateHanlderPosition:function(t){if(this.handle){var e=this._fixupHandlerPosition();this.handle.node.setPosition(cc.pAdd(t,e))}},_fixupHandlerPosition:function(){var t,e=this.node.getContentSize(),i=this.node.getAnchorPoint(),n=(this.node.getPosition(),this.handle.node.parent);if(this.direction===o.HORIZONTAL){var r=this.node.convertToWorldSpaceAR(cc.p(-e.width*i.x,-e.height*i.y));t=n.convertToNodeSpaceAR(r)}else if(this.direction===o.VERTICAL){var s=this.node.convertToWorldSpaceAR(cc.p(-e.width*i.x,-e.height*i.y));t=n.convertToNodeSpaceAR(s)}return this.handle.node.setPosition(t),t},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(t,e){return t.width<=e.width&&this.direction===o.HORIZONTAL?!0:t.height<=e.height&&this.direction===o.VERTICAL},_onTouchEnded:function(){if(this.enableAutoHide&&(this._touching=!1,!(this.autoHideTime<=0))){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t.getContentSize(),i=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(t,e,i){var o=t;i&&(o+=(i>0?i:-i)*n);var r=e/o;return e*r},_calculatePosition:function(t,e,i,n,r){var s=t-e;n&&(s+=Math.abs(n));var c=0;s&&(c=i/s,c=cc.clamp01(c));var a=(e-r)*c;return this.direction===o.VERTICAL?cc.p(0,a):cc.p(a,0)},_updateLength:function(t){if(this.handle){var e=this.handle.node,i=this.node.getContentSize();e.setAnchorPoint(cc.p(0,0)),this.direction===o.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},_processAutoHide:function(t){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(e)}},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0,this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity)},update:function(t){this._processAutoHide(t)}});cc.Scrollbar=e.exports=r},{"./CCComponent":48}],63:[function(t,e,i){var n=5,o=.05,r=1e-7,s=.7,c=function(t){return t-=1,t*t*t*t*t+1},a=function(){var t=new Date;return t.getMilliseconds()},h=cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,AUTOSCROLL_ENDED:9,TOUCH_UP:10}),l={"scroll-to-top":h.SCROLL_TO_TOP,"scroll-to-bottom":h.SCROLL_TO_BOTTOM,"scroll-to-left":h.SCROLL_TO_LEFT,"scroll-to-right":h.SCROLL_TO_RIGHT,scrolling:h.SCROLLING,"bounce-bottom":h.BOUNCE_BOTTOM,"bounce-left":h.BOUNCE_LEFT,"bounce-right":h.BOUNCE_RIGHT,"bounce-top":h.BOUNCE_TOP,"scroll-ended":h.AUTOSCROLL_ENDED,"touch-up":h.TOUCH_UP},u=cc.Class({name:"cc.ScrollView","extends":t("./CCComponent"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchMoved=!1,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),this._outOfBoundaryAmount=cc.p(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0,this._isScrollEndedEventFired=!1},properties:{content:{"default":void 0,type:cc.Node,tooltip:"i18n:COMPONENT.scrollview.content"},horizontal:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.horizontal"},vertical:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.vertical"},inertia:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.inertia"},brake:{"default":.5,type:"Float",range:[0,1,.1],animatable:!1,tooltip:"i18n:COMPONENT.scrollview.brake"},elastic:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.elastic"},bounceDuration:{"default":1,range:[0,10],animatable:!1,tooltip:"i18n:COMPONENT.scrollview.bounceDuration"},horizontalScrollBar:{"default":void 0,type:cc.Scrollbar,tooltip:"i18n:COMPONENT.scrollview.horizontal_bar",notify:function(){this.horizontalScrollBar&&(this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},verticalScrollBar:{"default":void 0,type:cc.Scrollbar,tooltip:"i18n:COMPONENT.scrollview.vertical_bar",notify:function(){this.verticalScrollBar&&(this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},scrollEvents:{"default":[],type:cc.Component.EventHandler,tooltip:"i18n:COMPONENT.scrollview.scrollEvents"},cancelInnerEvents:{"default":!0,animatable:!1,tooltip:"i18n:COMPONENT.scrollview.cancelInnerEvents"}},statics:{EventType:h},scrollToBottom:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i,!0)},scrollToTop:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToTopLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToTopRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToBottomLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToBottomRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.p(1,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i)},scrollToOffset:function(t,e,i){var n=this.getMaxScrollOffset(),o=cc.p(0,0);0===n.x?o.x=0:o.x=t.x/n.x,0===n.y?o.y=1:o.y=(n.y-t.y)/n.y,this.scrollTo(o,e,i)},getScrollOffset:function(){var t=this._topBoundary-this._getContentTopBoundary(),e=this._getContentLeftBoundary()-this._leftBoundary;return cc.p(e,t)},getMaxScrollOffset:function(){var t=this.node.getContentSize(),e=this.content.getContentSize(),i=e.width-t.width,n=e.height-t.height;return i=i>=0?i:0,n=n>=0?n:0,cc.p(i,n)},scrollToPercentHorizontal:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(n,e,i!==!1):this._moveContent(n)},scrollTo:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:t,applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(n,e,i!==!1):this._moveContent(n)},scrollToPercentVertical:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(n,e,i!==!1):this._moveContent(n)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(t){if(!cc.pFuzzyEqual(t,this.getContentPosition(),r)&&(this.content.setPosition(t),this._outOfBoundaryAmountDirty=!0,this.elastic)){var e=this._getHowMuchOutOfBoundary();e.y>0&&this._dispatchEvent("bounce-top"),e.y<0&&this._dispatchEvent("bounce-bottom"),e.x>0&&this._dispatchEvent("bounce-right"),e.x<0&&this._dispatchEvent("bounce-left")}},getContentPosition:function(){return this.content.getPosition()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(t){if(this.enabledInHierarchy){var e=cc.p(0,0),i=-.1;i=-7,this.vertical?e=cc.p(0,t.getScrollY()*i):this.horizontal&&(e=cc.p(t.getScrollY()*i,0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(e),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),t.stopPropagation()}},_checkMouseWheel:function(t){var e=this._getHowMuchOutOfBoundary(),i=.1;return cc.pFuzzyEqual(e,cc.p(0,0),r)?(this._mouseWheelEventElapsedTime+=t,void(this._mouseWheelEventElapsedTime>i&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._stopMouseWheel=!1))):(this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1))},_calculateMovePercentDelta:function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e=cc.pClamp(e,cc.p(0,0),cc.p(1,1));var o=this.node.getContentSize(),r=this.content.getContentSize(),s=this._getContentBottomBoundary()-this._bottomBoundary;s=-s;var c=this._getContentLeftBoundary()-this._leftBoundary;c=-c;var a=cc.p(0,0),h=0;return i&&(h=r.width-o.width,a.x=c-h*e.x),n&&(h=r.height-o.height,a.y=s-h*e.y),a},_moveContentToTopLeft:function(t){var e=this.content.getContentSize(),i=this._getContentBottomBoundary()-this._bottomBoundary;i=-i;var n=cc.p(0,0),o=0,r=this._getContentLeftBoundary()-this._leftBoundary;r=-r,e.height<t.height?(o=e.height-t.height,n.y=i-o,this.verticalScrollBar&&this.verticalScrollBar.hide()):this.verticalScrollBar&&this.verticalScrollBar.show(),e.width<t.width?(o=e.width-t.width,n.x=r,this.horizontalScrollBar&&this.horizontalScrollBar.hide()):this.horizontalScrollBar&&this.horizontalScrollBar.show(),this._moveContent(n),this._adjustContentOutOfBoundary()},_calculateBoundary:function(){if(this.content){var t=this.content.getComponent(cc.Layout);t&&t.enabledInHierarchy&&t._updateLayout();var e=this.node.getContentSize(),i=this._convertToContentParentSpace(cc.p(0,0));this._leftBoundary=i.x,this._bottomBoundary=i.y;var n=this._convertToContentParentSpace(cc.p(e.width,e.height));this._rightBoundary=n.x,this._topBoundary=n.y,this._moveContentToTopLeft(e)}},_convertToContentParentSpace:function(t){var e=this.node.convertToWorldSpace(t),i=this.content.parent;return i.convertToNodeSpaceAR(e)},_onTouchBegan:function(t){if(this.enabledInHierarchy){var e=t.touch;this.content&&this._handlePressLogic(e),this._touchMoved=!1}},_onTouchMoved:function(t){if(this.enabledInHierarchy){var e=t.touch;if(this.content&&this._handleMoveLogic(e),this.cancelInnerEvents){var i=cc.pSub(e.getLocation(),e.getStartLocation());if(cc.pLength(i)>7){if(!this._touchMoved&&t.target!==this.node){var n=new cc.Event.EventTouch(t.getTouches(),t.bubbles);n.type=cc.Node.EventType.TOUCH_CANCEL,n.touch=t.touch,n.simulate=!0,t.target.dispatchEvent(n),this._touchMoved=!0}t.stopPropagation()}}}},_onTouchEnded:function(t){if(this.enabledInHierarchy){var e=t.touch;this.content&&this._handleReleaseLogic(e),this._dispatchEvent("touch-up"),this._touchMoved&&t.stopPropagation()}},_onTouchCancelled:function(t){if(this.enabledInHierarchy&&!t.simulate){var e=t.touch;this.content&&this._handleReleaseLogic(e)}},_processDeltaMove:function(t){this._scrollChildren(t),this._gatherTouchMove(t)},_handleMoveLogic:function(t){var e=t.getDelta();this._processDeltaMove(e)},_scrollChildren:function(t){t=this._clampDelta(t);var e,i=t;this.elastic&&(e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(i),i=cc.pAdd(i,e));var n=-1;if(i.y>0){var o=this.content.y-this.content.anchorY*this.content.height;o+i.y>this._bottomBoundary&&(n="scroll-to-bottom")}else if(i.y<0){var r=this.content.y-this.content.anchorY*this.content.height+this.content.height;r+i.y<=this._topBoundary&&(n="scroll-to-top")}else if(i.x<0){var s=this.content.x-this.content.anchorX*this.content.width+this.content.width;s+i.x<=this._rightBoundary&&(n="scroll-to-right")}else if(i.x>0){var c=this.content.x-this.content.anchorX*this.content.width;c+i.x>=this._leftBoundary&&(n="scroll-to-left")}this._moveContent(i,!1),0===i.x&&0===i.y||this._dispatchEvent("scrolling"),-1!==n&&this._dispatchEvent(n)},_handlePressLogic:function(){this._autoScrolling=!1,this._touchMovePreviousTimestamp=a(),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._onScrollBarTouchBegan()},_clampDelta:function(t){var e=this.content.getContentSize(),i=this.node.getContentSize();return e.width<i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},_gatherTouchMove:function(t){for(t=this._clampDelta(t);this._touchMoveDisplacements.length>=n;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=a();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if(t=this._clampDelta(t),cc.pFuzzyEqual(t,cc.p(0,0),r))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),!0},_processInertiaScroll:function(){var t=this._startBounceBackIfNeeded();if(!t&&this.inertia){var e=this._calculateTouchMoveVelocity();!cc.pFuzzyEqual(e,cc.p(0,0),r)&&this.brake<1&&this._startInertiaScroll(e)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(t){var e=t.getDelta();this._gatherTouchMove(e),this._processInertiaScroll()},_isOutOfBoundary:function(){var t=this._getHowMuchOutOfBoundary();return!cc.pFuzzyEqual(t,cc.p(0,0),r)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},getScrollEndedEventTiming:function(){return r},_processAutoScrolling:function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?o:1;this._autoScrollAccumulatedTime+=t*(1/i);var n=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(n=c(n));var s=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,n)),a=1===n,h=Math.abs(n-1)<=this.getScrollEndedEventTiming();if(h&&!this._isScrollEndedEventFired&&(this._dispatchEvent("scroll-ended"),this._isScrollEndedEventFired=!0),this.elastic){var l=cc.pSub(s,this._autoScrollBrakingStartPosition);e&&(l=cc.pMult(l,i)),s=cc.pAdd(this._autoScrollBrakingStartPosition,l)}else{var u=cc.pSub(s,this.getContentPosition()),d=this._getHowMuchOutOfBoundary(u);cc.pFuzzyEqual(d,cc.p(0,0),r)||(s=cc.pAdd(s,d),a=!0)}a&&(this._autoScrolling=!1,this._isScrollEndedEventFired||this._dispatchEvent("scroll-ended"));var p=cc.pSub(s,this.getContentPosition());this._moveContent(p,a)},_startInertiaScroll:function(t){var e=cc.pMult(t,s);this._startAttenuatingAutoScroll(e,t)},_calculateAttenuatedFactor:function(t){if(this.brake<=0)return 1-this.brake;var e=(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9));return e},_startAttenuatingAutoScroll:function(t,e){var i=this._calculateAutoScrollTimeByInitalSpeed(cc.pLength(e)),n=cc.pNormalize(t),o=this.content.getContentSize(),r=this.node.getContentSize(),s=o.width-r.width,c=o.height-r.height,a=this._calculateAttenuatedFactor(s),h=this._calculateAttenuatedFactor(c);n=cc.p(n.x*s*(1-this.brake)*a,n.y*c*h*(1-this.brake));var l=cc.pLength(t),u=cc.pLength(n)/l;n=cc.pAdd(n,t),this.brake>0&&u>7&&(u=Math.sqrt(u),n=cc.pAdd(cc.pMult(t,u),t)),this.brake>0&&u>3&&(u=3,i*=u),0===this.brake&&u>1&&(i*=u),this._startAutoScroll(n,i,!0)},_calculateAutoScrollTimeByInitalSpeed:function(t){var e=Math.sqrt(Math.sqrt(t/5));return e},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedEventFired=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var o=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(o,cc.p(0,0),r)){this._autoScrollCurrentlyOutOfBoundary=!0;var s=this._getHowMuchOutOfBoundary(n);(o.x*s.x>0||o.y*s.y>0)&&(this._autoScrollBraking=!0)}},_calculateTouchMoveVelocity:function(){var t=0;if(t=this._touchMoveTimeDeltas.reduce(function(t,e){return t+e},t),0>=t||t>=.5)return cc.p(0,0);var e=cc.p(0,0);return e=this._touchMoveDisplacements.reduce(function(t,e){return cc.pAdd(t,e)},e),cc.p(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t)},_flattenVectorByDirection:function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},_moveContent:function(t,e){var i=this._flattenVectorByDirection(t),n=cc.pAdd(this.getContentPosition(),i);this.setContentPosition(n);var o=this._getHowMuchOutOfBoundary();this._updateScrollBar(o),this.elastic&&e&&this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){var t=this.getContentPosition(),e=t.x-this.content.getAnchorPoint().x*this.content.getContentSize().width;return e},_getContentRightBoundary:function(){var t=this.content.getContentSize();return this._getContentLeftBoundary()+t.width},_getContentTopBoundary:function(){var t=this.content.getContentSize();return this._getContentBottomBoundary()+t.height},_getContentBottomBoundary:function(){var t=this.getContentPosition(),e=t.y-this.content.getAnchorPoint().y*this.content.getContentSize().height;return e},_getHowMuchOutOfBoundary:function(t){if(t=t||cc.p(0,0),cc.pFuzzyEqual(t,cc.p(0,0),r)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.p(0,0);return this._getContentLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x):this._getContentRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._getContentRightBoundary()+t.x)),this._getContentTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._getContentTopBoundary()+t.y):this._getContentBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y)),cc.pFuzzyEqual(t,cc.p(0,0),r)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),e=this._clampDelta(e)},_updateScrollBar:function(t){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(t),this.verticalScrollBar&&this.verticalScrollBar._onScroll(t)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(t){cc.Component.EventHandler.emitEvents(this.scrollEvents,this,l[t]),this.node.emit(t,this)},__preload:function(){this._registerEvent(),this.node.on("size-changed",this._calculateBoundary,this),this.content&&this.content.on("size-changed",this._calculateBoundary,this)},_adjustContentOutOfBoundary:function(){if(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()){var t=this._getHowMuchOutOfBoundary(cc.p(0,0)),e=cc.pAdd(this.getContentPosition(),t);this.content&&(this.content.setPosition(e),this._updateScrollBar(0))}},start:function(){this._calculateBoundary(),this.content&&cc.director.once(cc.Director.EVENT_AFTER_VISIT,this._adjustContentOutOfBoundary,this)},onDestroy:function(){this.node.off("size-changed",this._calculateBoundary,this),this.content&&this.content.off("size-changed",this._calculateBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide(),this.verticalScrollBar&&this.verticalScrollBar.hide()},_showScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.show(),this.verticalScrollBar&&this.verticalScrollBar.show()},onDisable:function(){this._hideScrollbar(),this.stopAutoScroll()},onEnable:function(){this._showScrollbar()},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)}});cc.ScrollView=e.exports=u},{"./CCComponent":48}],64:[function(t,e,i){var n=cc.Enum({Horizontal:0,Vertical:1}),o=cc.Class({name:"cc.Slider","extends":t("./CCComponent"),editor:!1,ctor:function(){this._dragging=!1},properties:{handle:{"default":null,type:cc.Button,tooltip:"i18n:COMPONENT.slider.handle",notify:function(){}},direction:{"default":n.Horizontal,type:n,tooltip:"i18n:COMPONENT.slider.direction"},progress:{"default":.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:"i18n:COMPONENT.slider.progress",notify:function(){this._updateHandlePosition()}},slideEvents:{"default":[],type:cc.Component.EventHandler,tooltip:"i18n:COMPONENT.slider.slideEvents"}},statics:{Direction:n},__preload:function(){this._registerEvent(),this._updateHandlePosition()},onDestroy:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_onHandleDragStart:function(t){this._dragging=!0,t.stopPropagation()},_onTouchBegan:function(t){this.handle&&(this._dragging=!0,this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchMoved:function(t){this._dragging&&(this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchEnded:function(t){this._dragging=!1,t.stopPropagation()},_onTouchCancelled:function(t){this._dragging=!1,t.stopPropagation()},_handleSliderLogic:function(t){this._updateProgress(t),this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},_updateProgress:function(t){if(this.handle){var e=null,i=0,o=this.node.convertTouchToNodeSpaceAR(t);this.direction===n.Horizontal?(e=this.node.width/2-this.handle.node.width*this.handle.node.anchorX,i=cc.clamp01((o.x+e)/(2*e),0,1)):this.direction===n.Vertical&&(e=this.node.height/2-this.handle.node.height*this.handle.node.anchorY,i=cc.clamp01((o.y+e)/(2*e),0,1)),this.progress=i}},_updateHandlePosition:function(){if(this.handle){var t;t=this.direction===n.Horizontal?cc.p(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.p(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);var e=this.node.convertToWorldSpaceAR(t);this.handle.node.position=this.handle.node.parent.convertToNodeSpaceAR(e)}}});cc.Slider=e.exports=o},{"./CCComponent":48}],65:[function(t,e,i){var n=t("./CCRendererUnderSG"),o=cc.Scale9Sprite.RenderingType,r=cc.Scale9Sprite.FillType,s=cc.BlendFunc.BlendFactor,c=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),a=cc.Class({name:"cc.Sprite","extends":n,editor:!1,ctor:function(){this._blendFunc=new cc.BlendFunc(this._srcBlendFactor,this._dstBlendFactor)},properties:{_spriteFrame:{"default":null,type:cc.SpriteFrame},_type:o.SIMPLE,_sizeMode:c.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_srcBlendFactor:s.SRC_ALPHA,_dstBlendFactor:s.ONE_MINUS_SRC_ALPHA,_atlas:{"default":null,type:cc.SpriteAtlas,tooltip:"i18n:COMPONENT.sprite.atlas",editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(t,e){var i=this._spriteFrame;i!==t&&(this._spriteFrame=t,this._applySpriteFrame(i))},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(t){this._type=t,this._sgNode.setRenderingType(this._type),this._applyCapInset()},type:o,animatable:!1,tooltip:"i18n:COMPONENT.sprite.type"},fillType:{get:function(){return this._fillType},set:function(t){
this._fillType=t,this._sgNode&&this._sgNode.setFillType(t)},type:r,tooltip:"i18n:COMPONENT.sprite.fill_type"},fillCenter:{get:function(){return this._fillCenter},set:function(t){this._fillCenter=cc.v2(t),this._sgNode&&this._sgNode.setFillCenter(this._fillCenter)},tooltip:"i18n:COMPONENT.sprite.fill_center"},fillStart:{get:function(){return this._fillStart},set:function(t){this._fillStart=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillStart(t)},tooltip:"i18n:COMPONENT.sprite.fill_start"},fillRange:{get:function(){return this._fillRange},set:function(t){this._fillRange=cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillRange(t)},tooltip:"i18n:COMPONENT.sprite.fill_range"},trim:{get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._sgNode.enableTrimmedContentSize(t))},animatable:!1,tooltip:"i18n:COMPONENT.sprite.trim"},srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:s,tooltip:"i18n:COMPONENT.sprite.src_blend_factor"},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:s,tooltip:"i18n:COMPONENT.sprite.dst_blend_factor"},sizeMode:{get:function(){return this._sizeMode},set:function(t){this._sizeMode=t,t!==c.CUSTOM&&this._applySpriteSize()},animatable:!1,type:c,tooltip:"i18n:COMPONENT.sprite.size_mode"}},statics:{FillType:r,Type:o,SizeMode:c},setVisible:function(t){this.enabled=t},setInsetLeft:function(t){this._sgNode.setInsetLeft(t)},getInsetLeft:function(){return this._sgNode.getInsetLeft()},setInsetTop:function(t){this._sgNode.setInsetTop(t)},getInsetTop:function(){return this._sgNode.getInsetTop()},setInsetRight:function(t){this._sgNode.setInsetRight(t)},getInsetRight:function(){return this._sgNode.getInsetRight()},setInsetBottom:function(t){this._sgNode.setInsetBottom(t)},getInsetBottom:function(){return this._sgNode.getInsetBottom()},onEnable:function(){this._sgNode&&this._spriteFrame&&this._spriteFrame.textureLoaded()&&this._sgNode.setVisible(!0)},_applyAtlas:!1,_applyCapInset:function(){if(this._type===o.SLICED&&this._spriteFrame){var t=this._sgNode;t.setInsetTop(this._spriteFrame.insetTop),t.setInsetBottom(this._spriteFrame.insetBottom),t.setInsetRight(this._spriteFrame.insetRight),t.setInsetLeft(this._spriteFrame.insetLeft)}},_applySpriteSize:function(){if(c.CUSTOM!==this._sizeMode&&this._spriteFrame)if(c.RAW===this._sizeMode){var t=this._spriteFrame.getOriginalSize();this.node.setContentSize(t)}else if(c.TRIMMED===this._sizeMode){var e=this._spriteFrame.getRect();this.node.setContentSize(cc.size(e.width,e.height))}else this.node.setContentSize(this.node.getContentSize(!0));else this.node.setContentSize(this.node.getContentSize(!0))},_onSpriteFrameLoaded:function(t){var e=this,i=this._sgNode;i.setSpriteFrame(e._spriteFrame),e._applyCapInset(),e._applySpriteSize(),e.enabledInHierarchy&&!i.isVisible()&&i.setVisible(!0)},_applySpriteFrame:function(t){var e=this._sgNode;t&&t.off&&t.off("load",this._onSpriteFrameLoaded,this);var i=this._spriteFrame;i?i.textureLoaded()?this._onSpriteFrameLoaded(null):(i.once("load",this._onSpriteFrameLoaded,this),i.ensureLoadTexture()):e.setVisible(!1)},_createSgNode:function(){return new cc.Scale9Sprite},_initSgNode:function(){this._applySpriteFrame(null);var t=this._sgNode;t.setContentSize(this.node.getContentSize(!0)),this._applySpriteSize(),t.setRenderingType(this._type),t.setFillType(this._fillType),t.setFillCenter(this._fillCenter),t.setFillStart(this._fillStart),t.setFillRange(this._fillRange),t.enableTrimmedContentSize(this._isTrimmedMode),this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc)},_resized:!1}),h=t("../utils/misc"),l=["insetLeft","insetTop","insetRight","insetBottom"],u={type:[null,"setRenderingType"]};h.propertyDefine(a,l,u),cc.Sprite=e.exports=a},{"../utils/misc":126,"./CCRendererUnderSG":59}],66:[function(t,e,i){var n=cc.Class({name:"cc.SpriteDistortion","extends":t("./CCComponent"),editor:!1,ctor:function(){this._spriteSGNode=null},properties:{_distortionOffset:cc.v2(0,0),offset:{get:function(){return this._distortionOffset},set:function(t){this._distortionOffset.x=t.x,this._distortionOffset.y=t.y,this._spriteSGNode&&this._spriteSGNode.setDistortionOffset(this._distortionOffset)}},_distortionTiling:cc.v2(1,1),tiling:{get:function(){return this._distortionTiling},set:function(t){this._distortionTiling.x=t.x,this._distortionTiling.y=t.y,this._spriteSGNode&&this._spriteSGNode.setDistortionTiling(this._distortionTiling)}}},onEnable:function(){var t=this.node.getComponent("cc.Sprite"),e=this._spriteSGNode=t&&t._sgNode;this._spriteSGNode&&(e.setState(cc.Scale9Sprite.state.DISTORTION),e.setDistortionOffset(this._distortionOffset),e.setDistortionTiling(this._distortionTiling))},onDisable:function(){this._spriteSGNode&&this._spriteSGNode.setState(cc.Scale9Sprite.state.NORMAL),this._spriteSGNode=null}});cc.SpriteDistortion=e.exports=n},{"./CCComponent":48}],67:[function(t,e,i){var n=cc.Class({name:"cc.Toggle","extends":t("./CCButton.js"),editor:!1,properties:{isChecked:{"default":!0,tooltip:"i18n:COMPONENT.toggle.isChecked",notify:function(){this._updateCheckMark()}},toggleGroup:{"default":null,tooltip:"i18n:COMPONENT.toggle.toggleGroup",type:cc.ToggleGroup},checkMark:{"default":null,type:cc.Sprite,tooltip:"i18n:COMPONENT.toggle.checkMark"},checkEvents:{"default":[],type:cc.Component.EventHandler},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},__preload:function(){this._super()},onEnable:function(){this._super(),this._registerToggleEvent(),this.toggleGroup&&this.toggleGroup.addToggle(this)},onDisable:function(){this._super(),this._unregisterToggleEvent(),this.toggleGroup&&this.toggleGroup.removeToggle(this)},_updateCheckMark:function(){this.checkMark&&(this.checkMark.enabled=!!this.isChecked)},_updateDisabledState:function(){this._super(),this.checkMark&&this.checkMark._sgNode.setState(0),this.enableAutoGrayEffect&&this.checkMark&&!this.interactable&&this.checkMark._sgNode.setState(1)},_registerToggleEvent:function(){this.node.on("click",this.toggle,this)},_unregisterToggleEvent:function(){this.node.off("click",this.toggle,this)},toggle:function(t){this.toggleGroup&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!this.isChecked,this._updateCheckMark(),this._emitToggleEvents(t),this.toggleGroup&&this.toggleGroup.updateToggles(this))},_emitToggleEvents:function(){this.node.emit("toggle",this),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,this)},check:function(){this.toggleGroup&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!0,this.node.emit("toggle",this),this.toggleGroup&&this.toggleGroup.updateToggles(this))},uncheck:function(){this.toggleGroup&&this.isChecked&&!this.toggleGroup.allowSwitchOff||(this.isChecked=!1,this.node.emit("toggle",this))}});cc.Toggle=e.exports=n},{"./CCButton.js":46}],68:[function(t,e,i){var n=cc.Class({name:"cc.ToggleGroup","extends":cc.Component,ctor:function(){this._toggleItems=[]},editor:!1,properties:{allowSwitchOff:{tooltip:"i18n:COMPONENT.toggle_group.allowSwitchOff","default":!1}},updateToggles:function(t){this.enabledInHierarchy&&this._toggleItems.forEach(function(e){t.isChecked&&e!==t&&e.isChecked&&e.enabled&&(e.isChecked=!1)})},addToggle:function(t){var e=this._toggleItems.indexOf(t);e>-1?cc.warn("Toggle alreay in ToggleGroup.Something bad happened, please report this issue to the Creator developer, thanks."):this._toggleItems.push(t),this._allowOnlyOneToggleChecked()},removeToggle:function(t){var e=this._toggleItems.indexOf(t);e>-1?this._toggleItems.splice(e,1):cc.warn("Toggle is not in ToggleGroup.Something bad happened, please report this issue to the Creator developer, thanks."),this._allowOnlyOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var t=!1;this._toggleItems.forEach(function(e){t&&e.enabled&&(e.isChecked=!1),e.isChecked&&e.enabled&&(t=!0)}),t||this.allowSwitchOff||this._toggleItems.length>0&&(this._toggleItems[0].isChecked=!0)}});cc.ToggleGroup=e.exports=n},{}],69:[function(t,e,i){var n=_ccsg.VideoPlayer.EventType,o=cc.Enum({REMOTE:0,LOCAL:1}),r=cc.Class({name:"cc.VideoPlayer","extends":cc._RendererUnderSG,editor:!1,properties:{_resourceType:o.REMOTE,resourceType:{tooltip:"i18n:COMPONENT.videoplayer.resourceType",type:o,set:function(t){this._resourceType=t,this._updateVideoSource()},get:function(){return this._resourceType}},_remoteURL:"",remoteURL:{tooltip:"i18n:COMPONENT.videoplayer.url",type:cc.String,set:function(t){this._remoteURL=t,this._updateVideoSource()},get:function(){return this._remoteURL}},_clip:{"default":null,url:cc.RawAsset},clip:{tooltip:"i18n:COMPONENT.videoplayer.video",get:function(){return this._clip},set:function(t){"string"!=typeof t&&(t=""),this._clip=t,this._updateVideoSource()},url:cc.RawAsset},currentTime:{tooltip:"i18n:COMPONENT.videoplayer.currentTime",type:cc.Float,set:function(t){this._sgNode&&this._sgNode.seekTo(t)},get:function(){return this._sgNode?this._sgNode.currentTime():-1}},keepAspectRatio:{tooltip:"i18n:COMPONENT.videoplayer.keepAspectRatio","default":!0,type:cc.Boolean,notify:function(){this._sgNode.setKeepAspectRatioEnabled(this.keepAspectRatio)}},isFullscreen:{tooltip:"i18n:COMPONENT.videoplayer.isFullscreen","default":!1,type:cc.Boolean,notify:function(){this._sgNode.setFullScreenEnabled(this.isFullscreen)}},videoPlayerEvent:{"default":[],type:cc.Component.EventHandler}},statics:{EventType:n,ResourceType:o},onLoad:function(){cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(this.enabled=!1)},_createSgNode:function(){return cc.sys.os===cc.sys.OS_OSX||cc.sys.os===cc.sys.OS_WINDOWS?(console.log("VideoPlayer is not supported on Mac and Windows!"),null):new _ccsg.VideoPlayer},_updateVideoSource:function(){var t=this._sgNode;this.resourceType===o.REMOTE?t.setURL(this.remoteURL):t.setURL(this._clip||"")},_initSgNode:function(){var t=this._sgNode;t&&(this._updateVideoSource(),t.seekTo(this.currentTime),t.setKeepAspectRatioEnabled(this.keepAspectRatio),t.setFullScreenEnabled(this.isFullscreen),t.setContentSize(this.node.getContentSize()),this.pause(),t.setEventListener(n.PLAYING,this.onPlaying.bind(this)),t.setEventListener(n.PAUSED,this.onPasued.bind(this)),t.setEventListener(n.STOPPED,this.onStopped.bind(this)),t.setEventListener(n.COMPLETED,this.onCompleted.bind(this)),t.setEventListener(n.META_LOADED,this.onMetaLoaded.bind(this)),t.setEventListener(n.CLICKED,this.onClicked.bind(this)),t.setEventListener(n.READY_TO_PLAY,this.onReadyToPlay.bind(this)))},onReadyToPlay:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.READY_TO_PLAY),this.node.emit("ready-to-play",this)},onMetaLoaded:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.META_LOADED),this.node.emit("meta-loaded",this)},onClicked:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.CLICKED),this.node.emit("clicked",this)},onPlaying:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.PLAYING),this.node.emit("playing",this)},onPasued:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.PAUSED),this.node.emit("paused",this)},onStopped:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.STOPPED),this.node.emit("stopped",this)},onCompleted:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.COMPLETED),this.node.emit("completed",this)},play:function(){this._sgNode&&this._sgNode.play()},resume:function(){this._sgNode&&this._sgNode.resume()},pause:function(){this._sgNode&&this._sgNode.pause()},stop:function(){this._sgNode&&this._sgNode.stop()},getDuration:function(){return this._sgNode?this._sgNode.duration():-1},isPlaying:function(){return this._sgNode?this._sgNode.isPlaying():!1}});cc.VideoPlayer=e.exports=r},{}],70:[function(t,e,i){var n=_ccsg.WebView.EventType,o=cc.Class({name:"cc.WebView","extends":cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_url:"",url:{type:String,tooltip:"i18n:COMPONENT.webview.url",get:function(){return this._url},set:function(t){this._url=t;var e=this._sgNode;e&&e.loadURL(t)}},webviewEvents:{"default":[],type:cc.Component.EventHandler}},statics:{EventType:n},onLoad:function(){cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(this.enabled=!1)},_createSgNode:function(){return cc.sys.os===cc.sys.OS_OSX||cc.sys.os===cc.sys.OS_WINDOWS?(console.log("WebView is not supported on Mac and Windows!"),null):new _ccsg.WebView},_initSgNode:function(){var t=this._sgNode;t&&(t.setEventListener(n.LOADED,this._onWebViewLoaded.bind(this)),t.setEventListener(n.LOADING,this._onWebViewLoading.bind(this)),t.setEventListener(n.ERROR,this._onWebViewLoadError.bind(this)),t.loadURL(this._url),t.setContentSize(this.node.getContentSize()))},_onWebViewLoaded:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.LOADED),this.node.emit("loaded",this)},_onWebViewLoading:function(){return cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.LOADING),this.node.emit("loading",this),!0},_onWebViewLoadError:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.ERROR),this.node.emit("error",this)}});cc.WebView=e.exports=o},{}],71:[function(t,e,i){var n=t("../base-ui/CCWidgetManager"),o=n._AlignFlags,r=o.TOP,s=o.MID,c=o.BOT,a=o.LEFT,h=o.CENTER,l=o.RIGHT,u=r|c,d=a|l,p=cc.Class({name:"cc.Widget","extends":t("./CCComponent"),editor:!1,properties:{isAlignTop:{get:function(){return(this._alignFlags&r)>0},set:function(t){this._setAlign(r,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_top"},isAlignVerticalCenter:{get:function(){return(this._alignFlags&s)>0},set:function(t){t?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=s):this._alignFlags&=~s},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_v_center"},isAlignBottom:{get:function(){return(this._alignFlags&c)>0},set:function(t){this._setAlign(c,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_bottom"},isAlignLeft:{get:function(){return(this._alignFlags&a)>0},set:function(t){this._setAlign(a,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_left"},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&h)>0},set:function(t){t?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=h):this._alignFlags&=~h},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_h_center"},isAlignRight:{get:function(){return(this._alignFlags&l)>0},set:function(t){this._setAlign(l,t)},animatable:!1,tooltip:"i18n:COMPONENT.widget.align_right"},isStretchWidth:{get:function(){return(this._alignFlags&d)===d},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&u)===u},visible:!1},top:{get:function(){return this._top},set:function(t){this._top=t},tooltip:"i18n:COMPONENT.widget.top"},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t},tooltip:"i18n:COMPONENT.widget.bottom"},left:{get:function(){return this._left},set:function(t){this._left=t},tooltip:"i18n:COMPONENT.widget.left"},right:{get:function(){return this._right},set:function(t){this._right=t},tooltip:"i18n:COMPONENT.widget.right"},horizontalCenter:{get:function(){return this._horizontalCenter},set:function(t){this._horizontalCenter=t},tooltip:"i18n:COMPONENT.widget.horizontal_center"},verticalCenter:{get:function(){return this._verticalCenter},set:function(t){this._verticalCenter=t},tooltip:"i18n:COMPONENT.widget.vertical_center"},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(t){this._isAbsHorizontalCenter=t},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(t){this._isAbsVerticalCenter=t},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(t){this._isAbsTop=t},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom=t},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft=t},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(t){this._isAbsRight=t},animatable:!1},isAlignOnce:{"default":!0,tooltip:"i18n:COMPONENT.widget.align_once",displayName:"AlignOnce"},_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},onEnable:function(){n.add(this)},onDisable:function(){n.remove(this)},_setAlign:function(t,e){var i=(this._alignFlags&t)>0;if(e!=i){var n=(t&d)>0;e?(this._alignFlags|=t,n?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(n?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~t)}}});cc.Widget=e.exports=p},{"../base-ui/CCWidgetManager":35,"./CCComponent":48}],72:[function(t,e,i){t("./CCComponent"),t("./CCRendererInSG"),t("./CCRendererUnderSG"),t("./CCComponentEventHandler"),t("./missing-script"),e.exports=[t("./CCSprite"),t("./CCWidget"),t("./CCCanvas"),t("./CCAudioSource"),t("./CCAnimation"),t("./CCButton"),t("./CCLabel"),t("./CCProgressBar"),t("./CCMask"),t("./CCScrollBar"),t("./CCScrollView"),t("./CCPageViewIndicator"),t("./CCPageView"),t("./CCSlider"),t("./CCLayout"),t("./CCEditBox"),t("./CCVideoPlayer"),t("./CCWebView"),t("./CCSpriteDistortion"),t("./CCLabelOutline"),t("./CCRichText"),t("./CCToggleGroup"),t("./CCToggle")]},{"./CCAnimation":44,"./CCAudioSource":45,"./CCButton":46,"./CCCanvas":47,"./CCComponent":48,"./CCComponentEventHandler":49,"./CCEditBox":50,"./CCLabel":51,"./CCLabelOutline":52,"./CCLayout":53,"./CCMask":54,"./CCPageView":55,"./CCPageViewIndicator":56,"./CCProgressBar":57,"./CCRendererInSG":58,"./CCRendererUnderSG":59,"./CCRichText":60,"./CCScrollBar":62,"./CCScrollView":63,"./CCSlider":64,"./CCSprite":65,"./CCSpriteDistortion":66,"./CCToggle":67,"./CCToggleGroup":68,"./CCVideoPlayer":69,"./CCWebView":70,"./CCWidget":71,"./missing-script":73}],73:[function(t,e,i){var n=cc.js,o=cc.Class({name:"cc.MissingClass",properties:{_$erialized:{"default":null,visible:!1,editorOnly:!0}}}),r=cc.Class({name:"cc.MissingScript","extends":cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{"default":!1,serializable:!1},_$erialized:{"default":null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(t,e){var i=n._getClassById(t);return i?i:t?(cc.deserialize.reportMissingClass(t),e.node,o):null}},onLoad:function(){cc.warn('Script attached to "%s" is missing or invalid.',this.node.name)}});cc._MissingScript=e.exports=r},{}],74:[function(t,e,i){var n=t("../event/event-target"),o=cc.Enum({KEY_DOWN:"keydown",KEY_UP:"keyup",DEVICEMOTION:"devicemotion"}),r=null,s=null,c=cc.Class({name:"SystemEvent","extends":n,statics:{EventType:o},on:function(t,e,i,n){this._super(t,e,i,n),r||t!==o.KEY_DOWN&&t!==o.KEY_UP||(r=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,e){e.type=o.KEY_DOWN,e.keyCode=t,e.isPressed=!0,cc.systemEvent.dispatchEvent(e)},onKeyReleased:function(t,e){e.type=o.KEY_UP,e.keyCode=t,e.isPressed=!1,cc.systemEvent.dispatchEvent(e)}}),cc.eventManager.addListener(r,1)),s||t!==o.DEVICEMOTION||(s=cc.EventListener.create({event:cc.EventListener.ACCELERATION,callback:function(t,e){e.type=o.DEVICEMOTION,e.acc=cc.p(t.x,t.y),cc.systemEvent.dispatchEvent(e)}}),cc.eventManager.addListener(s,1))},off:function(t,e,i,n){if(this._super(t,e,i,n),r&&(t===o.KEY_DOWN||t===o.KEY_UP)){var c=this.hasEventListener(o.KEY_DOWN),a=this.hasEventListener(o.KEY_UP);c||a||cc.eventManager.removeListener(r)}s&&t===o.DEVICEMOTION&&cc.eventManager.removeListener(s)}});cc.SystemEvent=e.exports=c,cc.systemEvent=new cc.SystemEvent},{"../event/event-target":76}],75:[function(t,e,i){function n(){r.call(this)}var o=cc.js,r=t("../platform/callbacks-invoker").CallbacksHandler,s=r.REMOVE_PLACEHOLDER;o.extend(n,r),n.prototype.invoke=function(t){var e,i,n,o,r,c=t.type,a=this._callbackTable[c];if(this._invoking[c]=!0,a)if(1===a.length)n=a[0],n!==s&&n.call(t.currentTarget,t);else if(i=a.length-1,c===cc.Director.EVENT_COMPONENT_UPDATE){var h=t.detail;for(e=1;i>=e;e+=2)o=a[e],o!==s&&o.update(h)}else for(e=0;i>=e;){n=a[e];var l=1;if(n!==s&&(o=a[e+1],r=o&&"object"==typeof o,r?(n.call(o,t),l=2):n.call(t.currentTarget,t),t._propagationImmediateStopped||e+l>i))break;e+=l}this._invoking[c]=!1,this._clearToRemove(c)},e.exports=n},{"../platform/callbacks-invoker":111}],76:[function(t,e,i){var n=t("./event-listeners");t("./event");var o=cc.js,r=o.array.fastRemove,s=new Array(16);s.length=0;var c=function(t,e){var i,n;for(e.target=t,s.length=0,t._getCapturingTargets(e.type,s),e.eventPhase=1,n=s.length-1;n>=0;--n)if(i=s[n],i._isTargetActive(e.type)&&i._capturingListeners&&(e.currentTarget=i,i._capturingListeners.invoke(e),e._propagationStopped))return void(s.length=0);if(s.length=0,t._isTargetActive(e.type)&&(e.eventPhase=2,e.currentTarget=t,t._capturingListeners&&t._capturingListeners.invoke(e),!e._propagationImmediateStopped&&t._bubblingListeners&&t._bubblingListeners.invoke(e)),!e._propagationStopped&&e.bubbles)for(t._getBubblingTargets(e.type,s),e.eventPhase=3,n=0;n<s.length;++n)if(i=s[n],i._isTargetActive(e.type)&&i._bubblingListeners&&(e.currentTarget=i,i._bubblingListeners.invoke(e),e._propagationStopped))return void(s.length=0);s.length=0},a=function(){this._capturingListeners=null,this._bubblingListeners=null};o.mixin(a.prototype,{hasEventListener:function(t,e){return e&&this._capturingListeners&&this._capturingListeners.has(t)?!0:!(e||!this._bubblingListeners||!this._bubblingListeners.has(t))},on:function(t,e,i,o){if("boolean"==typeof i?(o=i,i=void 0):o=!!o,!e)return void cc.error("Callback of event must be non-nil");var r=null;return r=o?this._capturingListeners=this._capturingListeners||new n:this._bubblingListeners=this._bubblingListeners||new n,r.has(t,e,i)||(r.add(t,e,i),i&&i.__eventTargets&&i.__eventTargets.push(this)),e},__fastOn:function(t,e,i,o){var r=this._bubblingListeners;r||(r=this._bubblingListeners=new n),r.add(t,e,i),o.push(this)},off:function(t,e,i,n){if("boolean"==typeof i?(n=i,i=void 0):n=!!n,e){var o=n?this._capturingListeners:this._bubblingListeners;o&&(o.remove(t,e,i),i&&i.__eventTargets&&r(i.__eventTargets,this))}},__fastOff:function(t,e,i,n){var o=this._bubblingListeners;o&&(o.remove(t,e,i),r(n,this))},targetOff:function(t){this._capturingListeners&&this._capturingListeners.removeAll(t),this._bubblingListeners&&this._bubblingListeners.removeAll(t)},once:function(t,e,i,n){var o=this,r=function(s){o.off(t,r,i,n),e.call(this,s)};this.on(t,r,i,n)},dispatchEvent:function(t){c(this,t),s.length=0},emit:function(t,e){var i=this._capturingListeners&&this._capturingListeners._callbackTable[t],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[t];if(i&&0!==i.length||n&&0!==n.length){var o=new cc.Event.EventCustom(t);o.detail=e,o.eventPhase=2,o.target=o.currentTarget=this,i&&this._capturingListeners.invoke(o),n&&!o._propagationImmediateStopped&&this._bubblingListeners.invoke(o)}},_isTargetActive:function(t){return!0},_getCapturingTargets:function(t,e){},_getBubblingTargets:function(t,e){}}),a.prototype._EventTargetOn=a.prototype.on,a.prototype._EventTargetOnce=a.prototype.once,a.prototype._EventTargetOff=a.prototype.off,a.prototype._EventTargetTargetOff=a.prototype.targetOff,cc.EventTarget=e.exports=a},{"./event":184,"./event-listeners":75}],77:[function(t,e,i){t("./event.js"),t("./event-listeners.js"),t("./event-target.js")},{"./event-listeners.js":75,"./event-target.js":76,"./event.js":184}],78:[function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n=e&&e.length,r=n?e[0]*i:t.length,c=o(t,0,r,i,!0),a=[];if(!c)return a;var h,l,d,p,_,f,g;if(n&&(c=u(t,e,c,i)),t.length>80*i){h=d=t[0],l=p=t[1];for(var v=i;r>v;v+=i)_=t[v],f=t[v+1],h>_&&(h=_),l>f&&(l=f),_>d&&(d=_),f>p&&(p=f);g=Math.max(d-h,p-l)}return s(c,a,i,h,l,g),a}function o(t,e,i,n,o){var r,s;if(o===P(t,e,i,n)>0)for(r=e;i>r;r+=n)s=N(r,t[r],t[r+1],s);else for(r=i-n;r>=e;r-=n)s=N(r,t[r],t[r+1],s);return s&&b(s,s.next)&&(w(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var i,n=t;do if(i=!1,n.steiner||!b(n,n.next)&&0!==T(n.prev,n,n.next))n=n.next;else{if(w(n),n=e=n.prev,n===n.next)return null;i=!0}while(i||n!==e);return e}function s(t,e,i,n,o,u,d){if(t){!d&&u&&f(t,n,o,u);for(var p,_,g=t;t.prev!==t.next;)if(p=t.prev,_=t.next,u?a(t,n,o,u):c(t))e.push(p.i/i),e.push(t.i/i),e.push(_.i/i),w(t),t=_.next,g=_.next;else if(t=_,t===g){d?1===d?(t=h(t,e,i),s(t,e,i,n,o,u,2)):2===d&&l(t,e,i,n,o,u):s(r(t),e,i,n,o,u,1);break}}}function c(t){var e=t.prev,i=t,n=t.next;if(T(e,i,n)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(y(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y)&&T(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function a(t,e,i,n){var o=t.prev,r=t,s=t.next;if(T(o,r,s)>=0)return!1;for(var c=o.x<r.x?o.x<s.x?o.x:s.x:r.x<s.x?r.x:s.x,a=o.y<r.y?o.y<s.y?o.y:s.y:r.y<s.y?r.y:s.y,h=o.x>r.x?o.x>s.x?o.x:s.x:r.x>s.x?r.x:s.x,l=o.y>r.y?o.y>s.y?o.y:s.y:r.y>s.y?r.y:s.y,u=v(c,a,e,i,n),d=v(h,l,e,i,n),p=t.nextZ;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&y(o.x,o.y,r.x,r.y,s.x,s.y,p.x,p.y)&&T(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&y(o.x,o.y,r.x,r.y,s.x,s.y,p.x,p.y)&&T(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function h(t,e,i){var n=t;do{var o=n.prev,r=n.next.next;!b(o,r)&&E(o,n,n.next,r)&&A(o,r)&&A(r,o)&&(e.push(o.i/i),e.push(n.i/i),e.push(r.i/i),w(n),w(n.next),n=t=r),n=n.next}while(n!==t);return n}function l(t,e,i,n,o,c){var a=t;do{for(var h=a.next.next;h!==a.prev;){if(a.i!==h.i&&C(a,h)){var l=O(a,h);return a=r(a,a.next),l=r(l,l.next),s(a,e,i,n,o,c),void s(l,e,i,n,o,c)}h=h.next}a=a.next}while(a!==t)}function u(t,e,i,n){var s,c,a,h,l,u=[];for(s=0,c=e.length;c>s;s++)a=e[s]*n,h=c-1>s?e[s+1]*n:t.length,l=o(t,a,h,n,!1),l===l.next&&(l.steiner=!0),u.push(m(l));for(u.sort(d),s=0;s<u.length;s++)p(u[s],i),i=r(i,i.next);return i}function d(t,e){return t.x-e.x}function p(t,e){if(e=_(t,e)){var i=O(e,t);r(i,i.next)}}function _(t,e){var i,n=e,o=t.x,r=t.y,s=-(1/0);do{if(r<=n.y&&r>=n.next.y){var c=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o>=c&&c>s){if(s=c,c===o){if(r===n.y)return n;if(r===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(o===s)return i.prev;var a,h=i,l=i.x,u=i.y,d=1/0;for(n=i.next;n!==h;)o>=n.x&&n.x>=l&&y(u>r?o:s,r,l,u,u>r?s:o,r,n.x,n.y)&&(a=Math.abs(r-n.y)/(o-n.x),(d>a||a===d&&n.x>i.x)&&A(n,t)&&(i=n,d=a)),n=n.next;return i}function f(t,e,i,n){var o=t;do null===o.z&&(o.z=v(o.x,o.y,e,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,g(o)}function g(t){var e,i,n,o,r,s,c,a,h=1;do{for(i=t,t=null,r=null,s=0;i;){for(s++,n=i,c=0,e=0;h>e&&(c++,n=n.nextZ,n);e++);for(a=h;c>0||a>0&&n;)0===c?(o=n,n=n.nextZ,a--):0!==a&&n?i.z<=n.z?(o=i,i=i.nextZ,c--):(o=n,n=n.nextZ,a--):(o=i,i=i.nextZ,c--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;i=n}r.nextZ=null,h*=2}while(s>1);return t}function v(t,e,i,n,o){return t=32767*(t-i)/o,e=32767*(e-n)/o,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function m(t){var e=t,i=t;do e.x<i.x&&(i=e),e=e.next;while(e!==t);return i}function y(t,e,i,n,o,r,s,c){return(o-s)*(e-c)-(t-s)*(r-c)>=0&&(t-s)*(n-c)-(i-s)*(e-c)>=0&&(i-s)*(r-c)-(o-s)*(n-c)>=0}function C(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!S(t,e)&&A(t,e)&&A(e,t)&&x(t,e)}function T(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,i,n){return b(t,e)&&b(i,n)||b(t,n)&&b(i,e)?!0:T(t,e,i)>0!=T(t,e,n)>0&&T(i,n,t)>0!=T(i,n,e)>0}function S(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&E(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function A(t,e){return T(t.prev,t,t.next)<0?T(t,e,t.next)>=0&&T(t,t.prev,e)>=0:T(t,e,t.prev)<0||T(t,t.next,e)<0}function x(t,e){var i=t,n=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do i.y>r!=i.next.y>r&&o<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function O(t,e){var i=new I(t.i,t.x,t.y),n=new I(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=o,o.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function N(t,e,i,n){var o=new I(t,e,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,i,n){for(var o=0,r=e,s=i-n;i>r;r+=n)o+=(t[s]-t[r])*(t[r+1]+t[s+1]),s=r;return o}e.exports=n,n.deviation=function(t,e,i,n){var o=e&&e.length,r=o?e[0]*i:t.length,s=Math.abs(P(t,0,r,i));if(o)for(var c=0,a=e.length;a>c;c++){var h=e[c]*i,l=a-1>c?e[c+1]*i:t.length;s-=Math.abs(P(t,h,l,i))}var u=0;for(c=0;c<n.length;c+=3){var d=n[c]*i,p=n[c+1]*i,_=n[c+2]*i;u+=Math.abs((t[d]-t[_])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[_+1]-t[d+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var s=0;e>s;s++)i.vertices.push(t[o][r][s]);o>0&&(n+=t[o-1].length,i.holes.push(n))}return i}},{}],79:[function(t,e,i){var n=cc.js,o=t("./types").LineCap,r=t("./types").LineJoin,s=t("./helper"),c=function(t){_ccsg.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this.cmds=[]},a=c.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);a.constructor=c,a._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,this._currentRegion.setTo(0,0,cc.visibleRect.width,cc.visibleRect.height)},a.rendering=function(t,e,i){var n=t||cc._renderContext,o=n.getContext();n.setTransform(this._worldTransform,e,i),o.save(),o.scale(1,-1);for(var r=!0,s=this.cmds,c=0,a=s.length;a>c;c++){var h=s[c],l=h[0],u=h[1];"moveTo"===l&&r?(o.beginPath(),r=!1):"fill"!==l&&"stroke"!==l&&"fillRect"!==l||(r=!0),"function"==typeof o[l]?o[l].apply(o,u):o[l]=u}o.restore()},n.mixin(a,{setStrokeColor:function(t){var e="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")";this.cmds.push(["strokeStyle",e])},setFillColor:function(t){var e="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")";this.cmds.push(["fillStyle",e])},setLineWidth:function(t){this.cmds.push(["lineWidth",t])},setLineCap:function(t){t===o.BUTT?this.cmds.push(["lineCap","butt"]):t===o.ROUND?this.cmds.push(["lineCap","round"]):t===o.SQUARE&&this.cmds.push(["lineCap","square"])},setLineJoin:function(t){t===r.BEVEL?this.cmds.push(["lineJoin","bevel"]):t===r.ROUND?this.cmds.push(["lineJoin","round"]):t===r.MITER&&this.cmds.push(["lineJoin","miter"])},setMiterLimit:function(t){this.cmds.push(["miterLimit",t])},beginPath:function(){},moveTo:function(t,e){this.cmds.push(["moveTo",arguments])},lineTo:function(){this.cmds.push(["lineTo",arguments])},bezierCurveTo:function(){this.cmds.push(["bezierCurveTo",arguments])},quadraticCurveTo:function(){this.cmds.push(["quadraticCurveTo",arguments])},arc:function(t,e,i,n,o,r){s.arc(this,t,e,i,n,o,r)},ellipse:function(t,e,i,n){s.ellipse(this,t,e,i,n)},circle:function(t,e,i){s.ellipse(this,t,e,i,i)},rect:function(t,e,i,n){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.close()},roundRect:function(t,e,i,n,o){s.roundRect(this,t,e,i,n,o)},fillRect:function(t,e,i,n){
this.cmds.push(["fillRect",arguments]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},close:function(){this.cmds.push(["closePath",arguments])},stroke:function(){this.cmds.push(["stroke",arguments]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},fill:function(){this.cmds.push(["fill",arguments]),this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},clear:function(){this.cmds.length=0,this.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)}}),e.exports=c},{"./helper":83,"./types":86}],80:[function(t,e,i){var n=t("./graphics-canvas-cmd"),o=t("./graphics-webgl-cmd"),r=t("./types").LineCap,s=t("./types").LineJoin,c=cc.js,a=_ccsg.Node.extend({ctor:function(){this._super(),this.strokeColor=cc.Color.BLACK,this.fillColor=cc.Color.WHITE},clear:function(t){this._renderCmd.clear(t)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new n(this):new o(this)}}),h=a.prototype;c.mixin(h,{_strokeColor:null,_fillColor:null,_lineWidth:1,_lineCap:r.BUTT,_lineJoin:s.MITER,_miterLimit:10,setStrokeColor:function(t){this._strokeColor=t,this._renderCmd.setStrokeColor(t)},getStrokeColor:function(){return this._strokeColor},setFillColor:function(t){this._fillColor=t,this._renderCmd.setFillColor(t)},getFillColor:function(){return this._fillColor},setLineWidth:function(t){this._lineWidth=t,this._renderCmd.setLineWidth(t)},getLineWidth:function(){return this._lineWidth},setLineCap:function(t){this._lineCap=t,this._renderCmd.setLineCap(t)},getLineCap:function(){return this._lineCap},setLineJoin:function(t){this._lineJoin=t,this._renderCmd.setLineJoin(t)},getLineJoin:function(){return this._lineJoin},setMiterLimit:function(t){this._miterLimit=t,this._renderCmd.setMiterLimit(t)},getMiterLimit:function(){return this._miterLimit},beginPath:function(){this._renderCmd.beginPath()},moveTo:function(t,e){this._renderCmd.moveTo(t,e)},lineTo:function(t,e){this._renderCmd.lineTo(t,e)},bezierCurveTo:function(t,e,i,n,o,r){this._renderCmd.bezierCurveTo(t,e,i,n,o,r)},quadraticCurveTo:function(t,e,i,n){this._renderCmd.quadraticCurveTo(t,e,i,n)},arc:function(t,e,i,n,o,r){this._renderCmd.arc(t,e,i,n,o,r)},ellipse:function(t,e,i,n){this._renderCmd.ellipse(t,e,i,n)},circle:function(t,e,i){this._renderCmd.circle(t,e,i)},rect:function(t,e,i,n){this._renderCmd.rect(t,e,i,n)},roundRect:function(t,e,i,n,o){this._renderCmd.roundRect(t,e,i,n,o)},fillRect:function(t,e,i,n){this._renderCmd.fillRect(t,e,i,n)},close:function(){this._renderCmd.close()},stroke:function(){this._renderCmd.stroke()},fill:function(){this._renderCmd.fill()}}),e.exports=a},{"./graphics-canvas-cmd":79,"./graphics-webgl-cmd":81,"./types":86}],81:[function(t,e,i){function n(t,e,i){return e>t?e:t>i?i:t}function o(t,e){d.call(this,t,e),this.reset()}function r(){this.reset()}function s(t){_ccsg.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0;var e=cc._renderContext;this._vertsOffset=0,this._vertsVBO=e.createBuffer(),this._vertsBuffer=null,this._vertsDirty=!1,this._indicesOffset=0,this._indicesVBO=e.createBuffer(),this._indicesBuffer=null,this._indicesDirty=!1,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._paths=[],this._points=[],this._cmds=[],this._blendFunc=new cc.BlendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST),this._shader=new cc.GLProgram,this._shader.initWithVertexShaderByteArray(c.vert,c.frag),this._shader.retain(),this._shader.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this._shader.link(),this._shader.updateUniforms(),this._allocVerts(_)}var c=t("./shader"),a=t("./types").LineCap,h=t("./types").LineJoin,l=t("./earcut"),u=t("./helper"),d=cc.Vec2,p=cc.js,_=32,f=2,g=8,v=Math.PI,m=Math.min,y=Math.max,C=Math.ceil,T=Math.acos,b=Math.cos,E=Math.sin,S=Math.atan2,A=Math.abs,x=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});p.extend(o,d),p.mixin(o.prototype,{reset:function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0}}),r.prototype.reset=function(){this.closed=!1,this.nbevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]},s.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype),s.prototype.constructor=s;var O=s.prototype;p.mixin(O,{_tessTol:.25,_distTol:.01,lineWidth:1,lineCap:a.BUTT,lineJoin:h.MITER,miterLimit:10,beginPath:function(){this._pathOffset=this._pathLength},moveTo:function(t,e){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1),this._addPath(),this._addPoint(t,e,x.PT_CORNER),this._commandx=t,this._commandy=e},lineTo:function(t,e){this._addPoint(t,e,x.PT_CORNER),this._commandx=t,this._commandy=e},bezierCurveTo:function(t,e,i,n,o,r){var s=this._curPath,c=s.points[s.points.length-1];return c.x===t&&c.y===e&&i===o&&n===r?void this.lineTo(o,r):(this._tesselateBezier(c.x,c.y,t,e,i,n,o,r,0,x.PT_CORNER),this._commandx=o,void(this._commandy=r))},quadraticCurveTo:function(t,e,i,n){var o=this._commandx,r=this._commandy;this.bezierCurveTo(o+2/3*(t-o),r+2/3*(e-r),i+2/3*(t-i),n+2/3*(e-n),i,n)},arc:function(t,e,i,n,o,r){u.arc(this,t,e,i,n,o,r)},ellipse:function(t,e,i,n){u.ellipse(this,t,e,i,n),this._curPath.complex=!1},circle:function(t,e,i){u.ellipse(this,t,e,i,i),this._curPath.complex=!1},rect:function(t,e,i,n){this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.close(),this._curPath.complex=!1},roundRect:function(t,e,i,n,o){u.roundRect(this,t,e,i,n,o),this._curPath.complex=!1},fillRect:function(t,e,i,n){this.rect(t,e,i,n),this.fill()},close:function(){this._curPath.closed=!0},stroke:function(){this._flattenPaths(),this._expandStroke(),this._vertsDirty=!0,this._updatePathOffset=!0},fill:function(){this._expandFill(),this._vertsDirty=!0,this._updatePathOffset=!0,this._filling=!1}}),p.mixin(O,{_strokeColor:null,_fillColor:null,setStrokeColor:function(t){this._strokeColor=t},getStrokeColor:function(){return this._strokeColor},setFillColor:function(t){this._fillColor=t},getFillColor:function(){return this._fillColor},setLineWidth:function(t){this.lineWidth=t},setLineJoin:function(t){this.lineJoin=t},setLineCap:function(t){this.lineCap=t},setMiterLimit:function(t){this.miterLimit=t}}),cc.defineGetterSetter(O,"strokeColor",O.getStrokeColor,O.setStrokeColor),cc.defineGetterSetter(O,"fillColor",O.getFillColor,O.setFillColor),p.mixin(O,{_render:function(){var t=this._vertsBuffer;if(t&&0!==t.length&&0!==this._cmds.length){var e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._vertsVBO),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indicesVBO),this._vertsDirty&&(e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW),this._vertsDirty=!1),this._indicesDirty&&this._indicesBuffer&&(e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indicesBuffer,e.STREAM_DRAW),this._indicesDirty=!1),this._vertsOffset>65536&&cc.warn("Too many graphics vertices generated, only 65536 vertices support."),e.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),e.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,g,0);for(var i=this._shader,n=i.getUniformLocationForName("color"),o=this._cmds,r=0,s=o.length;s>r;r++){var c=o[r];if(c.nIndices){var a=c.color;e.uniform4f(n,a.r/255,a.g/255,a.b/255,a.a/255),e.drawElements(e.TRIANGLES,c.nIndices,e.UNSIGNED_SHORT,2*c.indicesOffset),cc.incrementGLDraws(c.nverts)}}cc.checkGLErrorDebug()}},rendering:function(){cc.gl.blendFunc(this._blendFunc.src,this._blendFunc.dst);var t=this._worldTransform,e=this._matrix.mat;e[0]=t.a,e[4]=t.c,e[12]=t.tx,e[1]=t.b,e[5]=t.d,e[13]=t.ty;var i=this._shader;i.use(),i._setUniformForMVPMatrixWithMat4(this._matrix),this._render()},clear:function(t){this._vertsOffset=0,this._indicesOffset=0,this._pathLength=0,this._pathOffset=0,this._pointsOffset=0,this._curPath=null,this._cmds.length=0,t&&(this._paths.length=0,this._points.length=0,this._vertsBuffer=null,this._indicesBuffer=null)}}),p.mixin(O,{_updatePathOffset:!1,_paths:null,_pathLength:0,_pathOffset:0,_points:null,_pointsOffset:0,_commandx:0,_commandy:0,_addPath:function(){var t=this._pathLength,e=this._paths[t];return e?e.reset():(e=new r,this._paths.push(e)),this._pathLength++,this._curPath=e,e},_addPoint:function(t,e,i){var n=this._curPath;if(n){var r,s=this._points,c=n.points,a=this._pointsOffset++;r=s[a],r?(r.x=t,r.y=e):(r=new o(t,e),s.push(r)),r.flags=i,c.push(r)}},_flattenPaths:function(){for(var t=this._paths,e=this._pathOffset,i=this._pathLength;i>e;e++){var n=t[e],o=n.points,r=o[o.length-1],s=o[0];r.equals(s)&&(n.closed=!0,o.pop(),r=o[o.length-1]);for(var c=0,a=o.length;a>c;c++){var h=s.sub(r);r.len=h.mag(),(h.x||h.y)&&h.normalizeSelf(),r.dx=h.x,r.dy=h.y,r=s,s=o[c+1]}}},_allocVerts:function(t){var e=this._vertsOffset+t,i=this._vertsBuffer,n=i?i.length/f:0;if(e>n){for(0===n&&(n=_);e>n;)n*=2;var o=new Float32Array(n*f);if(i)for(var r=0,s=i.length;s>r;r++)o[r]=i[r];this._vertsBuffer=o}},_allocIndices:function(t){var e=this._indicesBuffer,i=this._indicesOffset+t,n=e?e.length:0;if(i>n){for(0===n&&(n=3*_);i>n;)n*=2;var o=new Uint16Array(n);if(e)for(var r=0,s=e.length;s>r;r++)o[r]=e[r];this._indicesBuffer=o}},_pushCmd:function(t){var e=this._cmds,i=e[e.length-1];if(i){var n=i.color,o=t.color;n.r===o.r&&n.g===o.g&&n.b===o.b&&n.a===o.a&&i.indicesOffset+i.nIndices===t.indicesOffset?(i.nIndices+=t.nIndices,i.nverts+=t.nverts):e.push(t)}else e.push(t)},_expandStroke:function(){var t=.5*this.lineWidth,e=this.lineCap,i=this.lineJoin,n=this.miterLimit,o=this._curveDivs(t,v,this._tessTol),r=this._paths;this._calculateJoins(t,i,n);for(var s=0,c=this._pathOffset,l=this._pathLength;l>c;c++){var u=r[c],d=u.points.length;s+=i===h.ROUND?2*(d+u.nbevel*(o+2)+1):2*(d+5*u.nbevel+1),u.closed||(s+=e===a.ROUND?2*(2*o+2):12)}this._allocVerts(s),this._allocIndices(3*(s-2*(this._pathLength-this._pathOffset)));for(var c=this._pathOffset,l=this._pathLength;l>c;c++){var p,_,f,g,m,u=r[c],y=u.points,d=u.points.length;m=u.closed;var C=this._vertsOffset;if(m?(p=y[d-1],_=y[0],f=0,g=d):(p=y[0],_=y[1],f=1,g=d-1),!m){var T=_.sub(p);T.normalizeSelf();var b=T.x,E=T.y;e===a.BUTT?this._buttCap(p,b,E,t,0):e===a.SQUARE?this._buttCap(p,b,E,t,t):e===a.ROUND&&this._roundCapStart(p,b,E,t,o)}for(var S=f;g>S;++S)i===h.ROUND?this._roundJoin(p,_,t,t,o):0!==(_.flags&(x.PT_BEVEL|x.PT_INNERBEVEL))?this._bevelJoin(p,_,t,t):(this._vset(_.x+_.dmx*t,_.y+_.dmy*t),this._vset(_.x-_.dmx*t,_.y-_.dmy*t)),p=_,_=y[S+1];if(m){var A=this._vget(C),O=this._vget(C+1);this._vset(A.x,A.y),this._vset(O.x,O.y)}else{var T=_.sub(p);T.normalizeSelf();var b=T.x,E=T.y;e===a.BUTT?this._buttCap(_,b,E,t,0):e===a.BUTT||e===a.SQUARE?this._buttCap(_,b,E,t,t):e===a.ROUND&&this._roundCapEnd(_,b,E,t,o)}for(var N=this._indicesOffset,w=this._indicesBuffer,I=C+2,P=this._vertsOffset;P>I;I++)w[N++]=I-2,w[N++]=I-1,w[N++]=I;this._pushCmd({color:this._strokeColor,indicesOffset:this._indicesOffset,nIndices:N-this._indicesOffset,vertsOffset:C,nverts:this._vertsOffset-C}),this._indicesOffset=N,this._indicesDirty=!0}},_expandFill:function(){for(var t=this._paths,e=0,i=this._pathOffset,n=this._pathLength;n>i;i++){var o=t[i],r=o.points.length;e+=r}this._allocVerts(e),this._allocIndices(3*(e-2*(this._pathLength-this._pathOffset)));for(var i=this._pathOffset,n=this._pathLength;n>i;i++){var o=t[i],s=o.points,r=s.length;if(0!==r){for(var c=this._vertsOffset,a=0;r>a;++a)this._vset(s[a].x,s[a].y,.5,1);var h=o.indicesOffset=this._indicesOffset,u=this._indicesBuffer,d=0;if(o.complex){var p=new Float32Array(this._vertsBuffer.buffer,8*c,2*(this._vertsOffset-c)),_=l(p,null,2);if(!_||0===_.length)continue;d=_.length;for(var a=0,f=d;f>a;a++)u[h+a]=_[a]+c}else{for(var g=c,v=c+2,m=this._vertsOffset;m>v;v++)u[h++]=g,u[h++]=v-1,u[h++]=v;d=h-this._indicesOffset}this._pushCmd({color:this._fillColor,indicesOffset:this._indicesOffset,nIndices:d,vertsOffset:c,nverts:this._vertsOffset-c}),this._indicesOffset+=d,this._indicesDirty=!0}}},_curveDivs:function(t,e,i){var n=2*T(t/(t+i));return y(2,C(e/n))},_calculateJoins:function(t,e,i){var n=0;t>0&&(n=1/t);for(var o=this._paths,r=this._pathOffset,s=this._pathLength;s>r;r++){var c=o[r],a=c.points,l=a.length,u=a[l-1],d=a[0],p=0;c.nbevel=0;for(var _=0;l>_;_++){var f,g,v,C=u.dy,T=-u.dx,b=d.dy,E=-d.dx;if(d.dmx=.5*(C+b),d.dmy=.5*(T+E),f=d.dmx*d.dmx+d.dmy*d.dmy,f>1e-6){var S=1/f;S>600&&(S=600),d.dmx*=S,d.dmy*=S}g=d.dx*u.dy-u.dx*d.dy,g>0&&(p++,d.flags|=x.PT_LEFT),v=y(11,m(u.len,d.len)*n),1>f*v*v&&(d.flags|=x.PT_INNERBEVEL),d.flags&x.PT_CORNER&&(1>f*i*i||e===h.BEVEL||e===h.ROUND)&&(d.flags|=x.PT_BEVEL),0!==(d.flags&(x.PT_BEVEL|x.PT_INNERBEVEL))&&c.nbevel++,u=d,d=a[_+1]}}},_vset:function(t,e){var i=this._vertsOffset*f,n=this._vertsBuffer;n[i]=t,n[i+1]=e,this._vertsOffset++},_vget:function(t){var e=this._vertsBuffer,i=t*f;return{x:e[i],y:e[i+1]}},_chooseBevel:function(t,e,i,n){var o,r,s,c,a=i.x,h=i.y;return 0!==t?(o=a+e.dy*n,r=h-e.dx*n,s=a+i.dy*n,c=h-i.dx*n):(o=s=a+i.dmx*n,r=c=h+i.dmy*n),[o,r,s,c]},_buttCap:function(t,e,i,n,o){var r=t.x-e*o,s=t.y-i*o,c=i,a=-e;this._vset(r+c*n,s+a*n),this._vset(r-c*n,s-a*n)},_roundCapStart:function(t,e,i,n,o){for(var r=t.x,s=t.y,c=i,a=-e,h=0;o>h;h++){var l=h/(o-1)*v,u=b(l)*n,d=E(l)*n;this._vset(r-c*u-e*d,s-a*u-i*d),this._vset(r,s)}this._vset(r+c*n,s+a*n),this._vset(r-c*n,s-a*n)},_roundCapEnd:function(t,e,i,n,o){var r=t.x,s=t.y,c=i,a=-e;this._vset(r+c*n,s+a*n),this._vset(r-c*n,s-a*n);for(var h=0;o>h;h++){var l=h/(o-1)*v,u=b(l)*n,d=E(l)*n;this._vset(r,s),this._vset(r-c*u+e*d,s-a*u+i*d)}},_roundJoin:function(t,e,i,o,r){var s=t.dy,c=-t.dx,a=e.dy,h=-e.dx,l=e.x,u=e.y;if(0!==(e.flags&x.PT_LEFT)){var d=this._chooseBevel(e.flags&x.PT_INNERBEVEL,t,e,i),p=d[0],_=d[1],f=d[2],g=d[3],m=S(-c,-s),y=S(-h,-a);y>m&&(y-=2*v),this._vset(p,_),this._vset(l-s*o,e.y-c*o);for(var T=n(C((m-y)/v)*r,2,r),A=0;T>A;A++){var O=A/(T-1),N=m+O*(y-m),w=l+b(N)*o,I=u+E(N)*o;this._vset(l,u),this._vset(w,I)}this._vset(f,g),this._vset(l-a*o,u-h*o)}else{var d=this._chooseBevel(e.flags&x.PT_INNERBEVEL,t,e,-o),P=d[0],L=d[1],R=d[2],M=d[3],m=S(c,s),y=S(h,a);m>y&&(y+=2*v),this._vset(l+s*o,u+c*o),this._vset(P,L);for(var T=n(C((y-m)/v)*r,2,r),A=0;T>A;A++){var O=A/(T-1),N=m+O*(y-m),F=l+b(N)*i,B=u+E(N)*i;this._vset(F,B),this._vset(l,u)}this._vset(l+a*o,u+h*o),this._vset(R,M)}},_bevelJoin:function(t,e,i,n){var o,r,s,c,a,h,l,u,d=t.dy,p=-t.dx,_=e.dy,f=-e.dx;if(e.flags&x.PT_LEFT){var g=this._chooseBevel(e.flags&x.PT_INNERBEVEL,t,e,i);a=g[0],h=g[1],l=g[2],u=g[3],this._vset(a,h),this._vset(e.x-d*n,e.y-p*n),this._vset(l,u),this._vset(e.x-_*n,e.y-f*n)}else{var g=this._chooseBevel(e.flags&x.PT_INNERBEVEL,t,e,-n);o=g[0],r=g[1],s=g[2],c=g[3],this._vset(e.x+d*i,e.y+p*i),this._vset(o,r),this._vset(e.x+_*i,e.y+f*i),this._vset(s,c)}},_tesselateBezier:function(t,e,i,n,o,r,s,c,a,h){var l,u,d,p,_,f,g,v,m,y,C,T,b,E,S,O;if(!(a>10)){if(l=.5*(t+i),u=.5*(e+n),d=.5*(i+o),p=.5*(n+r),_=.5*(o+s),f=.5*(r+c),g=.5*(l+d),v=.5*(u+p),b=s-t,E=c-e,S=A((i-s)*E-(n-c)*b),O=A((o-s)*E-(r-c)*b),(S+O)*(S+O)<this._tessTol*(b*b+E*E))return void this._addPoint(s,c,0===h?h|x.PT_BEVEL:h);m=.5*(d+_),y=.5*(p+f),C=.5*(g+m),T=.5*(v+y),this._tesselateBezier(t,e,l,u,g,v,C,T,a+1,0),this._tesselateBezier(C,T,m,y,_,f,s,c,a+1,h)}}}),e.exports=s},{"./earcut":78,"./helper":83,"./shader":85,"./types":86}],82:[function(t,e,i){var n=t("./types").LineCap,o=t("./types").LineJoin,r=cc.Class({name:"cc.Graphics","extends":cc._RendererUnderSG,editor:!1,properties:{_lineWidth:1,_strokeColor:cc.Color.BLACK,_lineJoin:o.MITER,_lineCap:n.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return this._lineWidth},set:function(t){this._sgNode.lineWidth=this._lineWidth=t}},lineJoin:{get:function(){return this._lineJoin},set:function(t){this._sgNode.lineJoin=this._lineJoin=t},type:o},lineCap:{get:function(){return this._lineCap},set:function(t){this._sgNode.lineCap=this._lineCap=t},type:n},strokeColor:{get:function(){return this._strokeColor},set:function(t){this._sgNode.strokeColor=this._strokeColor=t}},fillColor:{get:function(){return this._fillColor},set:function(t){this._sgNode.fillColor=this._fillColor=t}},miterLimit:{get:function(){return this._miterLimit},set:function(t){this._sgNode.miterLimit=this._miterLimit=t}}},statics:{LineJoin:o,LineCap:n},_createSgNode:function(){if(!_ccsg.GraphicsNode){var t=new _ccsg.Node,e=function(){};return["moveTo","lineTo","bezierCurveTo","quadraticCurveTo","arc","ellipse","circle","rect","roundRect","fillRect","clear","close","stroke","fill"].forEach(function(i){t[i]=e}),t}return new _ccsg.GraphicsNode},_initSgNode:function(){var t=this._sgNode;t.lineWidth=this._lineWidth,t.lineJoin=this._lineJoin,t.lineCap=this._lineCap,t.strokeColor=this._strokeColor,t.fillColor=this._fillColor,t.miterLimit=this._miterLimit,t.setContentSize(this.node.getContentSize(!0))},moveTo:function(t,e){this._sgNode.moveTo(t,e)},lineTo:function(t,e){this._sgNode.lineTo(t,e)},bezierCurveTo:function(t,e,i,n,o,r){this._sgNode.bezierCurveTo(t,e,i,n,o,r)},quadraticCurveTo:function(t,e,i,n){this._sgNode.quadraticCurveTo(t,e,i,n)},arc:function(t,e,i,n,o,r){r=r||!1,this._sgNode.arc(t,e,i,n,o,r)},ellipse:function(t,e,i,n){this._sgNode.ellipse(t,e,i,n)},circle:function(t,e,i){this._sgNode.circle(t,e,i)},rect:function(t,e,i,n){this._sgNode.rect(t,e,i,n)},roundRect:function(t,e,i,n,o){this._sgNode.roundRect(t,e,i,n,o)},fillRect:function(t,e,i,n){this._sgNode.fillRect(t,e,i,n)},clear:function(){this._sgNode.clear()},close:function(){this._sgNode.close()},stroke:function(){this._sgNode.stroke()},fill:function(){this._sgNode.fill()}});cc.Graphics=e.exports=r},{"./types":86}],83:[function(t,e,i){function n(t,e,i,n,o,r,d){d=d||!1;var p,_,f=0,g=0,v=0,m=0,y=0,C=0,T=0,b=0,E=0,S=0,A=0,x=0,O=0,N=0;if(g=r-o,d)if(u(g)>=2*s)g=2*s;else for(;0>g;)g+=2*s;else if(u(g)>=2*s)g=2*-s;else for(;g>0;)g-=2*s;for(_=0|a(1,c(u(g)/(.5*s)+.5,5)),v=g/_/2,m=u(4/3*(1-h(v))/l(v)),d||(m=-m),p=0;_>=p;p++)f=o+g*(p/_),y=h(f),C=l(f),T=e+y*n,b=i+C*n,E=-C*n*m,S=y*n*m,0===p?t.moveTo(T,b):t.bezierCurveTo(A+O,x+N,T-E,b-S,T,b),A=T,x=b,O=E,N=S}function o(t,e,i,n,o){t.moveTo(e-n,i),t.bezierCurveTo(e-n,i+o*p,e-n*p,i+o,e,i+o),t.bezierCurveTo(e+n*p,i+o,e+n,i+o*p,e+n,i),t.bezierCurveTo(e+n,i-o*p,e+n*p,i-o,e,i-o),t.bezierCurveTo(e-n*p,i-o,e-n,i-o*p,e-n,i),t.close()}function r(t,e,i,n,o,r){if(.1>r)return void t.rect(e,i,n,o);var s=c(r,.5*u(n))*d(n),a=c(r,.5*u(o))*d(o);t.moveTo(e,i+a),t.lineTo(e,i+o-a),t.bezierCurveTo(e,i+o-a*(1-p),e+s*(1-p),i+o,e+s,i+o),t.lineTo(e+n-s,i+o),t.bezierCurveTo(e+n-s*(1-p),i+o,e+n,i+o-a*(1-p),e+n,i+o-a),t.lineTo(e+n,i+a),t.bezierCurveTo(e+n,i+a*(1-p),e+n-s*(1-p),i,e+n-s,i),t.lineTo(e+s,i),t.bezierCurveTo(e+s*(1-p),i,e,i+a*(1-p),e,i+a),t.close()}var s=Math.PI,c=Math.min,a=Math.max,h=Math.cos,l=Math.sin,u=Math.abs,d=Math.sign,p=.5522847493;e.exports={arc:n,ellipse:o,roundRect:r}},{}],84:[function(t,e,i){"use strict";var n;if(n=cc.sys.isNative?_ccsg.GraphicsNode=cc.GraphicsNode:_ccsg.GraphicsNode=t("./graphics-node")){var o=t("../utils/misc");o.propertyDefine(n,["lineWidth","lineCap","lineJoin","miterLimit","strokeColor","fillColor"],{})}t("./graphics")},{"../utils/misc":126,"./graphics":82,"./graphics-node":80}],85:[function(t,e,i){var n=["attribute vec4 a_position;","","void main()","{","    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;","}"],o=["#ifdef GL_ES","precision mediump float;","#endif","","uniform vec4 color;","","void main(void) {","    gl_FragColor = color;","}"];e.exports={vert:n.join(" \n"),frag:o.join(" \n")}},{}],86:[function(t,e,i){"use strict";var n=cc.Enum({BUTT:0,ROUND:1,SQUARE:2}),o=cc.Enum({BEVEL:0,ROUND:1,MITER:2});e.exports={LineCap:n,LineJoin:o}},{}],87:[function(t,e,i){t("./platform"),t("./assets"),t("./CCNode"),t("./CCScene"),t("./components"),t("./graphics"),t("./collider"),t("./base-ui/CCWidgetManager")},{"./CCNode":22,"./CCScene":23,"./assets":34,"./base-ui/CCWidgetManager":35,"./collider":43,"./components":72,"./graphics":84,"./platform":114,"./sprites/CCSpriteFrameCache":122}],88:[function(t,e,i){var n=/^(click)(\s)*=/;cc.HtmlTextParser=function(){this._parsedObject={},this._specialSymbolArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"])},cc.HtmlTextParser.prototype={constructor:cc.HtmlTextParser,parse:function(t){this._resultObjectArray=[],this._stack=[];for(var e=0,i=t.length;i>e;){var n=t.indexOf("<",e);if(0>n)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{this._processResult(t.substring(e,n));var o=t.indexOf(">",e);-1===o?o=n:"/"===t.charAt(n+1)?this._stack.pop():this._addToStack(t.substring(n+1,o)),e=o+1}}return this._resultObjectArray},_attributeToObject:function(t){t=t.trim();var e,i,o,r,s={},c=t.match(/^(color|size)(\s)*=/);if(c){if(e=c[0],t=t.substring(e.length).trim(),""===t)return s;switch(i=t.indexOf(" "),e[0]){case"c":i>-1?s.color=t.substring(0,i).trim():s.color=t;break;case"s":s.size=parseInt(t)}return i>-1&&(r=t.substring(i+1).trim(),o=this._processEventHandler(r),s.event=o),s}if(c=t.match(/^(br(\s)*\/)/),c&&c[0].length>0&&(e=c[0].trim(),e.startsWith("br")&&"/"===e[e.length-1]))return s.isNewLine=!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),s;if(c=t.match(/^(img(\s)*src(\s)*=[^>]+\/)/),c&&c[0].length>0&&(e=c[0].trim(),e.startsWith("img")&&"/"===e[e.length-1])){var a,h=e.indexOf("="),l=e.substring(h+1).trim(),u=-1,d=!1;switch(l[0]){case"'":u=l.indexOf("'",1),u>-1&&(a=l.substring(1,u),d=!0);break;case'"':u=l.indexOf('"',1),u>-1&&(a=l.substring(1,u),d=!0)}return d&&(s.isImage=!0,s.src=a,r=l.substring(u+1).trim(),r.match(n)&&(o=this._processEventHandler(r),s.event=o),this._resultObjectArray.push({text:"",style:s})),{}}if(c=t.match(/^(on|u|b|i)(\s)*/),c&&c[0].length>0){switch(e=c[0],t=t.substring(e.length).trim(),e[0]){case"u":s.underline=!0;break;case"i":s.italic=!0;break;case"b":s.bold=!0}if(""===t)return s;o=this._processEventHandler(t),s.event=o}return s},_processEventHandler:function(t){for(var e=0,i={},o=t.match(n),r=!1;o;){var s=o[0],c="";if(r=!1,t=t.substring(s.length).trim(),'"'===t.charAt(0))e=t.indexOf('"',1),e>-1&&(c=t.substring(1,e).trim(),r=!0),e++;else if("'"===t.charAt(0))e=t.indexOf("'",1),e>-1&&(c=t.substring(1,e).trim(),r=!0),e++;else{var a=t.match(/(\S)+/);c=a?a[0]:"",e=c.length}r&&(s=s.substring(0,s.length-1).trim(),i[s]=c),t=t.substring(e).trim(),o=t.match(n)}return i},_addToStack:function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},_processResult:function(t){""!==t&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},_escapeSpecialSymbol:function(t){for(var e=0;e<this._specialSymbolArray.length;++e){var i=this._specialSymbolArray[e][0],n=this._specialSymbolArray[e][1];t=t.replace(i,n)}return t}},cc.htmlTextParser=new cc.HtmlTextParser},{}],89:[function(t,e,i){var n={label_wordRex:/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)/,label_symbolRex:/^[!,.:;}\]%\?>、‘“》？。，！]/,label_lastWordRex:/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)$/,label_lastEnglish:/[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+$/,label_firsrEnglish:/^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]/,label_wrapinspection:!0,isUnicodeCJK:function(t){var e=/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,i=/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,n=/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/;return e.test(t)||i.test(t)||n.test(t)},isUnicodeSpace:function(t){return t=t.charCodeAt(0),t>=9&&13>=t||32===t||133===t||160===t||5760===t||t>=8192&&8202>=t||8232===t||8233===t||8239===t||8287===t||12288===t},fragmentText:function(t,e,i,n){var o=[];if(0===t.length||0>i)return o.push(""),o;for(var r=t;e>i&&r.length>1;){for(var s=r.length*(i/e)|0,c=r.substr(s),a=e-n(c),h=c,l=0,u=0,d=10;a>i&&u++<d;)s*=i/a,s=0|s,c=r.substr(s),a=e-n(c);for(u=0;i>a&&u++<d;){if(c){var p=this.label_wordRex.exec(c);l=p?p[0].length:1,h=c}s+=l,c=r.substr(s),a=e-n(c)}s-=l,0===s&&(s=1,h=h.substr(1));var _,f=r.substr(0,s);this.label_wrapinspection&&this.label_symbolRex.test(h||c)&&(_=this.label_lastWordRex.exec(f),s-=_?_[0].length:0,0===s&&(s=1),h=r.substr(s),f=r.substr(0,s)),this.label_firsrEnglish.test(h)&&(_=this.label_lastEnglish.exec(f),_&&f!==_[0]&&(s-=_[0].length,h=r.substr(s),f=r.substr(0,s))),f.trim().length>0&&o.push(f),r=h||c,e=n(r)}return r.length>0&&o.push(r),o}};cc.TextUtils=e.exports=n},{}],90:[function(t,e,i){function n(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")}function o(){var t=new a,e=new h;s.call(this,[t,e]),this.downloader=t,this.loader=e,this.onProgress=null,this._autoReleaseSetting={}}var r=t("../platform/js"),s=t("./pipeline"),c=t("./loading-items"),a=t("./downloader"),h=t("./loader"),l=t("./asset-table"),u=t("../platform/utils").callInNextTick,d=t("./auto-release-utils"),p=new l,_=[];r.extend(o,s),r.mixin(o.prototype,{getXMLHttpRequest:n,addDownloadHandlers:function(t){this.downloader.addHandlers(t)},addLoadHandlers:function(t){this.loader.addHandlers(t)},load:function(t,e,i){void 0===i&&(i=e,e=this.onProgress||null);var n=this,o=null;t instanceof Array||(o=t,t=t?[t]:[]);for(var r=0;r<t.length;++r){var s=t[r].id||t[r];if("string"==typeof s){var a=this.getItem(s);a&&(t[r]=a)}}var h=c.create(this,e,function(t,e){u(function(){if(i){if(o){var r=o.id||o;i.call(n,e.getError(r),e.getContent(r))}else i.call(n,t,e);i=null;var r;e.destroy()}})});c.initQueueDeps(h),h.append(t)},flowInDeps:function(t,e,i){t&&!t.deps&&(t.deps=[]),_.length=0;for(var n=0;n<e.length;++n){var o=e[n].id||e[n];if("string"==typeof o){var r=this.getItem(o);r?(_.push(r),t&&t.deps.push(r)):_.push(e[n])}}var s=c.create(this,t?function(){this._ownerQueue&&this._ownerQueue.onProgress&&this._ownerQueue._childOnProgress(r)}:null,function(e,n){i(e,n),t&&(t.deps.length=0),n.destroy()});if(t){var a=c.getQueue(t);s._ownerQueue=a._ownerQueue||a}var h=s.append(_,t);return _.length=0,h},_resources:p,_getResUuid:function(t,e){var i=p.getUuid(t,e);if(!i){var n=cc.path.extname(t);n&&(t=t.slice(0,-n.length),i=p.getUuid(t,e),i&&cc.warn("loadRes: should not specify the extname in "+t+n))}return i},loadRes:function(t,e,i){i||!e||cc.isChildClassOf(e,cc.RawAsset)||(i=e,e=null);var n=this,o=n._getResUuid(t,e);o?this.load({id:o,type:"uuid",uuid:o},function(t,e){e&&n.setAutoReleaseRecursively(o,!1),i&&i(t,e)}):u(function(){var n;n=e?r.getClassName(e)+' in "'+t+'" does not exist.':'Resources url "'+t+'" does not exist.',i&&i(new Error(n),null)})},loadResAll:function(t,e,i){i||!e||cc.isChildClassOf(e,cc.RawAsset)||(i=e,e=null);var n=this,o=p.getUuidArray(t,e),r=o.length;if(r>0){for(var s=[],c=0,a=r;a>c;++c){var h=o[c];s.push({id:h,type:"uuid",uuid:h})}this.load(s,function(t,e){for(var o=[],r=0;r<s.length;++r){var c=s[r].uuid,a=e.getContent(c);a&&(n.setAutoReleaseRecursively(c,!1),o.push(a))}i&&i(t,o)})}else u(function(){i&&i(null,[])})},getRes:function(t){var e=this._cache[t];if(e&&e.alias&&(e=this._cache[e.alias]),!e){var i=this._getResUuid(t);e=this._cache[i]}return e?e.content:null},getResCount:function(){return this._cache.length},getDependsRecursively:function(t){var e;if("string"==typeof t?(e=t,this._cache[e]||(e=this._getResUuid(e)||e)):"object"==typeof t&&(e=t._uuid||null),e){var i=d.getDependsRecursively(e);return i.push(e),i}return[]},release:function(t){if(Array.isArray(t))d.autoRelease(this,t);else if(t){var e=t._uuid||t,i=this.getItem(e);if(i){var n=this.removeItem(e);t=i.content,t instanceof cc.Texture2D?cc.textureCache.removeTextureForKey(i.url):t instanceof cc.SpriteFrame&&n&&t.release()}}},releaseAsset:function(t){var e=t._uuid;e&&this.release(e)},releaseRes:function(t){var e=this._getResUuid(t);e?this.release(e):cc.error('Resources url "%s" does not exist.',t)},releaseAll:function(){for(var t in this._cache)this.release(t)},removeItem:function(t){var e=s.prototype.removeItem.call(this,t);return delete this._autoReleaseSetting[t],e},setAutoRelease:function(t,e){var i=d.getKey(this,t);i&&(this._autoReleaseSetting[i]=!!e)},setAutoReleaseRecursively:function(t,e){e=!!e;var i=d.getKey(this,t);if(i){this._autoReleaseSetting[i]=e;for(var n=d.getDependsRecursively(i),o=0;o<n.length;o++){var r=n[o];this._autoReleaseSetting[r]=e}}},isAutoRelease:function(t){var e=d.getKey(this,t);return e?!!this._autoReleaseSetting[e]:!1}}),cc.loader=new o,e.exports=cc.loader},{"../platform/js":116,"../platform/utils":121,"./asset-table":91,"./auto-release-utils":92,"./downloader":93,"./loader":96,"./loading-items":97,"./pipeline":99}],91:[function(t,e,i){function n(t,e){this.uuid=t,this.type=e}function o(){this._pathToUuid={}}function r(t,e){if(t.length>e.length){var i=t.charCodeAt(e.length);return 46===i||47===i}return!0}cc.js.mixin(o.prototype,{getUuid:function(t,e){t=cc.url.normalize(t);var i=this._pathToUuid[t];if(i)if(Array.isArray(i)){if(!e)return i[0].uuid;for(var n=0;n<i.length;n++){var o=i[n];if(cc.isChildClassOf(o.type,e))return o.uuid}}else if(!e||cc.isChildClassOf(i.type,e))return i.uuid;return""},getUuidArray:function(t,e){t=cc.url.normalize(t),"/"===t[t.length-1]&&(t=t.slice(0,-1));var i,n,o=this._pathToUuid,s=[];if(e){var c=cc.isChildClassOf;for(i in o)if(i.startsWith(t)&&r(i,t)){var a=o[i];if(Array.isArray(a))for(n=0;n<a.length;n++){var h=a[n];c(h.type,e)&&s.push(h.uuid)}else c(a.type,e)&&s.push(a.uuid)}}else for(i in o)if(i.startsWith(t)&&r(i,t)){var a=o[i];if(Array.isArray(a))for(n=0;n<a.length;n++)s.push(a[n].uuid);else s.push(a.uuid)}return s},getAllPaths:function(){return Object.keys(this._pathToUuid)},add:function(t,e,i,o){t=t.substring(0,t.length-cc.path.extname(t).length);var r=new n(e,i),s=this._pathToUuid,c=s[t];c?Array.isArray(c)?o?c.unshift(r):c.push(r):o?s[t]=[r,c]:s[t]=[c,r]:s[t]=r},reset:function(){this._pathToUuid={}}}),e.exports=o},{}],92:[function(t,e,i){function n(t,e){var i=cc.loader.getItem(t);if(i){var o=i.dependKeys;if(o)for(var r=0;r<o.length;r++){var s=o[r];e[s]||(e[s]=!0,n(s,e))}}}function o(t,e,i){i&&-1!==i.indexOf(e)||t.release(e)}e.exports={getKey:function(t,e){if(e){if("string"==typeof e){var i=cc.loader.getItem(e);return i&&i.url||e}if(e._uuid)return e._uuid}return""},autoRelease:function(t,e,i){var n,r,s=t._autoReleaseSetting;if(e)for(n=0;n<e.length;n++)r=e[n],s[r]!==!1&&o(t,r,i);var c=Object.keys(s);for(n=0;n<c.length;n++)r=c[n],s[r]===!0&&o(t,r,i)},getDependsRecursively:function(t){var e={};return n(t,e),Object.keys(e)}}},{}],93:[function(t,e,i){function n(t,e,i){function n(){c.parentNode.removeChild(c),c.removeEventListener("load",n,!1),c.removeEventListener("error",o,!1),e(null,r)}function o(){c.parentNode.removeChild(c),c.removeEventListener("load",n,!1),c.removeEventListener("error",o,!1),e(new Error("Load "+r+" failed!"),r)}var r=t.url,s=document,c=document.createElement("script");c.async=i,c.src=f(r),c.addEventListener("load",n,!1),c.addEventListener("error",o,!1),s.body.appendChild(c)}function o(t,e,i){function n(){c.removeEventListener("load",n),c.removeEventListener("error",r),e&&e(null,c)}function r(){c.removeEventListener("load",n),c.removeEventListener("error",r),c.crossOrigin&&"anonymous"===c.crossOrigin.toLowerCase()?o(t,e,!1):e("Load image ("+s+") failed")}void 0===i&&(i=!0);var s=f(t.url),c=new Image;i&&"file://"!==window.location.origin&&(c.crossOrigin="anonymous"),c.complete&&c.naturalWidth>0?e(null,c):(c.addEventListener("load",n),c.addEventListener("error",r)),c.src=s}function r(t,e,i){var n=document,o=cc.path,r=document.createElement("style");r.type="text/css",n.body.appendChild(r);var s="";if(s+=isNaN(t-0)?"@font-face { font-family:"+t+"; src:":"@font-face { font-family:'"+t+"'; src:",e instanceof Array)for(var c=0,a=e.length;a>c;c++){var h=e[c];i=o.extname(h).toLowerCase(),s+="url('"+e[c]+"') format('"+g[i]+"')",s+=c===a-1?";":","}else i=i.toLowerCase(),s+="url('"+e+"') format('"+g[i]+"');";r.textContent+=s+"}";var l=document.createElement("div"),u=l.style;u.fontFamily=t,l.innerHTML=".",u.position="absolute",u.left="-100px",
u.top="-100px",n.body.appendChild(l)}function s(t,e){var i=t.url,n=t.type,o=t.name,s=t.srcs;o&&s?(-1===s.indexOf(i)&&s.push(i),r(o,s)):(n=cc.path.extname(i),o=cc.path.basename(i,n),r(o,i,n)),document.fonts?document.fonts.load("1em "+o).then(function(){e(null,null)},function(t){e(t)}):e(null,null)}function c(t,e){var i=t.id,n=this;cc.AssetLibrary.queryAssetInfo(i,function(o,r,s){if(o)e(o);else if(t.url=r,t.isRawAsset=s,s){var c=l.extname(r).toLowerCase();if(!c)return void e(new Error("Download Uuid: can not find type of raw asset["+i+"]: "+r));c=c.substr(1);var a=d.getQueue(t);v[0]={queueId:t.queueId,id:r,url:r,type:c,error:null,alias:t.id,complete:!0},a.append(v);var h=n.extMap[c]||n.extMap["default"];t.type=c,h(t,e)}else{var u=p.load(t,e);u||n.extMap.json(t,e)}})}var a,h=t("../platform/js"),l=t("../utils/CCPath"),u=t("./pipeline"),d=t("./loading-items"),p=t("./pack-downloader"),_=t("./text-downloader"),f=t("./utils").urlAppendTimestamp;a=t("./audio-downloader");var g={".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},v=[],m={js:n,png:o,jpg:o,bmp:o,jpeg:o,gif:o,ico:o,tiff:o,webp:o,image:o,mp3:a,ogg:a,wav:a,mp4:a,m4a:a,txt:_,xml:_,vsh:_,fsh:_,atlas:_,tmx:_,tsx:_,json:_,ExportJson:_,plist:_,fnt:_,font:s,eot:s,ttf:s,woff:s,svg:s,ttc:s,uuid:c,"default":_},y="Downloader",C=function(t){this.id=y,this.async=!0,this.pipeline=null,this.maxConcurrent=cc.sys.isMobile?2:512,this._curConcurrent=0,this._loadQueue=[],this.extMap=h.mixin(t,m)};C.ID=y,h.mixin(C.prototype,{addHandlers:function(t){h.mixin(this.extMap,t)},handle:function(t,e){var i=this,n=this.extMap[t.type]||this.extMap["default"];this._curConcurrent<this.maxConcurrent?(this._curConcurrent++,n.call(this,t,function(t,n){for(i._curConcurrent=Math.max(0,i._curConcurrent-1);i._curConcurrent<i.maxConcurrent;){var o=i._loadQueue.shift();if(!o)break;i.handle(o.item,o.callback)}e&&e(t,n)})):t.ignoreMaxConcurrency?n.call(this,t,function(t,i){e&&e(t,i)}):this._loadQueue.push({item:t,callback:e})}}),u.Downloader=e.exports=C},{"../platform/js":116,"../utils/CCPath":123,"./audio-downloader":184,"./loading-items":97,"./pack-downloader":98,"./pipeline":99,"./text-downloader":100,"./utils":101}],94:[function(t,e,i){t("./downloader"),t("./loader"),t("./json-unpacker"),t("./loading-items"),t("./pipeline"),t("./CCLoader")},{"./CCLoader":90,"./downloader":93,"./json-unpacker":95,"./loader":96,"./loading-items":97,"./pipeline":99}],95:[function(t,e,i){function n(){this.jsons={}}n.prototype.read=function(t,e){var i="string"==typeof e?JSON.parse(e):e;i.length!==t.length&&cc.error("Pack indices and data do not match in size");for(var n=0;n<t.length;n++){var o=t[n],r=i[n];this.jsons[o]=r}},n.prototype.retrieve=function(t){return this.jsons[t]||null},e.exports=n},{}],96:[function(t,e,i){function n(t,e){e(null,null)}function o(t,e){"string"!=typeof t.content&&e(new Error("JSON Loader: Input item doesn't contain string content"));try{var i=JSON.parse(t.content);e(null,i)}catch(n){e(new Error("JSON Loader: Parse json ["+t.id+"] failed : "+n))}}function r(t,e){t.content instanceof Image||e(new Error("Image Loader: Input item doesn't contain Image content"));var i=t.url,n=cc.textureCache.getTextureForKey(i)||new u;n.url=i,n.initWithElement(t.content),n.handleLoadedTexture(),cc.textureCache.cacheImage(i,n),e(null,n)}function s(t,e){"string"!=typeof t.content&&e(new Error("Plist Loader: Input item doesn't contain string content"));var i=cc.plistParser.parse(t.content);i?e(null,i):e(new Error("Plist Loader: Parse ["+t.id+"] failed"))}function c(t){var e=t.match(p.ITEM_EXP),i={};if(e)for(var n=0,o=e.length;o>n;n++){var r=e[n],s=r.indexOf("="),c=r.substring(0,s),a=r.substring(s+1);a.match(p.INT_EXP)?a=parseInt(a):'"'===a[0]&&(a=a.substring(1,a.length-1)),i[c]=a}return i}function a(t,e){var i,n,o=t.content,r=t.url,s={},a=c(o.match(p.INFO_EXP)[0]),h=a.padding.split(","),l=({left:parseInt(h[0]),top:parseInt(h[1]),right:parseInt(h[2]),bottom:parseInt(h[3])},c(o.match(p.COMMON_EXP)[0]));if(s.commonHeight=l.lineHeight,s.fontSize=a.size,cc._renderType===cc.game.RENDER_TYPE_WEBGL){var u=cc.configuration.getMaxTextureSize();(l.scaleW>u.width||l.scaleH>u.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==l.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");var d=c(o.match(p.PAGE_EXP)[0]);0!==d.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found"),s.atlasName=cc.path.changeBasename(r,d.file);var _=o.match(p.CHAR_EXP),f=s.fontDefDictionary={};for(i=0,n=_.length;n>i;i++){var g=c(_[i]),v=g.id;f[v]={rect:{x:g.x,y:g.y,width:g.width,height:g.height},xOffset:g.xoffset,yOffset:g.yoffset,xAdvance:g.xadvance}}var m=s.kerningDict={},y=o.match(p.KERNING_EXP);if(y)for(i=0,n=y.length;n>i;i++){var C=c(y[i]);m[C.first<<16|65535&C.second]=C.amount}e(null,s)}var h=t("../platform/js"),l=t("./pipeline"),u=t("../textures/CCTexture2D"),d=t("./uuid-loader"),p={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/},_={png:r,jpg:r,bmp:r,jpeg:r,gif:r,ico:r,tiff:r,webp:r,image:r,json:o,ExportJson:o,plist:s,fnt:a,uuid:d,prefab:d,fire:d,scene:d,"default":n},f="Loader",g=function(t){this.id=f,this.async=!0,this.pipeline=null,this.extMap=h.mixin(t,_)};g.ID=f,h.mixin(g.prototype,{addHandlers:function(t){this.extMap=h.mixin(this.extMap,t)},handle:function(t,e){var i=this.extMap[t.type]||this.extMap["default"];i.call(this,t,function(t,i){t?e&&e(t):e&&e(null,i)})}}),l.Loader=e.exports=g},{"../platform/js":116,"../textures/CCTexture2D":184,"./pipeline":99,"./uuid-loader":102}],97:[function(t,e,i){function n(t){var e=t.id||t;return"string"==typeof e}function o(t,e){var i;if("object"==typeof t&&t.id?(t.type||(t.type=c.extname(t.id).toLowerCase().substr(1)),i={queueId:e,url:t.url||t.id,error:null,content:null,complete:!1,states:{},deps:null},a.mixin(i,t)):"string"==typeof t&&(i={queueId:e,id:t,url:t,type:c.extname(t).toLowerCase().substr(1),error:null,content:null,complete:!1,states:{},deps:null}),i.skips)for(var n=0,o=i.skips.length;o>n;n++){var r=i.skips[n];i.states[r]=p.COMPLETE}return i}function r(t,e,i){if(!t||!e)return!1;var n=!1;if(f.push(e.id),e.deps){var o,s,c=e.deps;for(o=0;o<c.length;o++){if(s=c[o],s.id===t.id){n=!0;break}if(!(f.indexOf(s.id)>=0)&&s.deps&&r(t,s,!0)){n=!0;break}}}return i||(f.length=0),n}var s=t("../platform/callbacks-invoker"),c=t("../utils/CCPath"),a=t("../platform/js"),h=0|998*Math.random(),l={},u=[],d=10,p={WORKING:1,COMPLETE:2,ERROR:3},_={},f=[],g=function(t,e,i,n){s.call(this),this._id=++h,l[this._id]=this,this._pipeline=t,this._errorUrls=[],this._appending=!1,this._ownerQueue=null,this.onProgress=i,this.onComplete=n,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,this._pipeline?this.active=!0:this.active=!1,e&&e.length>0&&this.append(e)};g.ItemState=new cc.Enum(p),g.create=function(t,e,i,n){void 0===i?"function"==typeof e&&(n=e,e=i=null):void 0===n&&("function"==typeof e?(n=i,i=e,e=null):(n=i,i=null));var o=u.pop();return o?(o._pipeline=t,o.onProgress=i,o.onComplete=n,l[o._id]=o,o._pipeline&&(o.active=!0),e&&o.append(e)):o=new g(t,e,i,n),o},g.getQueue=function(t){return t.queueId?l[t.queueId]:null},g.itemComplete=function(t){var e=l[t.queueId];e&&e.itemComplete(t.id)},g.initQueueDeps=function(t){var e=_[t._id];e?(e.completed.length=0,e.deps.length=0):e=_[t._id]={completed:[],deps:[]}},g.registerDep=function(t,e){var i=t.queueId||t;if(!i)return!1;var n=_[i];if(n)-1===n.deps.indexOf(e)&&n.deps.push(e);else if(t.id)for(var o in _){var r=_[o];-1!==r.deps.indexOf(t.id)&&-1===r.deps.indexOf(e)&&r.deps.push(e)}},g.finishDep=function(t){for(var e in _){var i=_[e];-1!==i.deps.indexOf(t)&&-1===i.completed.indexOf(t)&&i.completed.push(t)}},a.mixin(g.prototype,s.prototype,{append:function(t,e){if(!this.active)return[];this._appending=!0;var i,s,c,a=[];for(i=0;i<t.length;++i)if(s=t[i],!s.queueId||this.map[s.id]){if(n(s)){c=o(s,this._id);var h=c.id;this.map[h]||(this.map[c.id]=c,this.totalCount++,g.registerDep(e||this._id,h),a.push(c))}}else{if(this.map[s.id]=s,s.complete||r(e,s)){this.totalCount++,this.itemComplete(s.id);continue}var u=this,d=l[s.queueId];d&&(this.totalCount++,g.registerDep(e||this._id,s.id),d.addListener(s.id,function(t){u.itemComplete(t.id)}))}return this._appending=!1,this.completedCount===this.totalCount?this.allComplete():this._pipeline.flowIn(a),a},_childOnProgress:function(t){if(this.onProgress){var e=_[this._id];this.onProgress(e?e.completed.length:this.completedCount,e?e.deps.length:this.totalCount,t)}},allComplete:function(){var t=0===this._errorUrls.length?null:this._errorUrls;this.onComplete&&this.onComplete(t,this)},isCompleted:function(){return this.completedCount>=this.totalCount},isItemCompleted:function(t){return!!this.completed[t]},exists:function(t){return!!this.map[t]},getContent:function(t){var e=this.map[t],i=null;return e&&(e.content?i=e.content:e.alias&&(i=this.getContent(e.alias))),i},getError:function(t){var e=this.map[t],i=null;return e&&(e.error?i=e.error:e.alias&&(i=this.getError(e.alias))),i},addListener:s.prototype.add,hasListener:s.prototype.has,removeListener:s.prototype.remove,removeAllListeners:s.prototype.removeAll,removeItem:function(t){var e=this.map[t];e&&this.completed[e.alias||t]&&(delete this.completed[t],delete this.map[t],e.alias&&(delete this.completed[e.alias],delete this.map[e.alias]),this.completedCount--,this.totalCount--)},itemComplete:function(t){var e=this.map[t];if(e){var i=this._errorUrls.indexOf(t);if(e.error&&-1===i?this._errorUrls.push(t):e.error||-1===i||this._errorUrls.splice(i,1),this.completed[t]=e,this.completedCount++,g.finishDep(t),this.onProgress){var n=_[this._id];this.onProgress(n?n.completed.length:this.completedCount,n?n.deps.length:this.totalCount,e)}this.invokeAndRemove(t,e),!this._appending&&this.completedCount>=this.totalCount&&this.allComplete()}},destroy:function(){this.active=!1,this._appending=!1,this._pipeline=null,this._ownerQueue=null,this._errorUrls.length=0,this.onProgress=null,this.onComplete=null,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,s.call(this),l[this._id]=null,_[this._id]&&(_[this._id].completed.length=0,_[this._id].deps.length=0),-1===u.indexOf(this)&&u.length<d&&u.push(this)}}),cc.LoadingItems=e.exports=g},{"../platform/callbacks-invoker":111,"../platform/js":116,"../utils/CCPath":123}],98:[function(t,e,i){function n(t,e,i){t(new Error("Can not retrieve "+e+" from packer "+i))}var o=t("./json-unpacker"),r=t("./loading-items"),s={},c={},a={};e.exports={initPacks:function(t){c=t;for(var e in t)for(var i=t[e],n=0;n<i.length;n++){var o=i[n];s[o]=e}},_loadNewPack:function(t,e,i){var s=cc.AssetLibrary.getImportedDir(e)+"/"+e+".json";r.create(cc.loader,[{id:s,ignoreMaxConcurrency:!0}],function(r,h){if(r)return cc.error("Failed to download package for "+t),i(r);var l=h.getContent(s),u=a[e];u||(console.log("Load pack %s for %s",e,t),u=a[e]=new o),u.read(c[e],l);var d=u.retrieve(t);d?i(null,d):n(i,t,e)})},load:function(t,e){var i=t.id,o=s[i];if(!o)return!1;var r=a[o];return r?setTimeout(function(){var t=r.retrieve(i);t?e(null,t):n(e,i,o)},0):this._loadNewPack(i,o,e),!0}}},{"./json-unpacker":95,"./loading-items":97}],99:[function(t,e,i){function n(t){var e=this.id,i=t.states[e],n=this.next;if(!t.error&&i!==c.WORKING&&i!==c.ERROR)if(i===c.COMPLETE)n?n.flowIn(t):this.pipeline.flowOut(t);else{t.states[e]=c.WORKING;var o=this;this.handle(t,function(i,r){i?(t.error=i,t.states[e]=c.ERROR,o.pipeline.flowOut(t)):(r&&(t.content=r),t.states[e]=c.COMPLETE,n?n.flowIn(t):o.pipeline.flowOut(t))})}}function o(t){var e=this.id,i=t.states[e],n=this.next;if(!t.error&&i!==c.WORKING&&i!==c.ERROR)if(i===c.COMPLETE)n?n.flowIn(t):this.pipeline.flowOut(t);else{t.states[e]=c.WORKING;var o=this.handle(t);o instanceof Error?(t.error=o,t.states[e]=c.ERROR,this.pipeline.flowOut(t)):(o&&(t.content=o),t.states[e]=c.COMPLETE,n?n.flowIn(t):this.pipeline.flowOut(t))}}var r=t("../platform/js"),s=t("./loading-items"),c=s.ItemState,a=function(t){this._pipes=t,this._cache={};for(var e=0;e<t.length;++e){var i=t[e];i.handle&&i.id&&(i.pipeline=this,i.next=e<t.length-1?t[e+1]:null,i.flowIn=i.async?n:o)}};a.ItemState=c,r.mixin(a.prototype,{insertPipe:function(t,e){t.handle&&t.id&&(t.pipeline=this,t.flowIn=t.async?n:o,e<this._pipes.length?(t.next=this._pipes[e],this._pipes.splice(e,0,t)):(t.next=null,this._pipes.push(t)))},appendPipe:function(t){t.handle&&t.id&&(t.pipeline=this,t.next=null,t.flowIn=t.async?n:o,this._pipes.push(t))},flowIn:function(t){var e,i,n=this._pipes[0];if(n)for(e=0;e<t.length;e++)i=t[e],this._cache[i.id]=i,n.flowIn(i);else for(e=0;e<t.length;e++)this.flowOut(t[e])},flowInDeps:function(t,e,i){var n=s.create(this,function(t,e){i(t,e),e.destroy()});return n.append(e,t)},flowOut:function(t){t.error?delete this._cache[t.id]:this._cache[t.id]||(this._cache[t.id]=t),t.complete=!0,s.itemComplete(t)},copyItemStates:function(t,e){if(!(e instanceof Array))return void(e.states=t.states);for(var i=0;i<e.length;++i)e[i].states=t.states},isFlowing:function(){return!0},getItems:function(){return null},getItem:function(t){var e=this._cache[t];return e?(e.alias&&(e=this._cache[e.alias]),e):e},removeItem:function(t){var e=this._cache[t];return delete this._cache[t],e&&!e.complete&&(e.error=new Error("Canceled manually"),this.flowOut(e)),e},clear:function(){for(var t in this._cache){var e=this._cache[t];delete this._cache[t],e.complete||(e.error=new Error("Canceled manually"),this.flowOut(e))}}}),cc.Pipeline=e.exports=a},{"../platform/js":116,"./loading-items":97}],100:[function(t,e,i){e.exports=function(t,e){var i=t.url,n=jsb.fileUtils.getStringFromFile(i);"string"==typeof n&&n?e(null,n):e(new Error("Download text failed: "+i))}},{"./utils":101}],101:[function(t,e,i){var n=/\?/;e.exports={urlAppendTimestamp:function(t){return cc.game.config.noCache&&"string"==typeof t&&(t+=n.test(t)?"&_t="+(new Date-0):"?_t="+(new Date-0)),t},urlAppendCrc:function(t){var e=t.substr(t.lastIndexOf("/")+1);if(window.urlCrc){var i=window.urlCrc[e];i&&i.length>0&&(t+=n.test(t)?"&_v="+i:"?v="+i)}return t}}},{}],102:[function(t,e,i){function n(t){var e="cc.Scene",i="cc.Prefab";return t&&(t[0]&&t[0].__type__===e||t[1]&&t[1].__type__===e||t[0]&&t[0].__type__===i)}function o(t,e,i,n,o,r){var s,h,l,u,d,p=e.id,_=n.uuidList;if(o)for(s=[],h=[],l=[],u=0;u<_.length;u++){d=_[u];var f=n.uuidObjList[u],g=n.uuidPropList[u],v=cc.AssetLibrary._getAssetInfoInRuntime(d);if(v.raw){var m=v.url;f[g]=m}else s.push(f),h.push(g),l.push({id:d,type:"uuid",uuid:d,deferredLoadRaw:!0})}else for(s=c.array.copy(n.uuidObjList),h=c.array.copy(n.uuidPropList),l=new Array(_.length),u=0;u<_.length;u++)d=_[u],l[u]={id:d,type:"uuid",uuid:d};if(n.rawProp&&(s.push(i),h.push(n.rawProp),l.push(e.url)),0===l.length)return i._uuid=p,r(null,i);var y=e.dependKeys=[];e.content=i,t.flowInDeps(e,l,function(t,e){var n;for(var o in e.map)n=e.map[o],n.uuid&&n.content&&(n.content._uuid=n.uuid);for(var c=0;c<l.length;c++){var u=l[c].uuid,d=s[c],_=h[c];if(n=e.map[u])if(n.complete||n.content)if(n.error)cc._throw(n.error);else{var f=n.isRawAsset?n.url:n.content;d[_]=f,y.push(u||n.url)}else{var g=function(t){var e=t.isRawAsset?t.url:t.content;this.obj[this.prop]=e,y.push(t.uuid||t.url)},v={obj:d,prop:_},m=a.getQueue(n),C=m._callbackTable[u];C?C.unshift(g,v):m.addListener(u,g,v)}}i._uuid=p,r(null,i)})}function r(t,e,i){var n=e.deferredLoadRaw;return n?t instanceof cc.Asset&&t.constructor.preventDeferredLoadDependents&&(n=!1):i&&t instanceof cc.SceneAsset&&(n=t.asyncLoadAssets),n}function s(t,e){var i;if("string"==typeof t.content)try{i=JSON.parse(t.content)}catch(s){return void e(new Error("Uuid Loader: Parse asset ["+t.id+"] failed : "+s.stack))}else{if("object"!=typeof t.content)return void e(new Error("JSON Loader: Input item doesn't contain string content"));i=t.content}var a,h=n(i),l=h?cc._MissingScript.safeFindClass:function(t){var e=c._getClassById(t);return e?e:(cc.warn('Can not get class "%s"',t),Object)},u=new cc.deserialize.Details;try{a=cc.deserialize(i,u,{classFinder:l,target:t.existingAsset,customEnv:t})}catch(s){var d=s+"\n"+s.stack;return void e(new Error("Uuid Loader: Deserialize asset ["+t.id+"] failed : "+d))}var p=r(a,t,h);o(this.pipeline,t,a,u,p,e),u.reset()}var c=t("../platform/js");t("../platform/deserialize");var a=t("./loading-items");new cc.deserialize.Details;e.exports=s,s.isSceneObj=n},{"../platform/deserialize":112,"../platform/js":116,"./loading-items":97}],103:[function(t,e,i){function n(t){return t&&(t.constructor===cc.SceneAsset||t instanceof cc.Scene)}var o=t("../assets/CCAsset"),r=t("./utils").callInNextTick,s=t("../load-pipeline/CCLoader"),c=t("../load-pipeline/pack-downloader"),a=t("../load-pipeline/auto-release-utils"),h="",l="",u={},d={loadAsset:function(t,e,i){if("string"!=typeof t)return r(e,new Error("[AssetLibrary] uuid must be string"),null);var o={id:t,type:"uuid"};i&&i.deserializeInfo&&(o.deserializeInfo=i.deserializeInfo),i&&i.existingAsset&&(o.existingAsset=i.existingAsset),s.load(o,function(i,o){i||!o?i=new Error("[AssetLibrary] loading JSON or dependencies failed: "+(i?i.message:"Unknown error")):(o.constructor===cc.SceneAsset&&(o.scene.dependAssets=a.getDependsRecursively(t)),n(o)&&s.removeItem(t)),e&&e(i,o)})},getImportedDir:function(t){return h+t.slice(0,2)},_queryAssetInfoInEditor:function(t,e){},_getAssetInfoInRuntime:function(t){var e=u[t];if(e&&!cc.isChildClassOf(e.type,cc.Asset))return{url:l+e.url,raw:!0};var i=this.getImportedDir(t)+"/"+t+".json";return{url:i,raw:!1}},queryAssetInfo:function(t,e){var i=this._getAssetInfoInRuntime(t);e(null,i.url,i.raw)},parseUuidInEditor:function(t){},loadJson:function(t,e){var i=""+((new Date).getTime()+Math.random()),o={id:i,type:"uuid",content:t,skips:[s.downloader.id]};s.load(o,function(t,o){t?t=new Error("[AssetLibrary] loading JSON or dependencies failed: "+t.message):(o.constructor===cc.SceneAsset&&(o.scene.dependAssets=a.getDependsRecursively(i)),n(o)&&s.removeItem(i)),o._uuid="",e&&e(t,o)})},getAssetByUuid:function(t){return d._uuidToAsset[t]||null},init:function(t){var e=t.libraryPath;e=e.replace(/\\/g,"/"),h=cc.path._setEndWithSep(e,"/"),l=t.rawAssetsBase;var i=s._resources;i.reset();var n=t.rawAssets;if(n){var r="resources/";for(var a in n){var d=n[a];for(var p in d){var _=d[p],f=_[0],g=_[1],v=cc.js._getClassById(g);if(v){if(u[p]={url:a+"/"+f,type:v},"assets"===a&&f.startsWith(r)){if(cc.isChildClassOf(v,o)){var m=cc.path.extname(f);f=m?f.slice(r.length,-m.length):f.slice(r.length)}else f=f.slice(r.length);var y=1===_[2];i.add(f,p,v,!y)}}else cc.error("Cannot get",g)}}}t.packedAssets&&c.initPacks(t.packedAssets);var C=t.mountPaths;C||(C={assets:l+"assets",internal:l+"internal"}),cc.url._init(C)}};d._uuidToAsset={},cc.AssetLibrary=d},{"../assets/CCAsset":24,"../load-pipeline/CCLoader":90,"../load-pipeline/auto-release-utils":92,"../load-pipeline/pack-downloader":98,"./utils":121}],104:[function(require,module,exports){function appendProp(t,e){var i=t.__props__.indexOf(e);0>i&&t.__props__.push(e)}function defineProp(t,e,i,n,o){if(Attr.setClassAttr(t,i,"default",n),appendProp(t,i),o){for(var r=null,s=0;s<o.length;s++){var c=o[s];Attr.attr(t,i,c),c._onAfterProp&&(r=r||[],r.push(c._onAfterProp))}if(r)for(var a=0;a<r.length;a++)r[a](t,i)}}function defineGetSet(t,e,i,n,o){var r=n.get,s=n.set,c=t.prototype,a=Object.getOwnPropertyDescriptor(c,i);if(r){if(o)for(var h=0;h<o.length;++h){var l=o[h];Attr.attr(t,i,l)}var u=!1;u||Attr.attr(t,i,Attr.NonSerialized),u&&appendProp(t,i),a?Object.defineProperty(c,i,{get:r}):Object.defineProperty(c,i,{get:r,configurable:!0,enumerable:!0})}s&&(a?Object.defineProperty(c,i,{set:s}):Object.defineProperty(c,i,{set:s,configurable:!0,enumerable:!0}))}function getDefault(t){return"function"==typeof t?t():t}function instantiateProps(t,e){var i=Attr.getClassAttrs(e),n=e.__props__;null===n&&(deferredInitializer.init(),n=e.__props__);for(var o=0;o<n.length;o++){var r=n[o],s=r+DELIMETER+"default";if(s in i){var c=i[s];c&&("object"==typeof c&&c?c="function"==typeof c.clone?c.clone():Array.isArray(c)?[]:{}:"function"==typeof c&&(c=getDefault(c))),t[r]=c}}}function getInheritanceChain(t){for(var e=[];;){if(t.$super)t=t.$super;else{var i=Object.getPrototypeOf(t.prototype);t=i&&i.constructor}if(!t)break;t!==Object&&e.push(t)}return e}function doDefine(t,e,i,n,o){var r=_createCtor(n,e,i,t,o);if(Object.defineProperty(r,"extend",{value:function(t){return t["extends"]=this,CCClass(t)},writable:!0,configurable:!0}),e&&(JS.extend(r,e),r.$super=e),i){for(var s=0;s<i.length;++s){var c=i[s];JS.mixin(r.prototype,c.prototype);for(var a in c)c.hasOwnProperty(a)&&INVALID_STATICS.indexOf(a)<0&&(r[a]=c[a]);CCClass._isCCClass(c)&&JS.mixin(Attr.getClassAttrs(r).constructor.prototype,Attr.getClassAttrs(c).constructor.prototype)}r.prototype.constructor=r}return JS.setClassName(t,r),r}function define(t,e,i,n,o){if(cc.isChildClassOf(e,cc.Component)){var r=cc._RFpeek();if(r){if(r.beh)return cc.error("Each script can have at most one Component."),c;var s=r.uuid;t=t||r.script;var c=doDefine(t,e,i,n,o);return s&&JS._setClassId(s,c),r.beh=c,c}}return doDefine(t,e,i,n,o)}function _checkCtor(t,e){}function normalizeClassName(t){var e}function _createCtor(ctor,baseClass,mixins,className,options){for(var useTryCatch=!(className&&className.startsWith("cc.")),shouldAddProtoCtor,originCtor,superCallBounded=options&&baseClass&&boundSuperCalls(baseClass,options),ctors=[],baseOrMixins=[baseClass].concat(mixins),b=0;b<baseOrMixins.length;b++){var baseOrMixin=baseOrMixins[b];if(baseOrMixin)if(CCClass._isCCClass(baseOrMixin)){var baseCtors=baseOrMixin.__ctors__;baseCtors&&(ctors=ctors.concat(baseCtors))}else baseOrMixin&&ctors.push(baseOrMixin)}ctor&&ctors.push(ctor);var body;if(body="(function(){\n",superCallBounded&&(body+="this._super=null;\n"),body+="instantiateProps(this,fireClass);\n",ctors.length>0){if(body+="var cs=fireClass.__ctors__;\n",useTryCatch&&(body+="try{\n"),ctors.length<=5)for(var i=0;i<ctors.length;i++)body+="(cs["+i+"]).apply(this,arguments);\n";else body+="for(var i=0,l=cs.length;i<l;++i){\n",body+="(cs[i]).apply(this,arguments);\n}\n";useTryCatch&&(body+="}catch(e){\ncc._throw(e);\n}\n")}body+="})";var fireClass=eval(body);return Object.defineProperty(fireClass,"__ctors__",{value:ctors.length>0?ctors:null}),fireClass}function _boundSuperCall(t,e,i){var n=null,o=JS.getPropertyDescriptor(i.prototype,e);if(o&&(n=o.value,"function"==typeof n)){var r=SuperCallReg.test(t);if(r)return function(){var e=this._super;this._super=n;var i=t.apply(this,arguments);return this._super=e,i}}return null}function boundSuperCalls(t,e){var i=!1;for(var n in e)if(BUILTIN_ENTRIES.indexOf(n)<0){var o=e[n];if("function"==typeof o){var r=_boundSuperCall(o,n,t);r&&(i=!0,e[n]=r)}}return i}function declareProperties(t,e,i,n,o){if(t.__props__=[],n&&n.__props__&&(t.__props__=n.__props__.slice()),o)for(var r=0;r<o.length;++r){var s=o[r];s.__props__&&(t.__props__=t.__props__.concat(s.__props__.filter(function(e){return t.__props__.indexOf(e)<0})))}if(i){preprocessAttrs(i,e,t);for(var c in i){var a=i[c],h=parseAttributes(a,e,c);"default"in a?defineProp(t,e,c,a["default"],h):defineGetSet(t,e,c,a,h)}}}function CCClass(t){if(0===arguments.length)return define();if(!t)return cc.error("cc.Class: Option must be non-nil"),define();var e,i=t.name,n=t["extends"],o=t.mixins;e=define(i,n,o,t.ctor,t),i||(i=cc.js.getClassName(e));var r=t.properties;"function"==typeof r||n&&null===n.__props__||o&&o.some(function(t){return null===t.__props__})?(deferredInitializer.push({cls:e,props:r,mixins:o}),e.__props__=null):declareProperties(e,i,r,n,t.mixins);var s=t.statics;if(s){var c;for(c in s)e[c]=s[c]}for(var a in t)if(!(BUILTIN_ENTRIES.indexOf(a)>=0)){var h=t[a];if("function"==typeof h||null===h)Object.defineProperty(e.prototype,a,{value:h,enumerable:!0,configurable:!0,writable:!0});else;}return e}function parseAttributes(t,e,i){function n(e,i,n){if(e in t){var r=t[e];if(typeof r===i)if(n)o.push("function"==typeof n?n(r):n);else{var s={};s[e]=r,o.push(s)}}}tmpAttrs.length=0;var o=tmpAttrs,r=t.type;if(r){var s=PrimitiveTypes[r];if(s)o.push({type:r,_onAfterProp:getTypeChecker(s,"cc."+r)});else if("Object"===r);else if(r===Attr.ScriptUuid){var c=Attr.ObjectType(cc.ScriptAsset);c.type="Script",o.push(c)}else"object"==typeof r?Enum.isEnum(r)&&o.push({type:"Enum",enumList:Enum.getList(r)}):"function"==typeof r&&(t.url?o.push({type:"Object",ctor:r,_onAfterProp:getTypeChecker("String","cc.String")}):o.push(Attr.ObjectType(r)))}n("rawType","string",Attr.RawType),n("editorOnly","boolean",Attr.EditorOnly),t.url&&o.push({saveUrlAsAsset:!0}),t.serializable===!1&&o.push(Attr.NonSerialized);var a=t.range;return a&&Array.isArray(a)&&a.length>=2&&o.push({min:a[0],max:a[1],step:a[2]}),n("min","number"),n("max","number"),n("step","number"),o}var JS=require("./js"),Enum=require("../value-types/CCEnum"),Utils=require("./utils"),_isPlainEmptyObj_DEV=Utils.isPlainEmptyObj_DEV,_cloneable_DEV=Utils.cloneable_DEV,Attr=require("./attribute"),getTypeChecker=Attr.getTypeChecker,preprocessAttrs=require("./preprocess-attrs"),BUILTIN_ENTRIES=["name","extends","mixins","ctor","properties","statics","editor"],TYPO_TO_CORRECT=!1,INVALID_STATICS=!1,deferredInitializer={datas:null,push:function(t){if(this.datas)this.datas.push(t);else{this.datas=[t];var e=this;setTimeout(function(){e.init()},0)}},init:function(){var t=this.datas;if(t){for(var e=0;e<t.length;++e){var i=t[e],n=i.cls,o=i.props;"function"==typeof o&&(o=o());var r=JS.getClassName(n);o?declareProperties(n,r,o,n.$super,i.mixins):cc.error('Properties function of "%s" should return an object!',r)}this.datas=null}}},DELIMETER=Attr.DELIMETER;cc.isChildClassOf=function(t,e){if(t&&e){if("function"!=typeof t)return!1;if("function"!=typeof e)return!1;if(t===e)return!0;for(;;){if(t.$super)t=t.$super;else{var i=t.prototype,n=i&&Object.getPrototypeOf(i);t=n&&n.constructor}if(!t)return!1;if(t===e)return!0}}return!1};var SuperCallReg=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;CCClass._isCCClass=function(t){return!!t&&"undefined"!=typeof t.__ctors__},CCClass._fastDefine=function(t,e,i){JS.setClassName(t,e);for(var n=e.__props__=Object.keys(i),o=0;o<n.length;o++){var r=n[o],s=i[r];Attr.setClassAttr(e,r,"visible",!1),Attr.setClassAttr(e,r,"default",s)}},CCClass.Attr=Attr,CCClass.attr=Attr.attr,CCClass.getInheritanceChain=getInheritanceChain;var PrimitiveTypes={Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"},tmpAttrs=[];cc.Class=CCClass,module.exports={instantiateProps:instantiateProps,isArray:function(t){return t=getDefault(t),Array.isArray(t)},fastDefine:CCClass._fastDefine}},{"../value-types/CCEnum":132,"./attribute":110,"./js":116,"./preprocess-attrs":118,"./utils":121}],105:[function(t,e,i){t("./_CCClass"),cc._tmp=cc._tmp||{},cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.getImageFormatByData=function(t){return t.length>8&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]?cc.ImageFormat.PNG:t.length>2&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1])?cc.ImageFormat.TIFF:cc.ImageFormat.UNKNOWN},cc.macro={INVALID_INDEX:-1,NODE_TAG_INVALID:-1,PI:Math.PI,PI2:2*Math.PI,FLT_MAX:parseFloat("3.402823466e+38F"),FLT_MIN:parseFloat("1.175494351e-38F"),RAD:Math.PI/180,DEG:180/Math.PI,UINT_MAX:4294967295,REPEAT_FOREVER:4294967295,FLT_EPSILON:1.192092896e-7,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,LINEAR:9729,BLEND_DST:771,WEB_ORIENTATION_PORTRAIT:0,WEB_ORIENTATION_LANDSCAPE_LEFT:-90,WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN:180,WEB_ORIENTATION_LANDSCAPE_RIGHT:90,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",VERTEX_ATTRIB_FLAG_NONE:0,VERTEX_ATTRIB_FLAG_POSITION:1,VERTEX_ATTRIB_FLAG_COLOR:2,VERTEX_ATTRIB_FLAG_TEX_COORDS:4,VERTEX_ATTRIB_FLAG_POS_COLOR_TEX:7,GL_ALL:0,VERTEX_ATTRIB_POSITION:0,VERTEX_ATTRIB_COLOR:1,VERTEX_ATTRIB_TEX_COORDS:2,VERTEX_ATTRIB_MAX:3,UNIFORM_PMATRIX:0,UNIFORM_MVMATRIX:1,UNIFORM_MVPMATRIX:2,UNIFORM_TIME:3,UNIFORM_SINTIME:4,UNIFORM_COSTIME:5,UNIFORM_RANDOM01:6,UNIFORM_SAMPLER:7,UNIFORM_MAX:8,SHADER_POSITION_TEXTURECOLOR:"ShaderPositionTextureColor",SHADER_SPRITE_POSITION_TEXTURECOLOR:"ShaderSpritePositionTextureColor",SHADER_POSITION_TEXTURECOLORALPHATEST:"ShaderPositionTextureColorAlphaTest",SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:"ShaderSpritePositionTextureColorAlphaTest",SHADER_POSITION_COLOR:"ShaderPositionColor",SHADER_SPRITE_POSITION_COLOR:"ShaderSpritePositionColor",SHADER_POSITION_TEXTURE:"ShaderPositionTexture",SHADER_POSITION_TEXTURE_UCOLOR:"ShaderPositionTexture_uColor",SHADER_POSITION_TEXTUREA8COLOR:"ShaderPositionTextureA8Color",SHADER_POSITION_UCOLOR:"ShaderPosition_uColor",SHADER_POSITION_LENGTHTEXTURECOLOR:"ShaderPositionLengthTextureColor",UNIFORM_PMATRIX_S:"CC_PMatrix",UNIFORM_MVMATRIX_S:"CC_MVMatrix",UNIFORM_MVPMATRIX_S:"CC_MVPMatrix",UNIFORM_TIME_S:"CC_Time",UNIFORM_SINTIME_S:"CC_SinTime",UNIFORM_COSTIME_S:"CC_CosTime",UNIFORM_RANDOM01_S:"CC_Random01",UNIFORM_SAMPLER_S:"CC_Texture0",UNIFORM_ALPHA_TEST_VALUE_S:"CC_alpha_value",ATTRIBUTE_NAME_COLOR:"a_color",ATTRIBUTE_NAME_POSITION:"a_position",ATTRIBUTE_NAME_TEX_COORD:"a_texCoord",ITEM_SIZE:32,CURRENT_ITEM:3233828865,ZOOM_ACTION_TAG:3233828866,NORMAL_TAG:8801,SELECTED_TAG:8802,DISABLE_TAG:8803,FIX_ARTIFACTS_BY_STRECHING_TEXEL:1,DIRECTOR_STATS_POSITION:cc.p(0,0),DIRECTOR_FPS_INTERVAL:.5,COCOSNODE_RENDER_SUBPIXEL:1,SPRITEBATCHNODE_RENDER_SUBPIXEL:1,AUTO_PREMULTIPLIED_ALPHA_FOR_PNG:0,OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA:0,TEXTURE_ATLAS_USE_TRIANGLE_STRIP:0,TEXTURE_ATLAS_USE_VAO:0,TEXTURE_NPOT_SUPPORT:0,USE_LA88_LABELS:1,SPRITE_DEBUG_DRAW:0,LABELBMFONT_DEBUG_DRAW:0,LABELATLAS_DEBUG_DRAW:0,ENABLE_STACKABLE_ACTIONS:1,ENABLE_GL_STATE_CACHE:1,TOUCH_TIMEOUT:5e3},cc.defineGetterSetter(cc.macro,"BLEND_SRC",function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.macro.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?cc.macro.ONE:cc.macro.SRC_ALPHA}),cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.macro.RAD},cc.radiansToDegrees=function(t){return t*cc.macro.DEG},cc.nodeDrawSetup=function(t){t._shaderProgram&&(t._shaderProgram.use(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.checkGLErrorDebug=function(){if(cc.renderMode===cc.game.RENDER_TYPE_WEBGL){var t=cc._renderContext.getError();t&&cc.log(cc._LogInfos.checkGLErrorDebug,t)}},e.exports=cc.macro;
},{"./_CCClass":109}],106:[function(t,e,i){function n(){this._name="",this._objFlags=0}function o(){for(var t=x.length,e=0;t>e;++e){var i=x[e];i._objFlags&s||i._destroyImmediate()}t===x.length?x.length=0:x.splice(0,t)}var r=t("./js"),s=1,c=4,a=8,h=16,l=32,u=64,d=128,p=256,_=2048,f=4096,g=8192,v=16384,m=32768,y=65536,C=1<<17,T=1<<18,b=1<<19,E=1<<20,S=1<<21,A=~(c|l|d|u|p|g|m|v|y|_|f|C|T|b|E|S);n.Flags={Destroyed:s,DontSave:a,EditorOnly:h,Dirty:l,DontDestroy:u,PersistentMask:A,Destroying:d,Activating:p,IsPreloadCalled:g,IsOnLoadCalled:v,IsOnLoadStarted:m,IsOnEnableCalled:_,IsStartCalled:y,IsEditorOnEnableCalled:f,IsPositionLocked:S,IsRotationLocked:C,IsScaleLocked:T,IsAnchorLocked:b,IsSizeLocked:E},t("./CCClass").fastDefine("cc.Object",n,{_name:"",_objFlags:0});var x=[];Object.defineProperty(n,"_deferredDestroy",{value:o});var O=n.prototype;r.getset(O,"name",function(){return this._name},function(t){this._name=t}),r.get(O,"isValid",function(){return!(this._objFlags&s)});O.destroy=function(){return this._objFlags&s?(cc.warn("object already destroyed"),!1):this._objFlags&c?!1:(this._objFlags|=c,x.push(this),!0)},O._destruct=function(){for(var t in this)if(this.hasOwnProperty(t))switch(typeof this[t]){case"string":this[t]="";break;case"object":case"function":this[t]=null}},O._onPreDestroy=null,O._destroyImmediate=function(){return this._objFlags&s?void cc.error("object already destroyed"):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),void(this._objFlags|=s))},O._deserialize=null,cc.isValid=function(t){return"object"==typeof t?!(!t||t._objFlags&s):"undefined"!=typeof t},cc.Object=n,e.exports=n},{"./CCClass":104,"./js":116}],107:[function(t,e,i){if(!cc.sys){cc.sys={};var n=cc.sys;n.LANGUAGE_ENGLISH="en",n.LANGUAGE_CHINESE="zh",n.LANGUAGE_FRENCH="fr",n.LANGUAGE_ITALIAN="it",n.LANGUAGE_GERMAN="de",n.LANGUAGE_SPANISH="es",n.LANGUAGE_DUTCH="du",n.LANGUAGE_RUSSIAN="ru",n.LANGUAGE_KOREAN="ko",n.LANGUAGE_JAPANESE="ja",n.LANGUAGE_HUNGARIAN="hu",n.LANGUAGE_PORTUGUESE="pt",n.LANGUAGE_ARABIC="ar",n.LANGUAGE_NORWEGIAN="no",n.LANGUAGE_POLISH="pl",n.LANGUAGE_UNKNOWN="unknown",n.OS_IOS="iOS",n.OS_ANDROID="Android",n.OS_WINDOWS="Windows",n.OS_MARMALADE="Marmalade",n.OS_LINUX="Linux",n.OS_BADA="Bada",n.OS_BLACKBERRY="Blackberry",n.OS_OSX="OS X",n.OS_WP8="WP8",n.OS_WINRT="WINRT",n.OS_UNKNOWN="Unknown",n.UNKNOWN=-1,n.WIN32=0,n.LINUX=1,n.MACOS=2,n.ANDROID=3,n.IPHONE=4,n.IPAD=5,n.BLACKBERRY=6,n.NACL=7,n.EMSCRIPTEN=8,n.TIZEN=9,n.WINRT=10,n.WP8=11,n.MOBILE_BROWSER=100,n.DESKTOP_BROWSER=101,n.EDITOR_PAGE=102,n.EDITOR_CORE=103,n.BROWSER_TYPE_WECHAT="wechat",n.BROWSER_TYPE_ANDROID="androidbrowser",n.BROWSER_TYPE_IE="ie",n.BROWSER_TYPE_QQ="qqbrowser",n.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",n.BROWSER_TYPE_UC="ucbrowser",n.BROWSER_TYPE_360="360browser",n.BROWSER_TYPE_BAIDU_APP="baiduboxapp",n.BROWSER_TYPE_BAIDU="baidubrowser",n.BROWSER_TYPE_MAXTHON="maxthon",n.BROWSER_TYPE_OPERA="opera",n.BROWSER_TYPE_OUPENG="oupeng",n.BROWSER_TYPE_MIUI="miuibrowser",n.BROWSER_TYPE_FIREFOX="firefox",n.BROWSER_TYPE_SAFARI="safari",n.BROWSER_TYPE_CHROME="chrome",n.BROWSER_TYPE_LIEBAO="liebao",n.BROWSER_TYPE_QZONE="qzone",n.BROWSER_TYPE_SOUGOU="sogou",n.BROWSER_TYPE_UNKNOWN="unknown",n.isNative=!1,n.isBrowser="object"==typeof window&&"object"==typeof document;var o=window,r=o.navigator,s=document,c=s.documentElement,a=r.userAgent.toLowerCase();n.isMobile=/mobile|android|iphone|ipad/.test(a),n.platform=n.isMobile?n.MOBILE_BROWSER:n.DESKTOP_BROWSER;var h=r.language;h=h?h:r.browserLanguage,h=h?h.split("-")[0]:n.LANGUAGE_ENGLISH,n.language=h;var l=!1,u=!1,d="",p=0,_=/android (\d+(?:\.\d+)+)/i.exec(a)||/android (\d+(?:\.\d+)+)/i.exec(r.platform);_&&(l=!0,d=_[1]||"",p=parseInt(d)||0),_=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(a),_?(u=!0,d=_[2]||"",p=parseInt(d)||0):/(iPhone|iPad|iPod)/.exec(r.platform)&&(u=!0);var f=n.OS_UNKNOWN;-1!==r.appVersion.indexOf("Win")?f=n.OS_WINDOWS:u?f=n.OS_IOS:-1!==r.appVersion.indexOf("Mac")?f=n.OS_OSX:-1!==r.appVersion.indexOf("X11")&&-1===r.appVersion.indexOf("Linux")?f=n.OS_UNIX:l?f=n.OS_ANDROID:-1!==r.appVersion.indexOf("Linux")&&(f=n.OS_LINUX),n.os=f,n.osVersion=d,n.osMainVersion=p,n.browserType=n.BROWSER_TYPE_UNKNOWN,function(){var t=/mqqbrowser|sogou|qzone|liebao|micromessenger|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i,e=/qqbrowser|chrome|safari|firefox|opr|oupeng|opera/i,i=t.exec(a);i||(i=e.exec(a));var o=i?i[0]:n.BROWSER_TYPE_UNKNOWN;"micromessenger"===o?o=n.BROWSER_TYPE_WECHAT:"safari"===o&&a.match(/android.*applewebkit/)?o=n.BROWSER_TYPE_ANDROID:"trident"===o?o=n.BROWSER_TYPE_IE:"360 aphone"===o?o=n.BROWSER_TYPE_360:"mxbrowser"===o?o=n.BROWSER_TYPE_MAXTHON:"opr"===o&&(o=n.BROWSER_TYPE_OPERA),n.browserType=o}(),n.browserVersion="",function(){var t=/(micromessenger|qq|mx|maxthon|baidu|sogou)(mobile)?(browser)?\/?([\d.]+)/i,e=/(msie |rv:|firefox|chrome|ucbrowser|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i,i=a.match(t);i||(i=a.match(e)),n.browserVersion=i?i[4]:""}();var g=window.innerWidth||document.documentElement.clientWidth,v=window.innerHeight||document.documentElement.clientHeight,m=window.devicePixelRatio||1;n.windowPixelResolution={width:m*g,height:m*v},n._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")};var y=document.createElement("canvas"),C=document.createElement("canvas");if(cc.create3DContext=function(t,e){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,o=0;o<i.length;++o){try{n=t.getContext(i[o],e)}catch(r){}if(n)break}return n},n._supportCanvasNewBlendModes=function(){var t,e,i=y;i.width=1,i.height=1;var n=i.getContext("2d");n.fillStyle="#000",n.fillRect(0,0,1,1),n.globalCompositeOperation="multiply";var o=C;o.width=1,o.height=1;var r=o.getContext("2d");r.fillStyle="#fff",r.fillRect(0,0,1,1),n.drawImage(o,0,0,1,1),t=n.getImageData(0,0,1,1).data[0],i=y,i.width=1,i.height=1;var n=i.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,1,1),n.globalCompositeOperation="destination-atop",o=C,o.width=1,o.height=1;var r=o.getContext("2d");return r.fillStyle="#000",r.fillRect(0,0,1,1),n.drawImage(o,0,0,1,1),e=n.getImageData(0,0,1,1).data[0],0===t&&0===e}(),cc.sys.isMobile){var T=document.createElement("style");T.type="text/css",document.body.appendChild(T),T.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var b=n.localStorage=o.localStorage;b.setItem("storage",""),b.removeItem("storage"),b=null}catch(E){var S=function(){cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")};n.localStorage={getItem:S,setItem:S,removeItem:S,clear:S}}var A=!!y.getContext("2d"),x=!1;if(o.WebGLRenderingContext){var O=document.createElement("CANVAS");try{var N=cc.create3DContext(O,{stencil:!0});if(N&&N.getShaderPrecisionFormat&&(x=!0),console.log("bq modify"),x&&n.os===n.OS_ANDROID){var w=parseFloat(n.browserVersion);switch(n.browserType){case n.BROWSER_TYPE_MOBILE_QQ:case n.BROWSER_TYPE_BAIDU:case n.BROWSER_TYPE_BAIDU_APP:x=w>=6.2;break;case n.BROWSER_TYPE_ANDROID:n.osMainVersion&&n.osMainVersion>=5&&(x=!0);break;case n.BROWSER_TYPE_CHROME:x=w>=30;break;case n.BROWSER_TYPE_UNKNOWN:case n.BROWSER_TYPE_360:case n.BROWSER_TYPE_MIUI:case n.BROWSER_TYPE_UC:x=!1}}}catch(E){}O=null}var I=n.capabilities={canvas:A,opengl:x};(void 0!==c.ontouchstart||void 0!==s.ontouchstart||r.msPointerEnabled)&&(I.touches=!0),void 0!==c.onmouseup&&(I.mouse=!0),void 0!==c.onkeyup&&(I.keyboard=!0),(o.DeviceMotionEvent||o.DeviceOrientationEvent)&&(I.accelerometer=!0);var P;!function(){var t=!1,e=n.browserVersion,i=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);P={ONLY_ONE:!1,WEB_AUDIO:i,DELAY_CREATE_CTX:!1},n.os===n.OS_IOS&&(P.USE_LOADER_EVENT="loadedmetadata"),n.browserType===n.BROWSER_TYPE_FIREFOX&&(P.DELAY_CREATE_CTX=!0,P.USE_LOADER_EVENT="canplay"),n.os===n.OS_ANDROID&&n.browserType===n.BROWSER_TYPE_UC&&(P.ONE_SOURCE=!0),t&&setTimeout(function(){cc.log("browse type: "+n.browserType),cc.log("browse version: "+e),cc.log("MULTI_CHANNEL: "+P.MULTI_CHANNEL),cc.log("WEB_AUDIO: "+P.WEB_AUDIO),cc.log("AUTOPLAY: "+P.AUTOPLAY)},0)}();try{P.WEB_AUDIO&&(P.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),P.DELAY_CREATE_CTX&&setTimeout(function(){P.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)},0))}catch(L){P.WEB_AUDIO=!1,cc.log("browser don't support web audio")}var R=[];!function(){var t=document.createElement("audio");if(t.canPlayType){var e=t.canPlayType('audio/ogg; codecs="vorbis"');e&&R.push(".ogg");var i=t.canPlayType("audio/mpeg");i&&R.push(".mp3");var n=t.canPlayType('audio/wav; codecs="1"');n&&R.push(".wav");var o=t.canPlayType("audio/mp4");o&&R.push(".mp4");var r=t.canPlayType("audio/x-m4a");r&&R.push(".m4a")}}(),P.format=R,n.__audioSupport=P,n.garbageCollect=function(){},n.dumpRoot=function(){},n.restartVM=function(){},n.cleanScript=function(t){},n.isObjectValid=function(t){return!!t},n.dump=function(){var t=this,e="";e+="isMobile : "+t.isMobile+"\r\n",e+="language : "+t.language+"\r\n",e+="browserType : "+t.browserType+"\r\n",e+="browserVersion : "+t.browserVersion+"\r\n",e+="capabilities : "+JSON.stringify(t.capabilities)+"\r\n",e+="os : "+t.os+"\r\n",e+="osVersion : "+t.osVersion+"\r\n",e+="platform : "+t.platform+"\r\n",e+="Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(e)},n.openURL=function(t){window.open(t)},n.now=function(){return Date.now?Date.now():+new Date},e.exports=n}},{}],108:[function(t,e,i){cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,o=t.y,r=o+i,s=n+e;this.topLeft.x=n,this.topLeft.y=r,this.topRight.x=s,this.topRight.y=r,this.top.x=n+e/2,this.top.y=r,this.bottomLeft.x=n,this.bottomLeft.y=o,this.bottomRight.x=s,this.bottomRight.y=o,this.bottom.x=n+e/2,this.bottom.y=o,this.center.x=n+e/2,this.center.y=o+i/2,this.left.x=n,this.left.y=o+i/2,this.right.x=s,this.right.y=o+i/2}}},{}],109:[function(t,e,i){var n=cc.ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}},o=/\b_super\b/,r=function(){};r.extend=function(t){function e(){this.__instanceId=n.getNewInstanceId(),this.ctor&&this.ctor.apply(this,arguments)}var i=this.prototype,s=Object.create(i),c=n.getNewID();n[c]=i;var a={writable:!0,configurable:!0};s.__instanceId=null,e.id=c,a.value=c,Object.defineProperty(s,"__cid__",a),e.prototype=s,a.value=e,Object.defineProperty(e.prototype,"constructor",a);for(var h=0,l=arguments.length;l>h;++h){var u=arguments[h];for(var d in u){var p="function"==typeof u[d],_="function"==typeof i[d],f=o.test(u[d]);p&&_&&f?(a.value=function(t,e){return function(){var n=this._super;this._super=i[t];var o=e.apply(this,arguments);return this._super=n,o}}(d,u[d]),Object.defineProperty(s,d,a)):p?(a.value=u[d],Object.defineProperty(s,d,a)):s[d]=u[d]}}return e.extend=r.extend,e.implement=function(t){for(var e in t)s[e]=t[e]},e},cc.defineGetterSetter=function(t,e,i,n,o,r){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var s={configurable:!0};i&&(s.get=i),n&&(s.set=n),Object.defineProperty(t,e,s)}},cc.clone=function(t){var e=t.constructor?new t.constructor:{};for(var i in t){var n=t[i];"object"!=typeof n||!n||n instanceof _ccsg.Node?e[i]=n:e[i]=cc.clone(n)}return e},cc._Class=e.exports=r},{}],110:[function(t,e,i){function n(t,e,i){var n,o;n=function(){},i&&u.extend(n,i.constructor);var r=new n;return Object.defineProperty(t,"__attrs__",{value:r}),r}function o(t){for(var e,i=cc.Class.getInheritanceChain(t),o=i.length-1;o>=0;o--){var r=i[o],s=r.__attrs__;s||(e=i[o+1],n(r,r,e&&e.__attrs__))}return e=i[0],n(t,t,e&&e.__attrs__),t.__attrs__}function r(t,e,i){var r,s,c;if("function"==typeof t)r=t.__attrs__||o(t),s=r.constructor.prototype;else{var a=t;if(r=a.__attrs__,!r){t=a.constructor;var h=t.__attrs__||o(t);r=n(a,t,h)}s=r}if("undefined"==typeof i){var l=e+p,u={};for(c in r)c.startsWith(l)&&(u[c.slice(l.length)]=r[c]);return u}if("object"==typeof i)for(c in i)95!==c.charCodeAt(0)&&(s[e+p+c]=i[c])}function s(t){return t.__attrs__||o(t)}function c(t,e,i,n){var r=t.__attrs__||o(t);r.constructor.prototype[e+p+i]=n}function a(t,e){}function h(t){return{type:"Object",ctor:t,_onAfterProp:!1}}function l(t){return{rawType:t,serializable:!1,_canUsedInGetter:!1,_onAfterProp:function(t,e){}}}var u=t("./js"),d=t("./utils").isPlainEmptyObj_DEV,p="$_$";cc.Integer="Integer",cc.Float="Float",cc.Boolean="Boolean",cc.String="String";var _={serializable:!1,_canUsedInGetter:!1},f={editorOnly:!0,_canUsedInGetter:!1};e.exports={attr:r,getClassAttrs:s,setClassAttr:c,DELIMETER:p,getTypeChecker:a,NonSerialized:_,EditorOnly:f,ObjectType:h,RawType:l,ScriptUuid:{}}},{"./js":116,"./utils":121}],111:[function(t,e,i){var n=t("./js"),o=function(){this._callbackTable={},this._invoking={},this._toRemove={},this._toRemoveAll=null},r={};o.REMOVE_PLACEHOLDER=r,o.prototype._clearToRemove=function(t){var e=this._callbackTable[t];if(this._toRemove[t]&&e){for(var i=e.indexOf(r),n=i,o=i+1;o<e.length;++o){var s=e[o];s!==r&&(e[n]=s,++n)}e.length=n,this._toRemove[t]=!1}this._toRemoveAll&&(this.removeAll(this._toRemoveAll),this._toRemoveAll=null)},o.prototype.add=function(t,e,i){var n=this._callbackTable[t];return"undefined"!=typeof n?("object"==typeof i?n.push(e,i):n.push(e),!1):(n="object"==typeof i?[e,i]:[e],this._callbackTable[t]=n,!0)},o.prototype.has=function(t,e,i){if(this._toRemoveAll===t)return!1;var n,o,s=this._callbackTable[t];if(!s)return!1;if(!e){if(this._toRemove[t]){for(o=0;o<s.length;o++)if(s[o]!==r)return!0;return!1}return s.length>0}if("function"!=typeof e)return!1;for(o=s.indexOf(e);-1!==o;){if(n=s[o+1],"object"!=typeof n&&(n=void 0),n===i)return!0;o=cc.js.array.indexOf.call(s,e,o+1)}return!1},o.prototype.removeAll=function(t){if(this._invoking[t])return void(this._toRemoveAll=t);if("object"==typeof t){var e,i,n,o=t;for(t in this._callbackTable)for(e=this._callbackTable[t],i=e.lastIndexOf(o);-1!==i;)n=e[i-1],"function"==typeof n?e.splice(i-1,2):e.splice(i,1),i=e.lastIndexOf(o)}else delete this._callbackTable[t],delete this._toRemove[t]},o.prototype.remove=function(t,e,i){var n,o,s=this._callbackTable[t];if(s){for(n=s.indexOf(e);-1!==n;){if(o=s[n+1],"object"!=typeof o&&(o=void 0),o===i){s[n]=r,o&&(s[n+1]=r),this._toRemove[t]=!0;break}n=cc.js.array.indexOf.call(s,e,n+1)}return!0}return!1};var s=function(){o.call(this)};n.extend(s,o),s.prototype.invoke=function(t,e,i,n,o,s){this._invoking[t]=!0;var c=this._callbackTable[t];if(c){var a,h=c.length-1;for(a=0;h>=a;){var l=c[a],u=1;if(l!==r){var d=c[a+1],p=d&&"object"==typeof d;p?(l.call(d,e,i,n,o,s),u=2):l(e,i,n,o,s)}a+=u}}this._invoking[t]=!1,this._clearToRemove(t)},s.prototype.invokeAndRemove=function(t,e,i,n,o,s){this._invoking[t]=!0;var c,a,h,l,u,d=this._callbackTable[t];if(d)for(c=0,a=d.length;a>c;)l=d[c],h=1,l!==r&&(u=d[c+1],u&&"object"==typeof u?(l.call(u,e,i,n,o,s),h=2):l(e,i,n,o,s)),c+=h;this._invoking[t]=!1,this._toRemove[t]=!1,this.removeAll(t)},s.prototype.bindKey=function(t,e){var i=this;return function(n,o,r,s,c){var a,h,l,u=i._callbackTable[t];if(u)for(a=0,h=u.length;h>a;)l=u[a+1],l&&"object"==typeof l?(u[a].call(l,n,o,r,s,c),a+=2):(u[a](n,o,r,s,c),++a);e&&i.removeAll(t)}},s.CallbacksHandler=o,e.exports=s},{"./js":116}],112:[function(t,e,i){var n=t("./js"),o=(t("./CCObject"),t("./attribute")),r=function(){this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.rawProp=""};r.prototype.reset=function(){this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp=""},r.prototype.getUuidOf=function(t,e){for(var i=0;i<this.uuidObjList.length;i++)if(this.uuidObjList[i]===t&&this.uuidPropList[i]===e)return this.uuidList[i];return""},r.prototype.push=function(t,e,i){this.uuidList.push(i),this.uuidObjList.push(t),this.uuidPropList.push(e)};var s=function(){function t(t,i,n,o,s,c){if(this._classFinder=o,this._idList=[],this._idObjList=[],this._idPropList=[],this.result=i||new r,this.customEnv=s,Array.isArray(t)){var h=t,l=h.length;this.deserializedList=new Array(l);for(var u=0;l>u;u++)if(h[u]){var d;this.deserializedList[u]=a(this,h[u],d)}this.deserializedData=l>0?this.deserializedList[0]:[]}else this.deserializedList=[null],this.deserializedData=t?a(this,t,n):null,this.deserializedList[0]=this.deserializedData;e(this)}function e(t){for(var e=t.deserializedList,i=t._idPropList,n=t._idList,o=t._idObjList,r=0,s=t._idList.length;s>r;r++){var c=i[r],a=n[r];o[r][c]=e[a]}}function i(t,e,i){for(var n in i)if(i.hasOwnProperty(n)){var o=i[n];"object"!=typeof o?"__type__"!==n&&(e[n]=o):o?t._deserializeObjField(e,o,n):e[n]=null}}function s(t,e,i){for(var n in e){var o=i[n];"undefined"!=typeof o&&i.hasOwnProperty(n)&&("object"!=typeof o?e[n]=o:o?t._deserializeObjField(e,o,n):e[n]=null)}}function c(t,e,n,r,s){for(var c=r.__props__,a=o.getClassAttrs(r),u=0;u<c.length;u++){var d=c[u],p=a[d+h];if(p)t.result.rawProp&&cc.error("not support multi raw object in a file"),t.result.rawProp=d;else{if(a[d+l]===!1)continue;var _=n[d];if("undefined"==typeof _)continue;"object"!=typeof _?e[d]=_:_?t._deserializeObjField(e,_,d):e[d]=null}}"_$erialized"===c[c.length-1]&&(e._$erialized=JSON.parse(JSON.stringify(n)),i(t,e._$erialized,n))}function a(t,e,o){var r,a=null,h=null;if(e.__type__){var l=e.__type__;if(h=t._classFinder(l,e),!h){var u=t._classFinder===n._getClassById;return u&&cc.deserialize.reportMissingClass(l),null}if(a=new h,h===cc.SpriteFrame&&a.retain(),a._deserialize)return a._deserialize(e.content,t),a;cc.Class._isCCClass(h)?c(t,a,e,h,o):s(t,a,e)}else if(Array.isArray(e)){a=new Array(e.length);for(var d=0;d<e.length;d++)r=e[d],"object"==typeof r&&r?t._deserializeObjField(a,r,""+d):a[d]=r}else a={},i(t,a,e);return a}t.prototype._deserializeObjField=function(t,e,i,n){var o=e.__id__;if("undefined"==typeof o){var r=e.__uuid__;r?(this.result.uuidList.push(r),this.result.uuidObjList.push(t),this.result.uuidPropList.push(i)):t[i]=a(this,e)}else{var s=this.deserializedList[o];s?t[i]=s:(this._idList.push(o),this._idObjList.push(t),this._idPropList.push(i))}};var h=o.DELIMETER+"rawType",l=(o.DELIMETER+"editorOnly",o.DELIMETER+"serializable");return t}();cc.deserialize=function(t,e,i){i=i||{};var o=i.classFinder||n._getClassById,c=i.createAssetRefs||cc.sys.platform===cc.sys.EDITOR_CORE,a=!1,h=i.customEnv,l=i.ignoreEditorOnly;"string"==typeof t&&(t=JSON.parse(t)),c&&!e&&(e=new r),cc.game._isCloning=!0;var u=new s(t,e,a,o,h,l);return cc.game._isCloning=!1,c&&e.assignAssetsBy(Editor.serialize.asAsset),u.deserializedData},cc.deserialize.Details=r,cc.deserialize.reportMissingClass=function(t){cc.warn('Can not find class "%s"',t)}},{"./CCObject":106,"./attribute":110,"./js":116}],113:[function(t,e,i){function n(t){this.id=0|998*Math.random(),this.prefix=t?""+t+o:""}var o=".";n.prototype.getNewId=function(){return this.prefix+ ++this.id},n.global=new n("global"),e.exports=n},{}],114:[function(t,e,i){t("./js"),t("./CCClass"),t("./CCObject"),t("./callbacks-invoker"),t("./url"),t("./deserialize"),t("./instantiate"),t("./requiring-frame"),t("./CCSys"),t("./CCMacro"),t("./CCAssetLibrary")},{"./CCAssetLibrary":103,"./CCClass":104,"./CCMacro":105,"./CCObject":106,"./CCSys":107,"./CCVisibleRect":108,"./callbacks-invoker":111,"./deserialize":112,"./instantiate":115,"./js":116,"./miniFramework":117,"./requiring-frame":119,"./url":120}],115:[function(t,e,i){function n(t){if("object"!=typeof t||Array.isArray(t))return null;if(!t)return null;if(t instanceof c&&!t.isValid)return null;var e;if(t instanceof c){if(t._instantiate)return cc.game._isCloning=!0,e=t._instantiate(),cc.game._isCloning=!1,e;if(t instanceof cc.Asset)return null}return cc.game._isCloning=!0,e=o(t),cc.game._isCloning=!1,e}function o(t,e){if(Array.isArray(t))return cc.error("Can not instantiate array"),null;var i;if(t._iN$t)i=t._iN$t;else{var n=t.constructor;i=new n}r(t,i,e);for(var o=0,s=l.length;s>o;++o)l[o]._iN$t=null;return l.length=0,i}function r(t,e,i){var n,o,r,u=t.constructor;if(t._iN$t=e,l.push(t),cc.Class._isCCClass(u))for(var d=h.DELIMETER,p=u.__props__,_=h.getClassAttrs(u),f=0;f<p.length;f++)r=p[f],_[r+d+"serializable"]!==!1&&(n=t[r],o=typeof n,"object"===o?e[r]=n?s(n,i,e,r):n:e[r]="function"!==o?n:null);else for(r in t)!t.hasOwnProperty(r)||95===r.charCodeAt(0)&&95===r.charCodeAt(1)&&"__type__"!==r||(n=t[r],n!==e&&(o=typeof n,"object"===o?e[r]=n?s(n,i,e,r):n:e[r]="function"!==o?n:null));t instanceof c&&(e._objFlags&=a)}function s(t,e,i,n){var o=t._iN$t;if(o)return o;if(!cc.isValid(t))return null;if(t instanceof cc.Asset)return t;if(Array.isArray(t)){var c=t.length;o=new Array(c),t._iN$t=o;for(var a=0;c>a;++a){var h=t[a],u=typeof h;"object"===u?o[a]=h?s(h,e,o,""+a):h:o[a]="function"!==u?h:null}return l.push(t),o}if(t instanceof cc.ValueType)return t.clone();var d=t.constructor;if(cc.Class._isCCClass(d)){if(e)if(e instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return t}else if(e instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(e))return t}else if(t instanceof cc.Component&&!t.node.isChildOf(e))return t}else if(d!==Object)return t;return o=new d,r(t,o,e),o}var c=t("./CCObject"),a=c.Flags.PersistentMask,h=t("./attribute"),l=(t("./utils").isDomNode,[]);n._clone=o,cc.instantiate=n,e.exports=n},{"./CCObject":106,"./attribute":110,"./utils":121}],116:[function(t,e,i){function n(t,e){var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;var o=Object.getPrototypeOf(t);return o?n(o,e):null}function o(t,e,i){var o=n(e,t);Object.defineProperty(i,t,o)}function r(){return g+v++}function s(t,e){t.splice(e,1)}function c(t,e){var i=t.length;0>e||e>=i||(t[e]=t[i-1],t.length=i-1)}function a(t,e){var i=t.indexOf(e);return-1!==i?(s(t,i),!0):!1}function h(t,e){var i=t.indexOf(e);-1!==i&&(t[i]=t[t.length-1],--t.length)}function l(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.log(cc._LogInfos.Array.verifyType),!1;return!0}function u(t,e){for(var i=0,n=e.length;n>i;i++)a(t,e[i])}function d(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t}function p(t,e){return-1!==m.call(t,e)}function _(t){var e,i=t.length,n=new Array(i);for(e=0;i>e;e+=1)n[e]=t[e];return n}var f={isNumber:function(t){return"number"==typeof t||t instanceof Number},isString:function(t){return"string"==typeof t||t instanceof String},addon:function(t){"use strict";t=t||{};for(var e=1,i=arguments.length;i>e;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.error("cc.js.addon called on non-object:",n);continue}for(var r in n)r in t||o(r,n,t)}}return t},mixin:function(t){"use strict";t=t||{};for(var e=1,i=arguments.length;i>e;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.error("cc.js.mixin: arguments must be type object:",n);continue}for(var r in n)o(r,n,t)}}return t},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t},clear:function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)delete t[e[i]]},getPropertyDescriptor:n};f.getClassName=function(t){if("function"==typeof t){if(t.prototype.__classname__)return t.prototype.__classname__}else if(t&&t.constructor){if(t.constructor.prototype&&t.constructor.prototype.hasOwnProperty("__classname__"))return t.__classname__;var e;if(t.constructor.name&&(e=t.constructor.name),t.constructor.toString){var i,n=t.constructor.toString();i="["===n.charAt(0)?n.match(/\[\w+\s*(\w+)\]/):n.match(/function\s*(\w+)/),i&&2===i.length&&(e=i[1])}return"Object"!==e?e:""}return""};var g="cc.TmpCId.",v=0;!function(){function t(t,e){return function(i,n){if(n.prototype.hasOwnProperty(t)&&delete e[n.prototype[t]],n.prototype[t]=i,i){var o=e[i];if(o&&o!==n){var r="A Class already exists with the same "+t+' : "'+i+'".';cc.error(r)}else e[i]=n}}}var e={},i={};f._setClassId=t("__cid__",e);var n=t("__classname__",i);f.setClassName=function(t,e){if(n(t,e),!e.prototype.hasOwnProperty("__cid__")){var i=t||r();i&&f._setClassId(i,e)}},f.unregisterClass=function(t){"use strict";for(var n=0;n<arguments.length;n++){var o=arguments[n].prototype,r=o.__cid__;r&&delete e[r];var s=o.__classname__;s&&delete i[s]}},f._getClassById=function(t){return e[t]},f.getClassByName=function(t){return i[t]},f._getClassId=function(t,e){e="undefined"!=typeof e?e:!0;var i;if("function"==typeof t&&t.prototype.hasOwnProperty("__cid__"))return i=t.prototype.__cid__;if(t&&t.constructor){var n=t.constructor.prototype;if(n&&n.hasOwnProperty("__cid__"))return i=t.__cid__}return""}}(),f.getset=function(t,e,i,n,o){"function"!=typeof n&&(o=n,n=void 0),Object.defineProperty(t,e,{get:i,set:n,enumerable:!!o})},f.get=function(t,e,i,n){Object.defineProperty(t,e,{get:i,enumerable:!!n})},f.set=function(t,e,i,n){Object.defineProperty(t,e,{set:i,enumerable:!!n})},f.obsolete=function(t,e,i,n){function o(){return this[i]}var r=e.split(".").slice(-1);n?f.getset(t,r,o,function(t){this[i]=t}):f.get(t,r,o)},f.obsoletes=function(t,e,i,n){for(var o in i){var r=i[o];f.obsolete(t,e+"."+o,r,n)}},f.formatStr=function(){var t=arguments,e=t.length;if(1>e)return"";var i=/(%d)|(%s)/,n=1,o=t[0],r="string"==typeof o&&i.test(o);if(r)for(var s=/%s/;e>n;++n){var c=t[n],a="number"==typeof c?i:s;a.test(o)?o=o.replace(a,c):o+=" "+c}else if(e>1)for(;e>n;++n)o+=" "+t[n];else o=""+o;return o};var m=Array.prototype.indexOf;f.array={remove:a,fastRemove:h,removeAt:s,fastRemoveAt:c,contains:p,verifyType:l,removeArray:u,appendObjectsAt:d,copy:_,indexOf:m,MutableForwardIterator:t("../utils/mutable-forward-iterator")},cc.js=f,e.exports=f},{"../utils/mutable-forward-iterator":127}],117:[function(t,e,i){switch(cc.$=function(t){var e=this===cc?document:this,i=t instanceof HTMLElement?t:e.querySelector(t);return i&&(i.find=i.find||cc.$,i.hasClass=i.hasClass||function(t){return this.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},i.addClass=i.addClass||function(t){return this.hasClass(t)||(this.className&&(this.className+=" "),this.className+=t),this},i.removeClass=i.removeClass||function(t){return this.hasClass(t)&&(this.className=this.className.replace(t,"")),this},i.remove=i.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},i.appendTo=i.appendTo||function(t){return t.appendChild(this),this},i.prependTo=i.prependTo||function(t){return t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(t,e){return this.position.x=t,this.position.y=e,this.transforms(),this},i.rotate=function(t){return this.rotation=t,this.transforms(),this},i.resize=function(t,e){return this.scale.x=t,this.scale.y=e,this.transforms(),this},i.setSkew=function(t,e){return this.skew.x=t,this.skew.y=e,this.transforms(),this}),i},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O",cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms",cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(t){return"translate3d("+t.x+"px, "+t.y+"px, 0) "}:function(t){return"translate("+t.x+"px, "+t.y+"px) "},cc.$.rotate=cc.$.hd?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "},cc.$.scale=function(t){return"scale("+t.x+", "+t.y+") "},cc.$.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"},cc.$new=function(t){return cc.$(document.createElement(t))},cc.$.findpos=function(t){var e=0,i=0;do e+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{x:e,y:i}}},{}],118:[function(t,e,i){function n(t,e,i,n){if(!t.get&&!t.set&&t.hasOwnProperty("default")){var o="_N$"+e;t.get=function(){return this[o]},t.set=function(t){var e=this[o];this[o]=t,i.call(this,e)};var r={};n[o]=r;for(var s in c){var a=c[s];t.hasOwnProperty(s)&&(r[s]=t[s],a.canUsedInGet||delete t[s])}}}function o(t,e,i,n){Array.isArray(n)&&n.length>0&&(n=n[0]),t.type=n}function r(t,e,i,n){if(Array.isArray(e)){if(!(e.length>0))return cc.error("Invalid type of %s.%s",i,n);t.type=e=e[0]}}function s(t,e,i,n){}var c={url:{canUsedInGet:!0},"default":{},serializable:{},editorOnly:{},rawType:{}};e.exports=function(t,e,i){for(var c in t){var a=t[c],h=a&&a.constructor===Object;if(!h){if(Array.isArray(a)&&a.length>0)a={"default":[],type:a};else if("function"==typeof a){var l=a;a=cc.RawAsset.isRawAssetType(l)?{"default":"",url:l}:cc.isChildClassOf(l,cc.ValueType)?{"default":new l}:{"default":null,type:a}}else a={"default":a};t[c]=a}if(a){var u=a.notify;u&&n(a,c,u,t),"type"in a&&r(a,a.type,e,c),"url"in a&&o(a,e,c,a.url),"type"in a&&s(a,a.type,e,c)}}}},{"./CCClass":104}],119:[function(t,e,i){var n=[];cc._RFpush=function(t,e,i){2===arguments.length&&(i=e,e=""),n.push({uuid:e,script:i,module:t,exports:t.exports,beh:null})},cc._RFpop=function(){var t=n.pop(),e=t.module,i=e.exports;if(i===t.exports){for(var o in i)return;e.exports=i=t.beh}},cc._RFpeek=function(){return n[n.length-1]}},{}],120:[function(t,e,i){var n={};cc.url={_rawAssets:"",_builtinRawAssets:"",normalize:function(t){return 46===t.charCodeAt(0)&&47===t.charCodeAt(1)?t=t.slice(2):47===t.charCodeAt(0)&&(t=t.slice(1)),t},raw:function(t){return t=this.normalize(t),t.startsWith("resources/")||cc.error('Sorry can not load "%s" because it is not placed in the "resources" folder.',t),this._rawAssets+t},builtinRaw:!1,_init:function(t){for(var e in t){var i=t[e];i=cc.path._setEndWithSep(i,"/"),n[e]=i}this._rawAssets=n.assets,this._builtinRawAssets=n.internal}},e.exports=cc.url},{}],121:[function(t,e,i){e.exports={isDomNode:"object"==typeof window&&("function"==typeof Node?function(t){return t instanceof Node}:function(t){return t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}),callInNextTick:function(t,e,i){t&&setTimeout(function(){t(e,i)},0)}}},{}],122:[function(t,e,i){t("./CCSpriteFrame"),cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(t){var e=this._CCNS_REG2.exec(t);return e?cc.rect(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])):cc.rect(0,0,0,0)},_pointFromString:function(t){var e=this._CCNS_REG1.exec(t);return e?cc.p(parseFloat(e[1]),parseFloat(e[2])):cc.p(0,0)},_sizeFromString:function(t){var e=this._CCNS_REG1.exec(t);return e?cc.size(parseFloat(e[1]),parseFloat(e[2])):cc.size(0,0)},_getFrameConfig:function(t){var e=cc.loader.getRes(t);return cc.assert(e,cc._LogInfos.spriteFrameCache._getFrameConfig_2,t),cc.loader.release(t),e._inited?(this._frameConfigCache[t]=e,e):(this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t])},_getFrameConfigByJsonObject:function(t,e){return cc.assert(e,cc._LogInfos.spriteFrameCache._getFrameConfig_2,t),this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t]},_parseFrameConfig:function(t){var e=t.frames,i=t.metadata||t.meta,n={},o={},r=0;if(i){var s=i.format;r=s.length<=1?parseInt(s):s,o.image=i.textureFileName||i.textureFileName||i.image;
}for(var c in e){var a=e[c];if(a){var h={};if(0==r){h.rect=cc.rect(a.x,a.y,a.width,a.height),h.rotated=!1,h.offset=cc.p(a.offsetX,a.offsetY);var l=a.originalWidth,u=a.originalHeight;l&&u||cc.log(cc._LogInfos.spriteFrameCache._getFrameConfig),l=Math.abs(l),u=Math.abs(u),h.size=cc.size(l,u)}else if(1==r||2==r)h.rect=this._rectFromString(a.frame),h.rotated=a.rotated||!1,h.offset=this._pointFromString(a.offset),h.size=this._sizeFromString(a.sourceSize);else if(3==r){var d=this._sizeFromString(a.spriteSize),p=this._rectFromString(a.textureRect);d&&(p=cc.rect(p.x,p.y,d.width,d.height)),h.rect=p,h.rotated=a.textureRotated||!1,h.offset=this._pointFromString(a.spriteOffset),h.size=this._sizeFromString(a.spriteSourceSize),h.aliases=a.aliases}else{var _=a.frame,f=a.sourceSize;c=a.filename||c,h.rect=cc.rect(_.x,_.y,_.w,_.h),h.rotated=a.rotated||!1,h.offset=cc.p(0,0),h.size=cc.size(f.w,f.h)}n[c]=h}}return{_inited:!0,frames:n,meta:o}},_addSpriteFramesByObject:function(t,e,i){if(cc.assert(t,cc._LogInfos.spriteFrameCache.addSpriteFrames_2),e&&e.frames){var n=this._frameConfigCache[t]||this._getFrameConfigByJsonObject(t,e);this._createSpriteFrames(t,n,i)}},_createSpriteFrames:function(t,e,i){var n=e.frames,o=e.meta;if(i)i instanceof cc.Texture2D||(cc.js.isString(i)?i=cc.textureCache.addImage(i):cc.assert(0,cc._LogInfos.spriteFrameCache.addSpriteFrames_3));else{var r=cc.path.changeBasename(t,o.image||".png");i=cc.textureCache.addImage(r)}var s=this._spriteFramesAliases,c=this._spriteFrames;for(var a in n){var h=n[a],l=c[a];if(!l){l=new cc.SpriteFrame(i,h.rect,h.rotated,h.offset,h.size);var u=h.aliases;if(u)for(var d=0,p=u.length;p>d;d++){var _=u[d];s[_]&&cc.log(cc._LogInfos.spriteFrameCache.addSpriteFrames,_),s[_]=a}if(cc._renderType===cc.game.RENDER_TYPE_CANVAS&&l.isRotated()){var f=l.getTexture();if(f.isLoaded()){var g=l.getTexture().getHtmlElementObj();g=_ccsg.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(g,l.getRect());var v=new cc.Texture2D;v.initWithElement(g),v.handleLoadedTexture(),l.setTexture(v);var m=l._rect;l.setRect(cc.rect(0,0,m.width,m.height))}}c[a]=l}}},addSpriteFrames:function(t,e){cc.assert(t,cc._LogInfos.spriteFrameCache.addSpriteFrames_2);var i=this._frameConfigCache[t]||cc.loader.getRes(t);if(i&&i.frames){var n=this._frameConfigCache[t]||this._getFrameConfig(t);this._createSpriteFrames(t,n,e)}},_checkConflict:function(t){var e=t.frames;for(var i in e)this._spriteFrames[i]&&cc.log(cc._LogInfos.spriteFrameCache._checkConflict,i)},addSpriteFrame:function(t,e){this._spriteFrames[e]=t},removeSpriteFrames:function(){this._spriteFrames={},this._spriteFramesAliases={}},removeSpriteFrameByName:function(t){t&&(this._spriteFramesAliases[t]&&delete this._spriteFramesAliases[t],this._spriteFrames[t]&&delete this._spriteFrames[t])},removeSpriteFramesFromFile:function(t){var e=this,i=e._spriteFrames,n=e._spriteFramesAliases,o=e._frameConfigCache[t];if(o){var r=o.frames;for(var s in r)if(i[s]){delete i[s];for(var c in n)n[c]===s&&delete n[c]}}},removeSpriteFramesFromTexture:function(t){var e=this,i=e._spriteFrames,n=e._spriteFramesAliases;for(var o in i){var r=i[o];if(r&&r.getTexture()===t){delete i[o];for(var s in n)n[s]===o&&delete n[s]}}},getSpriteFrame:function(t){var e=this,i=e._spriteFrames[t];if(!i){var n=e._spriteFramesAliases[t];n&&(i=e._spriteFrames[n.toString()],i||delete e._spriteFramesAliases[t])}return i},_clear:function(){this._spriteFrames={},this._spriteFramesAliases={},this._frameConfigCache={}}}},{"./CCSpriteFrame":184}],123:[function(t,e,i){t("../platform/CCSys");var n=/(\.[^\.\/\?\\]*)(\?.*)?$/,o=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var t=arguments.length,e="",i=0;t>i;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){var e=n.exec(t);return e?e[1]:""},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");i>0&&(t=t.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g,o=n.exec(t.replace(/(\/|\\\\)$/,""));if(!o)return null;var r=o[2];return e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?r.substring(0,r.length-e.length):r},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return i>0&&(n=t.substring(i),t=t.substring(0,i)),i=t.lastIndexOf("."),0>i?t+e+n:t.substring(0,i)+e+n},changeBasename:function(t,e,i){if(0===e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),o="",r=i?this.extname(t):"";return n>0&&(o=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),n=0>=n?0:n+1,t.substring(0,n)+e+r+o},_normalize:function(t){var e=t=String(t);do e=t,t=t.replace(o,"");while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",_setEndWithSep:function(t,e){var i=cc.path.sep;"undefined"==typeof e?e=!0:"string"==typeof e&&(i=e,e=!!e);var n=t[t.length-1],o="\\"===n||"/"===n;return!o&&e?t+=i:o&&!e&&(t=t.slice(0,-1)),t}},e.exports=cc.path},{"../platform/CCSys":107}],124:[function(t,e,i){function n(t){var e=t._parent;e._reorderChildDirty=!0,e._delaySort()}var o=t("./scene-graph-helper"),r=t("../platform/CCObject").Flags.Destroying,s=t("./misc"),c=(s.DirtyFlags,t("../platform/id-generater")),a="position-changed",h="size-changed",l="anchor-changed",u="child-added",d="child-removed",p="child-reorder",_=new c("Node"),f=cc.Class({name:"cc._BaseNode","extends":cc.Object,mixins:[cc.EventTarget],properties:{_opacity:255,_color:cc.Color.WHITE,_cascadeOpacityEnabled:!0,_parent:null,_anchorPoint:cc.p(.5,.5),_contentSize:cc.size(0,0),_children:[],_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_localZOrder:0,_globalZOrder:0,_tag:cc.macro.NODE_TAG_INVALID,_opacityModifyRGB:!1,name:{get:function(){return this._name},set:function(t){this._name=t}},parent:{get:function(){return this._parent},set:function(t){if(this._parent!==t){var e=this._sgNode;e.parent&&e.parent.removeChild(e,!1);var i=this._parent;if(this._parent=t||null,t){var o=t._sgNode;o.addChild(e),n(this),t._children.push(this),t.emit(u,this)}if(i){if(!(i._objFlags&r)){var s=i._children.indexOf(this);i._children.splice(s,1),i.emit(d,this),this._onHierarchyChanged(i)}}else t&&this._onHierarchyChanged(null)}}},_id:{"default":"",editorOnly:!0},uuid:{get:function(){var t=this._id;return t||(t=this._id=_.getNewId()),t}},skewX:{get:function(){return this._skewX},set:function(t){this._skewX=t,this._sgNode.skewX=t}},skewY:{get:function(){return this._skewY},set:function(t){this._skewY=t,this._sgNode.skewY=t}},zIndex:{get:function(){return this._localZOrder},set:function(t){this._localZOrder!==t&&(this._localZOrder=t,this._sgNode.zIndex=t,this._parent&&n(this))}},rotation:{get:function(){return this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node.getRotation),this._rotationX},set:function(t){this._rotationX===t&&this._rotationY===t||(this._rotationX=this._rotationY=t,this._sgNode.rotation=t)}},rotationX:{get:function(){return this._rotationX},set:function(t){this._rotationX!==t&&(this._rotationX=t,this._sgNode.rotationX=t)}},rotationY:{get:function(){return this._rotationY},set:function(t){this._rotationY!==t&&(this._rotationY=t,this._sgNode.rotationY=t)}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX!==t&&(this._scaleX=t,this._sgNode.scaleX=t)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY!==t&&(this._scaleY=t,this._sgNode.scaleY=t)}},x:{get:function(){return this._position.x},set:function(t){var e=this._position;if(t!==e.x){e.x=t,this._sgNode.setPositionX(t);var i=this._capturingListeners&&this._capturingListeners._callbackTable[a],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[a];(i&&i.length>0||n&&n.length>0)&&this.emit(a)}}},y:{get:function(){return this._position.y},set:function(t){var e=this._position;if(t!==e.y){e.y=t,this._sgNode.setPositionY(t);var i=this._capturingListeners&&this._capturingListeners._callbackTable[a],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[a];(i&&i.length>0||n&&n.length>0)&&this.emit(a)}}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},anchorX:{get:function(){return this._anchorPoint.x},set:function(t){var e=this._anchorPoint;if(e.x!==t){e.x=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit(l)}}},anchorY:{get:function(){return this._anchorPoint.y},set:function(t){var e=this._anchorPoint;if(e.y!==t){e.y=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit(l)}}},width:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getWidth();return this._contentSize.width=t,t}return this._contentSize.width},set:function(t){if(t!==this._contentSize.width){var e=this._sizeProvider;e&&e.setContentSize(t,e._getHeight());this._contentSize.width=t,this.emit(h)}}},height:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getHeight();return this._contentSize.height=t,t}return this._contentSize.height},set:function(t){if(t!==this._contentSize.height){var e=this._sizeProvider;e&&e.setContentSize(e._getWidth(),t);this._contentSize.height=t,this.emit(h)}}},_ignoreAnchor:{get:function(){return this.__ignoreAnchor},set:function(t){if(this.__ignoreAnchor!==t){this.__ignoreAnchor=t,this._sgNode.ignoreAnchor=t;var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&(e.ignoreAnchor=t),this.emit(l)}}},tag:{get:function(){return this._tag},set:function(t){this._tag=t,this._sgNode.tag=t}},opacity:{get:function(){return this._opacity},set:function(t){if(this._opacity!==t&&(this._opacity=t,this._sgNode.setOpacity(t),!this._cascadeOpacityEnabled)){var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacity(t)}},range:[0,255]},cascadeOpacity:{get:function(){return this._cascadeOpacityEnabled},set:function(t){if(this._cascadeOpacityEnabled!==t){this._cascadeOpacityEnabled=t,this._sgNode.cascadeOpacity=t;var e=t?255:this._opacity,i=this._sizeProvider;i instanceof _ccsg.Node&&i.setOpacity(e)}}},color:{get:function(){var t=this._color;return new cc.Color(t.r,t.g,t.b,t.a)},set:function(t){if(!this._color.equals(t)){var e=this._color;e.r=t.r,e.g=t.g,e.b=t.b,this._sizeProvider instanceof _ccsg.Node&&this._sizeProvider.setColor(t)}}}},ctor:function(){var t=this._sgNode=new _ccsg.Node;t.retain(),t._entity=this,t.onEnter=function(){_ccsg.Node.prototype.onEnter.call(this),this._entity&&!this._entity._active&&(cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this))},cc.game._isCloning||(t.cascadeOpacity=!0),this._sizeProvider=null,this.__ignoreAnchor=!1,this._reorderChildDirty=!1,this.__instanceId=this._id||cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},_onPreDestroy:function(){this._sgNode.release(),this._sgNode._entity=null,this._sgNode=null,cc.eventManager.removeListeners(this);for(var t=0,e=this.__eventTargets.length;e>t;++t){var i=this.__eventTargets[t];i&&i.targetOff(this)}cc.director.off(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_destruct:s.destructIgnoreId,_onHierarchyChanged:null,init:function(){return!0},attr:function(t){for(var e in t)this[e]=t[e]},setGlobalZOrder:function(t){this._globalZOrder=t,this._sgNode.setGlobalZOrder(t)},getGlobalZOrder:function(){return this._globalZOrder=this._sgNode.getGlobalZOrder(),this._globalZOrder},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node.getScale),this._scaleX},setScale:function(t,e){"object"==typeof t?(e=t.y,t=t.x):e=e||0===e?e:t,this._scaleX===t&&this._scaleY===e||(this._scaleX=t,this._scaleY=e,this._sgNode.setScale(t,e))},getPosition:function(){return cc.p(this._position)},setPosition:function(t,e){var i;"undefined"==typeof e?(i=t.x,e=t.y):(i=t,e=e);var n=this._position;if(n.x!==i||n.y!==e){n.x=i,n.y=e,this._sgNode.setPosition(i,e);var o=this._capturingListeners&&this._capturingListeners._callbackTable[a],r=this._bubblingListeners&&this._bubblingListeners._callbackTable[a];(o&&o.length>0||r&&r.length>0)&&this.emit(a)}},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}var n=this._sizeProvider;n instanceof _ccsg.Node&&n.setAnchorPoint(i),this.emit(l)},getAnchorPointInPoints:function(){return this._sgNode.getAnchorPointInPoints()},getContentSize:function(t){if(this._sizeProvider&&!t){var e=this._sizeProvider.getContentSize();return this._contentSize=e,e}return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._sizeProvider&&this._sizeProvider.setContentSize(i),this.emit(h)},getBoundingBox:function(){var t=this.getContentSize(),e=cc.rect(0,0,t.width,t.height);return cc._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},cleanup:function(){cc.director.getActionManager().removeAllActionsFromTarget(this),cc.eventManager.removeListeners(this);var t,e,i=this._children.length;for(t=0;i>t;++t)e=this._children[t],e&&e.cleanup()},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n.tag===t)return n}return null},getChildByUuid:function(t){if(!t)return cc.log("Invalid uuid"),null;for(var e=this._children,i=0,n=e.length;n>i;i++)if(e[i]._id===t)return e[i];return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;n>i;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t,e,i){e=void 0===e?t._localZOrder:e;var n,o=!1;"undefined"==typeof i?(i=void 0,n=t._name):cc.js.isString(i)?(n=i,i=void 0):cc.js.isNumber(i)&&(o=!0,n=""),cc.assert(t,cc._LogInfos.Node.addChild_3),cc.assert(null===t._parent,"child already added. It can't be added again"),t.parent=this,t.zIndex=e,o?t.setTag(i):t.setName(n)},removeFromParent:function(t){this._parent&&(void 0===t&&(t=!0),this._parent.removeChild(this,t))},removeChild:function(t,e){this._children.indexOf(t)>-1&&((e||void 0===e)&&t.cleanup(),t.parent=null)},removeChildByTag:function(t,e){t===cc.macro.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node.removeChildByTag);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.log(cc._LogInfos.Node.removeChildByTag_2,t)},removeAllChildren:function(t){var e=this._children;void 0===t&&(t=!0);for(var i=e.length-1;i>=0;i--){var n=e[i];n&&(t&&n.cleanup(),n.parent=null)}this._children.length=0},setNodeDirty:function(){this._sgNode.setNodeDirty()},getParentToNodeTransform:function(){return this._sgNode.getParentToNodeTransform()},_isSgTransformArToMe:function(t){var e=this._sgNode.getContentSize();return 0!==e.width||0!==e.height||0===t.width&&0===t.height?!!this._sgNode.isIgnoreAnchorPointForPosition():!0},getNodeToWorldTransform:function(){var t=this.getContentSize();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getNodeToWorldTransformAR:function(){var t=this.getContentSize();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.getNodeToWorldTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getWorldToNodeTransform:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.getWorldToNodeTransform()},convertToNodeSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=this._sgNode.convertToNodeSpace(t);return cc.pAdd(e,cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},convertToWorldSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var e=t.x-this._anchorPoint.x*this._contentSize.width,i=t.y-this._anchorPoint.y*this._contentSize.height;return cc.v2(this._sgNode.convertToWorldSpace(cc.v2(e,i)))},convertToNodeSpaceAR:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.isIgnoreAnchorPointForPosition()?cc.v2(this._sgNode.convertToNodeSpace(t)):this._sgNode.convertToNodeSpaceAR(t)},convertToWorldSpaceAR:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.isIgnoreAnchorPointForPosition()?cc.v2(this._sgNode.convertToWorldSpace(t)):cc.v2(this._sgNode.convertToWorldSpaceAR(t))},convertTouchToNodeSpace:function(t){return this.convertToNodeSpace(t.getLocation())},convertTouchToNodeSpaceAR:function(t){return this.convertToNodeSpaceAR(t.getLocation())},getNodeToParentTransform:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(this._isSgTransformArToMe(t)){var i=-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getNodeToParentTransformAR:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,o=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(o,e)}return e},getBoundingBoxToWorld:function(){var t;return this.parent&&(t=this.parent.getNodeToWorldTransformAR()),this._getBoundingBoxTo(t)},_getBoundingBoxTo:function(t){var e=this.getContentSize(),i=e.width,n=e.height,o=cc.rect(-this._anchorPoint.x*i,-this._anchorPoint.y*n,i,n),r=cc.affineTransformConcat(this.getNodeToParentTransformAR(),t);if(cc._rectApplyAffineTransformIn(o,r),!this._children)return o;for(var s=this._children,c=0;c<s.length;c++){var a=s[c];if(a&&a.active){var h=a._getBoundingBoxTo(r);h&&(o=cc.rectUnion(o,h))}}return o},getDisplayedOpacity:function(){return this._sgNode.getDisplayedOpacity()},_updateDisplayedOpacity:function(t){this._sgNode.updateDisplayedOpacity(t)},getDisplayedColor:function(){return this._sgNode.getDisplayedColor()},setOpacityModifyRGB:function(t){if(this._opacityModifyRGB!==t){this._opacityModifyRGB=t,this._sgNode.setOpacityModifyRGB(t);var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacityModifyRGB(t)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getSiblingIndex:function(){return this._parent?this._parent._children.indexOf(this):0},setSiblingIndex:function(t){if(this._parent){var e=this._parent._children;t=-1!==t?t:e.length-1;var i=e.indexOf(this);if(t!==i){e.splice(i,1),t<e.length?e.splice(t,0,this):e.push(this);var n,o=this._parent,r=o._children,s=0,c=r.length;if(cc.runtime)for(;c>s;s++){n=r[s]._sgNode;var a=n.getLocalZOrder();n.setLocalZOrder(a+1),n.setLocalZOrder(a)}else if(o._sgNode.removeChild(this._sgNode,!1),t+1<e.length){var h=e[t+1];o._sgNode.insertChildBefore(this._sgNode,h._sgNode)}else o._sgNode.addChild(this._sgNode)}}},isChildOf:function(t){var e=this;do{if(e===t)return!0;e=e._parent}while(e);return!1},sortAllChildren:function(){if(this._reorderChildDirty){this._reorderChildDirty=!1;var t=this._children;if(t.length>1){var e,i,n,o=t.length;for(e=1;o>e;e++){for(n=t[e],i=e-1;i>=0;){if(n._localZOrder<t[i]._localZOrder)t[i+1]=t[i];else{if(!(n._localZOrder===t[i]._localZOrder&&n._sgNode._arrivalOrder<t[i]._sgNode._arrivalOrder))break;t[i+1]=t[i]}i--}t[i+1]=n}this.emit(p)}}cc.director.off(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_delaySort:function(){cc.director.on(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_updateDummySgNode:function(){var t=this,e=t._sgNode;e.setPosition(t._position),e.setRotationX(t._rotationX),e.setRotationY(t._rotationY),e.setScale(t._scaleX,t._scaleY),e.setSkewX(t._skewX),e.setSkewY(t._skewY),e.setIgnoreAnchorPointForPosition(t.__ignoreAnchor);var i=e._arrivalOrder;e.setLocalZOrder(t._localZOrder),e._arrivalOrder=i,e.setGlobalZOrder(t._globalZOrder),e.setColor(this._color),e.setOpacity(t._opacity),e.setOpacityModifyRGB(t._opacityModifyRGB),e.setCascadeOpacityEnabled(t._cascadeOpacityEnabled),e.setTag(t._tag)},_updateSgNode:function(){this._updateDummySgNode();var t=this._sgNode;t.setAnchorPoint(this._anchorPoint),t.setVisible(this._active),t.setColor(this._color),this._activeInHierarchy?(cc.director.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this)):(cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this))},onRestore:!1,_removeSgNode:o.removeSgNode}),g=["name","skewX","skewY","position","rotation","rotationX","rotationY","scale","scaleX","scaleY","children","childrenCount","parent","opacity","color","tag"],v={x:["getPositionX","setPositionX"],y:["getPositionY","setPositionY"],zIndex:["getLocalZOrder","setLocalZOrder"],opacityModifyRGB:["isOpacityModifyRGB"],cascadeOpacity:["isCascadeOpacityEnabled","setCascadeOpacityEnabled"]};s.propertyDefine(f,g,v),cc._BaseNode=e.exports=f},{"../platform/CCObject":106,"../platform/id-generater":113,"./misc":126,"./scene-graph-helper":129}],125:[function(t,e,i){cc.find=e.exports=function(t,e){if(null==t)return cc.error("Argument must be non-nil"),null;if(!e){var i=cc.director.getScene();if(!i)return null;e=i}for(var n=e,o="/"!==t[0]?0:1,r=t.split("/"),s=o;s<r.length;s++){var c=r[s],a=n._children;n=null;for(var h=0,l=a.length;l>h;++h){var u=a[h];if(u.name===c){n=u;break}}if(!n)return null}return n}},{}],126:[function(t,e,i){var n={};n.propertyDefine=function(t,e,i){function n(t,e,i,n){var o=Object.getOwnPropertyDescriptor(t,e);if(o)o.get&&(t[i]=o.get),o.set&&n&&(t[n]=o.set);else{var r=t[i];cc.js.getset(t,e,r,t[n])}}for(var o,r=t.prototype,s=0;s<e.length;s++){o=e[s];var c=o[0].toUpperCase()+o.slice(1);n(r,o,"get"+c,"set"+c)}for(o in i){var a=i[o];n(r,o,a[0],a[1])}},n.NextPOT=function(t){return t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1},n.destructIgnoreId=function(){for(var t in this)if(this.hasOwnProperty(t)&&"_id"!==t)switch(typeof this[t]){case"string":this[t]="";break;case"object":case"function":this[t]=null}},e.exports=n},{}],127:[function(t,e,i){function n(t){this.i=0,this.array=t}var o=n.prototype;o.removeAt=function(t){this.array.splice(t,1),t<=this.i&&--this.i},o.push=function(t){this.array.push(t)},e.exports=n},{}],128:[function(t,e,i){cc._PrefabInfo=cc.Class({name:"cc.PrefabInfo",properties:{root:null,asset:null,fileId:"",sync:!1,_synced:{"default":!1,serializable:!1}}}),e.exports={syncWithPrefab:function(t){var e=t._prefab;if(e._synced=!0,!e.asset)return cc.error('Failed to load prefab asset for node "%s"',t.name),void(t._prefab=null);var i=t._objFlags,n=t._parent,o=t._id,r=t._name,s=t._active,c=t._position,a=t._rotationX,h=t._rotationY,l=t._localZOrder,u=t._globalZOrder,d=e.asset.data;d._prefab._synced=!0,d._iN$t=t,cc.game._isCloning=!0,cc.instantiate._clone(d,d),cc.game._isCloning=!1,t._objFlags=i,t._parent=n,t._id=o,t._prefab=e,t._name=r,t._active=s,t._position=c,t._rotationX=a,t._rotationY=h,t._localZOrder=l,t._globalZOrder=u}}},{}],129:[function(t,e,i){var n={removeSgNode:function(){var t=this._sgNode;if(t){var e=t._parent;e&&e.removeChild(t),t.release(),this._sgNode._entity&&(this._sgNode._entity=null)}}};e.exports=n},{}],130:[function(t,e,i){cc.AffineTransform=function(t,e,i,n,o,r){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=o,this.ty=r},cc.affineTransformMake=function(t,e,i,n,o,r){return{a:t,b:e,c:i,d:n,tx:o,ty:r}},cc.affineTransformClone=function(t){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty}},cc.pointApplyAffineTransform=function(t,e,i){var n,o;return void 0===i?(i=e,n=t.x,o=t.y):(n=t,o=e),{x:i.a*n+i.c*o+i.tx,y:i.b*n+i.d*o+i.ty}},cc._pointApplyAffineTransform=function(t,e,i){return cc.pointApplyAffineTransform(t,e,i)},cc.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var i=t.x,n=t.y,o=i+t.width,r=n+t.height,s=e.a*i+e.c*n+e.tx,c=e.b*i+e.d*n+e.ty,a=e.a*o+e.c*n+e.tx,h=e.b*o+e.d*n+e.ty,l=e.a*i+e.c*r+e.tx,u=e.b*i+e.d*r+e.ty,d=e.a*o+e.c*r+e.tx,p=e.b*o+e.d*r+e.ty,_=Math.min(s,a,l,d),f=Math.max(s,a,l,d),g=Math.min(c,h,u,p),v=Math.max(c,h,u,p);return cc.rect(_,g,f-_,v-g)},cc._rectApplyAffineTransformIn=function(t,e){var i=t.x,n=t.y,o=i+t.width,r=n+t.height,s=e.a*i+e.c*n+e.tx,c=e.b*i+e.d*n+e.ty,a=e.a*o+e.c*n+e.tx,h=e.b*o+e.d*n+e.ty,l=e.a*i+e.c*r+e.tx,u=e.b*i+e.d*r+e.ty,d=e.a*o+e.c*r+e.tx,p=e.b*o+e.d*r+e.ty,_=Math.min(s,a,l,d),f=Math.max(s,a,l,d),g=Math.min(c,h,u,p),v=Math.max(c,h,u,p);return t.x=_,t.y=g,t.width=f-_,t.height=v-g,t},cc.obbApplyAffineTransform=function(t,e,i,n,o,r){var s=t.x,c=t.y,a=t.width,h=t.height,l=e.a*s+e.c*c+e.tx,u=e.b*s+e.d*c+e.ty,d=e.a*a,p=e.b*a,_=e.c*h,f=e.d*h;n.x=l,n.y=u,o.x=d+l,o.y=p+u,i.x=_+l,i.y=f+u,r.x=d+_+l,r.y=p+f+u},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return{a:t.a*n+t.c*i,b:t.b*n+t.d*i,c:t.c*n-t.a*i,d:t.d*n-t.b*i,tx:t.tx,ty:t.ty}},cc.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},cc.affineTransformConcatIn=function(t,e){var i=t.a,n=t.b,o=t.c,r=t.d,s=t.tx,c=t.ty;return t.a=i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=o*e.a+r*e.c,t.d=o*e.b+r*e.d,t.tx=s*e.a+c*e.c+e.tx,t.ty=s*e.b+c*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},cc.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}}},{}],131:[function(t,e,i){var n=t("./CCValueType"),o=t("../platform/js"),r=function(){function e(t,e,i,n){"object"==typeof t&&(e=t.g,i=t.b,n=t.a,t=t.r),this.r=t||0,this.g=e||0,this.b=i||0,this.a="number"==typeof n?n:255}o.extend(e,n),t("../platform/CCClass").fastDefine("cc.Color",e,{r:0,g:0,b:0,a:255});var i={WHITE:[255,255,255,255],BLACK:[0,0,0,255],TRANSPARENT:[0,0,0,0],GRAY:[127.5,127.5,127.5],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,235,4],ORANGE:[255,127,0],CYAN:[0,255,255],MAGENTA:[255,0,255]};for(var r in i){var s=function(t,i,n,o){return function(){return new e(t,i,n,o)}}.apply(null,i[r]);Object.defineProperty(e,r,{get:s})}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.a)},e.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},e.prototype.lerp=function(t,i,n){n=n||new e;var o=this.r,r=this.g,s=this.b,c=this.a;return n.r=o+(t.r-o)*i,n.g=r+(t.g-r)*i,n.b=s+(t.b-s)*i,n.a=c+(t.a-c)*i,n},e.prototype.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},e.prototype.setR=function(t){return this.r=t,this},e.prototype.setG=function(t){return this.g=t,this},e.prototype.setB=function(t){return this.b=t,this},e.prototype.setA=function(t){return this.a=t,this},e.prototype.toCSS=function(t){return"rgba"===t?"rgba("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+","+(this.a/255).toFixed(2)+")":"rgb"===t?"rgb("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+")":"#"+this.toHEX(t)},e.prototype.clamp=function(){this.r=cc.clampf(this.r,0,255),this.g=cc.clampf(this.g,0,255),this.b=cc.clampf(this.b,0,255),this.a=cc.clampf(this.a,0,255)},e.prototype.fromHEX=function(t){var e=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return this.r=e>>16,this.g=(65280&e)>>8,this.b=255&e,this},e.prototype.toHEX=function(t){var e=[(0|this.r).toString(16),(0|this.g).toString(16),(0|this.b).toString(16)],i=-1;if("#rgb"===t)for(i=0;i<e.length;++i)e[i].length>1&&(e[i]=e[i][0]);else if("#rrggbb"===t)for(i=0;i<e.length;++i)1===e[i].length&&(e[i]="0"+e[i]);return e.join("")},e.prototype.toRGBValue=function(){return(cc.clampf(this.r,0,255)<<16)+(cc.clampf(this.g,0,255)<<8)+cc.clampf(this.b,0,255)},e.prototype.fromHSV=function(t,i,n){var o=e.hsv2rgb(t,i,n);return this.r=o.r,this.g=o.g,this.b=o.b,this},e.prototype.toHSV=function(){return e.rgb2hsv(this.r,this.g,this.b)},e}();r.rgb2hsv=function(t,e,i){t/=255,e/=255,i/=255;var n={h:0,s:0,v:0},o=Math.max(t,e,i),r=Math.min(t,e,i),s=0;return n.v=o,n.s=o?(o-r)/o:0,n.s?(s=o-r,t===o?n.h=(e-i)/s:e===o?n.h=2+(i-t)/s:n.h=4+(t-e)/s,n.h/=6,n.h<0&&(n.h+=1)):n.h=0,n},r.hsv2rgb=function(t,e,i){var n={r:0,g:0,b:0};if(0===e)n.r=n.g=n.b=i;else if(0===i)n.r=n.g=n.b=0;else{1===t&&(t=0),t*=6,e=e,i=i;var o=Math.floor(t),r=t-o,s=i*(1-e),c=i*(1-e*r),a=i*(1-e*(1-r));switch(o){case 0:n.r=i,n.g=a,n.b=s;break;case 1:n.r=c,n.g=i,n.b=s;break;case 2:n.r=s,n.g=i,n.b=a;break;case 3:n.r=s,n.g=c,n.b=i;break;case 4:n.r=a,n.g=s,n.b=i;break;case 5:n.r=i,n.g=s,n.b=c}}return n.r*=255,n.g*=255,n.b*=255,n},cc.Color=r,cc.color=function(t,e,i,n){if("string"==typeof t){var o=new cc.Color;return o.fromHEX(t)}return"object"==typeof t?new cc.Color(t.r,t.g,t.b,t.a):new cc.Color(t,e,i,n)},cc.colorEqual=function(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b},cc.hexToColor=function(t){t=t.replace(/^#?/,"0x");var e=parseInt(t),i=e>>16,n=(65280&e)>>8,o=255&e;return cc.color(i,n,o)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},e.exports=cc.Color},{"../platform/CCClass":104,"../platform/js":116,"./CCValueType":138}],132:[function(t,e,i){cc.Enum=function(t){var e={};Object.defineProperty(e,"__enums__",{value:void 0,writable:!0});var i=-1;for(var n in t){var o=t[n];-1===o?o=++i:i=o,e[n]=o;var r=""+o;if(n!==r){if(e.hasOwnProperty(r),!1){cc.error("%s already defined in Enum.",r);continue}Object.defineProperty(e,r,{value:n})}}return e},cc.Enum.isEnum=function(t){return t&&t.hasOwnProperty("__enums__")},cc.Enum.getList=function(t){if(void 0!==t.__enums__)return t.__enums__;var e=[];for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o="number"==typeof n&&(0|n)===n;o&&e.push({name:i,value:n})}return e.sort(function(t,e){return t.value-e.value}),t.__enums__=e,e};e.exports=cc.Enum},{}],133:[function(t,e,i){var n=parseFloat("1.192092896e-07F");cc.pNeg=function(t){return cc.p(-t.x,-t.y)},cc.pAdd=function(t,e){return cc.p(t.x+e.x,t.y+e.y)},cc.pSub=function(t,e){return cc.p(t.x-e.x,t.y-e.y)},cc.pMult=function(t,e){return cc.p(t.x*e,t.y*e)},cc.pMidpoint=function(t,e){return cc.pMult(cc.pAdd(t,e),.5)},cc.pDot=function(t,e){return t.x*e.x+t.y*e.y},cc.pCross=function(t,e){return t.x*e.y-t.y*e.x},cc.pPerp=function(t){return cc.p(-t.y,t.x)},cc.pRPerp=function(t){return cc.p(t.y,-t.x)},cc.pProject=function(t,e){return cc.pMult(e,cc.pDot(t,e)/cc.pDot(e,e))},cc.pLengthSQ=function(t){return cc.pDot(t,t)},cc.pDistanceSQ=function(t,e){return cc.pLengthSQ(cc.pSub(t,e))},cc.pLength=function(t){return Math.sqrt(cc.pLengthSQ(t))},cc.pDistance=function(t,e){return cc.pLength(cc.pSub(t,e))},cc.pNormalize=function(t){var e=cc.pLength(t);return 0===e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return cc.p(Math.cos(t),Math.sin(t))},cc.pToAngle=function(t){return Math.atan2(t.y,t.x)},cc.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return e>t?e:i>t?t:i},cc.clamp01=function(t){return 0>t?0:1>t?t:1},cc.pClamp=function(t,e,i){return cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pFromSize=function(t){return cc.p(t.width,t.height)},cc.pCompOp=function(t,e){return cc.p(e(t.x),e(t.y))},cc.pLerp=function(t,e,i){return cc.pAdd(cc.pMult(t,1-i),cc.pMult(e,i))},cc.pFuzzyEqual=function(t,e,i){return t.x-i<=e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i;
},cc.pCompMult=function(t,e){return cc.p(t.x*e.x,t.y*e.y)},cc.pAngleSigned=function(t,e){var i=cc.pNormalize(t),o=cc.pNormalize(e),r=Math.atan2(i.x*o.y-i.y*o.x,cc.pDot(i,o));return Math.abs(r)<n?0:r},cc.pAngle=function(t,e){var i=Math.acos(cc.pDot(cc.pNormalize(t),cc.pNormalize(e)));return Math.abs(i)<n?0:i},cc.pRotateByAngle=function(t,e,i){var n=cc.pSub(t,e),o=Math.cos(i),r=Math.sin(i),s=n.x;return n.x=s*o-n.y*r+e.x,n.y=s*r+n.y*o+e.y,n},cc.pLineIntersect=function(t,e,i,n,o){if(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y)return!1;var r=e.x-t.x,s=e.y-t.y,c=n.x-i.x,a=n.y-i.y,h=t.x-i.x,l=t.y-i.y,u=a*r-c*s;return o.x=c*l-a*h,o.y=r*l-s*h,0===u?0===o.x||0===o.y:(o.x=o.x/u,o.y=o.y/u,!0)},cc.pSegmentIntersect=function(t,e,i,n){var o=cc.p(0,0);return!!(cc.pLineIntersect(t,e,i,n,o)&&o.x>=0&&o.x<=1&&o.y>=0&&o.y<=1)},cc.pIntersectPoint=function(t,e,i,n){var o=cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,o)){var r=cc.p(0,0);return r.x=t.x+o.x*(e.x-t.x),r.y=t.y+o.x*(e.y-t.y),r}return cc.p(0,0)},cc.pSameAs=function(t,e){return null!=t&&null!=e?t.x===e.x&&t.y===e.y:!1},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){cc.pMultIn(t,1/Math.sqrt(t.x*t.x+t.y*t.y))}},{}],134:[function(t,e,i){function n(t,e,i,n){t&&"object"==typeof t&&(e=t.y,i=t.width,n=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0}var o=t("./CCValueType"),r=t("../platform/js");r.extend(n,o),t("../platform/CCClass").fastDefine("cc.Rect",n,{x:0,y:0,width:0,height:0}),n.fromMinMax=function(t,e){var i=Math.min(t.x,e.x),o=Math.min(t.y,e.y),r=Math.max(t.x,e.x),s=Math.max(t.y,e.y);return new n(i,o,r-i,s-o)},n.contain=function(t,e){return t.x<e.x&&t.x+t.width>e.x+e.width&&t.y<e.y&&t.y+t.height>e.y+e.height?1:e.x<t.x&&e.x+e.width>t.x+t.width&&e.y<t.y&&e.y+e.height>t.y+t.height?-1:0};var s=n.prototype;s.clone=function(){return new n(this.x,this.y,this.width,this.height)},s.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},s.lerp=function(t,e,i){i=i||new n;var o=this.x,r=this.y,s=this.width,c=this.height;return i.x=o+(t.x-o)*e,i.y=r+(t.y-r)*e,i.width=s+(t.width-s)*e,i.height=c+(t.height-c)*e,i},s.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},Object.defineProperty(s,"xMin",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}}),Object.defineProperty(s,"yMin",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}}),Object.defineProperty(s,"xMax",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x}}),Object.defineProperty(s,"yMax",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y}}),Object.defineProperty(s,"center",{get:function(){return new cc.Vec2(this.x+.5*this.width,this.y+.5*this.height)},set:function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height}}),Object.defineProperty(s,"size",{get:function(){return new cc.Size(this.width,this.height)},set:function(t){this.width=t.width,this.height=t.height}}),s.intersects=function(t){return cc.rectIntersectsRect(this,t)},s.contains=function(t){return this.x<t.x&&this.x+this.width>t.x&&this.y<t.y&&this.y+this.height>t.y},s.containsRect=function(t){return this.x<t.x&&this.x+this.width>t.x+t.width&&this.y<t.y&&this.y+this.height>t.y+t.height},cc.Rect=n,cc.rect=function(t,e,i,o){return new n(t,e,i,o)},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){return t&&e?!(t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height):!1},cc.rectGetMaxX=function(t){return t.x+t.width},cc.rectGetMidX=function(t){return t.x+t.width/2},cc.rectGetMinX=function(t){return t.x},cc.rectGetMaxY=function(t){return t.y+t.height},cc.rectGetMidY=function(t){return t.y+t.height/2},cc.rectGetMinY=function(t){return t.y},cc.rectContainsPoint=function(t,e){return e.x>=cc.rectGetMinX(t)&&e.x<=cc.rectGetMaxX(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectGetMaxY(t)},cc.rectIntersectsRect=function(t,e){var i=t.x+t.width,n=t.y+t.height,o=e.x+e.width,r=e.y+e.height;return!(i<e.x||o<t.x||n<e.y||r<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var i=cc.rect(0,0,0,0);return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var i=cc.rect(Math.max(cc.rectGetMinX(t),cc.rectGetMinX(e)),Math.max(cc.rectGetMinY(t),cc.rectGetMinY(e)),0,0);return i.width=Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},e.exports=cc.Rect},{"../platform/CCClass":104,"../platform/js":116,"./CCValueType":138}],135:[function(t,e,i){function n(t,e){t&&"object"==typeof t&&(e=t.height,t=t.width),this.width=t||0,this.height=e||0}var o=t("./CCValueType"),r=t("../platform/js");r.extend(n,o),t("../platform/CCClass").fastDefine("cc.Size",n,{width:0,height:0}),r.get(n,"ZERO",function(){return new n(0,0)});var s=n.prototype;s.clone=function(){return new n(this.width,this.height)},s.equals=function(t){return t&&this.width===t.width&&this.height===t.height},s.lerp=function(t,e,i){i=i||new n;var o=this.width,r=this.height;return i.width=o+(t.width-o)*e,i.height=r+(t.height-r)*e,i},s.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},cc.size=function(t,e){return new n(t,e)},cc.sizeEqualToSize=function(t,e){return t&&e&&t.width===e.width&&t.height===e.height},cc.Size=e.exports=n},{"../platform/CCClass":104,"../platform/js":116,"./CCValueType":138}],136:[function(t,e,i){cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.BlendFunc=function(t,e){this.src=t,this.dst=e};var n=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775});cc.BlendFunc._disable=function(){return new cc.BlendFunc(n.ONE,n.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(n.SRC_ALPHA,n.ONE)},cc.BlendFunc.BlendFactor=n,cc.BlendFunc.DISABLE,cc.js.get(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.js.get(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive),cc.blendFuncDisable=cc.BlendFunc._disable,cc.FontDefinition=function(t){var e=this;if(e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TextAlignment.CENTER,e.verticalAlign=cc.VerticalTextAlignment.TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.lineHeight="normal",e.fontStyle="normal",e.fontWeight="normal",e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1,t&&t instanceof Object)for(var i in t)e[i]=t[i]},cc.FontDefinition.prototype._getCanvasFontStr=function(){var t=this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px";return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+t+" '"+this.fontName+"'"},cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),cc._Dictionary=cc.Class({ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return this.__currId++,"key_"+this.__currId},setObject:function(t,e){if(null!=e){var i=this.__getKey();this._keyMapTb[i]=e,this._valueMapTb[i]=t}},objectForKey:function(t){if(null==t)return null;var e=this._keyMapTb;for(var i in e)if(e[i]===t)return this._valueMapTb[i];return null},valueForKey:function(t){return this.objectForKey(t)},removeObjectForKey:function(t){if(null!=t){var e=this._keyMapTb;for(var i in e)if(e[i]===t)return delete this._valueMapTb[i],void delete e[i]}},removeObjectsForKeys:function(t){if(null!=t)for(var e=0;e<t.length;e++)this.removeObjectForKey(t[e])},allKeys:function(){var t=[],e=this._keyMapTb;for(var i in e)t.push(e[i]);return t},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}})},{}],137:[function(t,e,i){cc.WebGLColor=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.WebGLColor.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset;this._view=new Uint8Array(s,c,4),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0,"number"==typeof n?this._view[3]=n:(this._view[3]=255,this.a_undefined=!0)},cc.WebGLColor.BYTES_PER_ELEMENT=4;var n=cc.WebGLColor.prototype;n._getR=function(){return this._view[0]},n._setR=function(t){this._view[0]=0>t?0:t},n._getG=function(){return this._view[1]},n._setG=function(t){this._view[1]=0>t?0:t},n._getB=function(){return this._view[2]},n._setB=function(t){this._view[2]=0>t?0:t},n._getA=function(){return this._view[3]},n._setA=function(t){this._view[3]=0>t?0:t},n.r,cc.js.getset(n,"r",n._getR,n._setR),n.g,cc.js.getset(n,"g",n._getG,n._setG),n.b,cc.js.getset(n,"b",n._getB,n._setB),n.a,cc.js.getset(n,"a",n._getA,n._setA),cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8;var n=cc.Vertex2F.prototype;n._getX=function(){return this._view[0]},n._setX=function(t){this._view[0]=t},n._getY=function(){return this._view[1]},n._setY=function(t){this._view[1]=t},cc.js.getset(n,"x",n._getX,n._setX),cc.js.getset(n,"y",n._getY,n._setY),cc.Vertex3F=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset;this._view=new Float32Array(r,s,3),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,n=cc.Vertex3F.prototype,n._getX=function(){return this._view[0]},n._setX=function(t){this._view[0]=t},n._getY=function(){return this._view[1]},n._setY=function(t){this._view[1]=t},n._getZ=function(){return this._view[2]},n._setZ=function(t){this._view[2]=t},cc.js.getset(n,"x",n._getX,n._setX),cc.js.getset(n,"y",n._getY,n._setY),cc.js.getset(n,"z",n._getZ,n._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Tex2F.BYTES_PER_ELEMENT=8,n=cc.Tex2F.prototype,n._getU=function(){return this._view[0]},n._setU=function(t){this._view[0]=t},n._getV=function(){return this._view[1]},n._setV=function(t){this._view[1]=t},cc.js.getset(n,"u",n._getU,n._setU),cc.js.getset(n,"v",n._getV,n._setV),cc.Quad2=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset,a=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=t?new cc.Vertex2F(t.x,t.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._tr=e?new cc.Vertex2F(e.x,e.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._bl=i?new cc.Vertex2F(i.x,i.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._br=n?new cc.Vertex2F(n.x,n.y,s,c):new cc.Vertex2F(0,0,s,c)},cc.Quad2.BYTES_PER_ELEMENT=32,n=cc.Quad2.prototype,n._getTL=function(){return this._tl},n._setTL=function(t){this._tl._view[0]=t.x,this._tl._view[1]=t.y},n._getTR=function(){return this._tr},n._setTR=function(t){this._tr._view[0]=t.x,this._tr._view[1]=t.y},n._getBL=function(){return this._bl},n._setBL=function(t){this._bl._view[0]=t.x,this._bl._view[1]=t.y},n._getBR=function(){return this._br},n._setBR=function(t){this._br._view[0]=t.x,this._br._view[1]=t.y},cc.js.getset(n,"tl",n._getTL,n._setTL),cc.js.getset(n,"tr",n._getTR,n._setTR),cc.js.getset(n,"bl",n._getBL,n._setBL),cc.js.getset(n,"br",n._getBR,n._setBR),cc.Quad3=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset,a=cc.Vertex3F.BYTES_PER_ELEMENT;this.bl=bl?new cc.Vertex3F(bl.x,bl.y,bl.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.br=br?new cc.Vertex3F(br.x,br.y,br.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.tl=tl?new cc.Vertex3F(tl.x,tl.y,tl.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.tr=tr?new cc.Vertex3F(tr.x,tr.y,tr.z,s,c):new cc.Vertex3F(0,0,0,s,c)},cc.Quad3.BYTES_PER_ELEMENT=48,cc.V3F_C4B_T2F=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex3F(t.x,t.y,t.z,r,s):new cc.Vertex3F(0,0,0,r,s),s+=cc.Vertex3F.BYTES_PER_ELEMENT,this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,r,s):new cc.WebGLColor(0,0,0,0,r,s),s+=cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,r,s):new cc.Tex2F(0,0,r,s)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,n=cc.V3F_C4B_T2F.prototype,n._getVertices=function(){return this._vertices},n._setVertices=function(t){var e=this._vertices;e._view[0]=t.x,e._view[1]=t.y,e._view[2]=t.z},n._getColor=function(){return this._colors},n._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},n._getTexCoords=function(){return this._texCoords},n._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(n,"vertices",n._getVertices,n._setVertices),cc.js.getset(n,"colors",n._getColor,n._setColor),cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,o,r){this._arrayBuffer=o||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=r||0;var s=this._arrayBuffer,c=this._offset,a=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._bl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,n=cc.V3F_C4B_T2F_Quad.prototype,n._getTL=function(){return this._tl},n._setTL=function(t){var e=this._tl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getBL=function(){return this._bl},n._setBL=function(t){var e=this._bl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getTR=function(){return this._tr},n._setTR=function(t){var e=this._tr;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getBR=function(){return this._br},n._setBR=function(t){var e=this._br;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getArrayBuffer=function(){return this._arrayBuffer},cc.js.getset(n,"tl",n._getTL,n._setTL),cc.js.getset(n,"tr",n._getTR,n._setTR),cc.js.getset(n,"bl",n._getBL,n._setBL),cc.js.getset(n,"br",n._getBR,n._setBR),cc.js.get(n,"arrayBuffer",n._getArrayBuffer),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(t){if(!t)return cc.V3F_C4B_T2F_QuadZero();var e=t.tl,i=t.bl,n=t.tr,o=t.br;return{tl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:o.vertices.x,y:o.vertices.y,z:o.vertices.z},colors:{r:o.colors.r,g:o.colors.g,b:o.colors.b,a:o.colors.a},texCoords:{u:o.texCoords.u,v:o.texCoords.v}}}},cc.V3F_C4B_T2F_QuadsCopy=function(t){if(!t)return[];for(var e=[],i=0;i<t.length;i++)e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));return e},cc.V2F_C4B_T2F=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex2F(t.x,t.y,r,s):new cc.Vertex2F(0,0,r,s),s+=cc.Vertex2F.BYTES_PER_ELEMENT,this._colors=e?new cc.WebGLColor(e.r,e.g,e.b,e.a,r,s):new cc.WebGLColor(0,0,0,0,r,s),s+=cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,r,s):new cc.Tex2F(0,0,r,s)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,n=cc.V2F_C4B_T2F.prototype,n._getVertices=function(){return this._vertices},n._setVertices=function(t){this._vertices._view[0]=t.x,this._vertices._view[1]=t.y},n._getColor=function(){return this._colors},n._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},n._getTexCoords=function(){return this._texCoords},n._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(n,"vertices",n._getVertices,n._setVertices),cc.js.getset(n,"colors",n._getColor,n._setColor),cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V2F_C4B_T2F_Triangle=function(t,e,i,n,o){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=o||0;var r=this._arrayBuffer,s=this._offset,c=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,r,s):new cc.V2F_C4B_T2F(null,null,null,r,s),s+=c,this._b=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,r,s):new cc.V2F_C4B_T2F(null,null,null,r,s),s+=c,this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,r,s):new cc.V2F_C4B_T2F(null,null,null,r,s)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,n=cc.V2F_C4B_T2F_Triangle.prototype,n._getA=function(){return this._a},n._setA=function(t){var e=this._a;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getB=function(){return this._b},n._setB=function(t){var e=this._b;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},n._getC=function(){return this._c},n._setC=function(t){var e=this._c;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},cc.js.getset(n,"a",n._getA,n._setA),cc.js.getset(n,"b",n._getB,n._setB),cc.js.getset(n,"c",n._getC,n._setC)},{}],138:[function(t,e,i){function n(){}var o=t("../platform/js");o.setClassName("cc.ValueType",n),o.mixin(n.prototype,{clone:!1,equals:!1,toString:function(){return""+{}},lerp:!1}),cc.ValueType=n,e.exports=n},{"../platform/js":116}],139:[function(t,e,i){function n(t,e){t&&"object"==typeof t&&(e=t.y,t=t.x),this.x=t||0,this.y=e||0}var o=t("./CCValueType"),r=t("../platform/js"),s=t("../platform/CCClass");r.extend(n,o),s.fastDefine("cc.Vec2",n,{x:0,y:0}),r.mixin(n.prototype,{clone:function(){return new n(this.x,this.y)},set:function(t){return this.x=t.x,this.y=t.y,this},equals:function(t){return t&&this.x===t.x&&this.y===t.y},toString:function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},lerp:function(t,e,i){i=i||new n;var o=this.x,r=this.y;return i.x=o+(t.x-o)*e,i.y=r+(t.y-r)*e,i},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},add:function(t,e){return e=e||new n,e.x=this.x+t.x,e.y=this.y+t.y,e},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},sub:function(t,e){return e=e||new n,e.x=this.x-t.x,e.y=this.y-t.y,e},mulSelf:function(t){return this.x*=t,this.y*=t,this},mul:function(t,e){return e=e||new n,e.x=this.x*t,e.y=this.y*t,e},scaleSelf:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t,e){return e=e||new n,e.x=this.x*t.x,e.y=this.y*t.y,e},divSelf:function(t){return this.x/=t,this.y/=t,this},div:function(t,e){return e=e||new n,e.x=this.x/t,e.y=this.y/t,e},negSelf:function(){return this.x=-this.x,this.y=-this.y,this},neg:function(t){return t=t||new n,t.x=-this.x,t.y=-this.y,t},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.y*t.x-this.x*t.y},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magSqr:function(){return this.x*this.x+this.y*this.y},normalizeSelf:function(){var t=this.x*this.x+this.y*this.y;if(1===t)return this;if(0===t)return console.warn("Can't normalize zero vector"),this;var e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this},normalize:function(t){return t=t||new n,t.x=this.x,t.y=this.y,t.normalizeSelf(),t},angle:function(t){var e=this.magSqr(),i=t.magSqr();if(0===e||0===i)return console.warn("Can't get angle between zero vector"),0;var n=this.dot(t),o=n/Math.sqrt(e*i);return o=cc.clampf(o,-1,1),Math.acos(o)},signAngle:function(t){return Math.atan2(this.y,this.x)-Math.atan2(t.y,t.x)},rotate:function(t,e){return e=e||new n,e.x=this.x,e.y=this.y,e.rotateSelf(t)},rotateSelf:function(t){var e=Math.sin(t),i=Math.cos(t),n=this.x;return this.x=i*n-e*this.y,this.y=e*n+i*this.y,this}}),r.get(n,"ONE",function(){return new n(1,1)}),r.get(n,"ZERO",function(){return new n(0,0)}),r.get(n,"UP",function(){return new n(0,1)}),r.get(n,"RIGHT",function(){return new n(1,0)}),cc.Vec2=n,cc.v2=function(t,e){return new n(t,e)},cc.p=cc.v2,cc.pointEqualToPoint=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y},e.exports=cc.Vec2},{"../platform/CCClass":104,"../platform/js":116,"./CCValueType":138}],140:[function(t,e,i){t("./CCValueType"),t("./CCEnum"),t("./CCVec2"),t("./CCPointExtension"),t("./CCSize"),t("./CCRect"),t("./CCColor"),t("./CCTypes"),t("./CCAffineTransform"),t("./CCTypesWebGL")},{"./CCAffineTransform":130,"./CCColor":131,"./CCEnum":132,"./CCPointExtension":133,"./CCRect":134,"./CCSize":135,"./CCTypes":136,"./CCTypesWebGL":137,"./CCValueType":138,"./CCVec2":139}],141:[function(require,module,exports){function deprecateEnum(obj,oldPath,newPath,hasTypePrefixBefore){hasTypePrefixBefore=hasTypePrefixBefore!==!1;for(var enumDef=eval(newPath),entries=cc.Enum.getList(enumDef),delimiter=hasTypePrefixBefore?"_":".",i=0;i<entries.length;i++){var entry=entries[i].name,oldPropName;if(hasTypePrefixBefore){var oldTypeName=oldPath.split(".").slice(-1)[0];oldPropName=oldTypeName+"_"+entry}else oldPropName=entry;js.get(obj,oldPropName,function(t){return cc.warn(INFO,oldPath+delimiter+t,newPath+"."+t),enumDef[t]}.bind(null,entry))}}function markAsRemoved(t,e,i){i=i||js.getClassName(t),e.forEach(function(e){function n(){cc.error("Sorry, %s.%s is removed.",i,e)}js.getset(t.prototype,e,n,n)})}function provideClearError(t,e,i){function n(e,i){function n(t){cc.error(r,e,t)}Array.isArray(i)||(i=i.split(",").map(function(t){return t.trim()})),js.getset(t,e,n.bind(null,i[0]),i[1]&&n.bind(null,i[1]))}var o=i||cc.js.getClassName(t),r="Sorry, "+o+".%s is removed, please use %s instead.";for(var s in e){var c=e[s];if("*"===s[0]){var a=s.slice(1);n("g"+a,c),n("s"+a,c)}else s.split(",").map(function(t){return t.trim()}).forEach(function(t){n(t,c)})}}function shouldNotUseNodeProp(t){var e=t.prototype;for(var i in cc.Node.prototype)!function(t){t in e||"_"===t[0]||Object.defineProperty(e,t,{get:function(){var e=cc.js.getClassName(this),i="Sorry, "+e+".%s is undefined, please use cc.Node.%s instead.";cc.error(i,t,t)},enumerable:!1,configurable:!0})}(i)}var js,INFO,ERR},{}],142:[function(t,e,i){var n=cc.Class({name:"cc.MotionStreak","extends":cc.Component,editor:!1,ctor:function(){this._root=null,this._motionStreak=null},properties:{preview:{"default":!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this._motionStreak&&this._motionStreak.setFadeTime(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.fadeTime"},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(t){this._minSeg=t,this._motionStreak&&this._motionStreak.setMinSeg(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.minSeg"},_stroke:64,stroke:{get:function(){return this._stroke},set:function(t){this._stroke=t,this._motionStreak&&this._motionStreak.setStroke(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.stroke"},_texture:{"default":"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._motionStreak&&(cc.js.isString(t)&&(t=cc.textureCache.addImage(t)),this._motionStreak.setTexture(t))},url:cc.Texture2D,animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.texture"},_color:cc.Color.WHITE,color:{get:function(){return this._color},set:function(t){this._color=t,this._motionStreak&&this._motionStreak.tintWithColor(t)},tooltip:"i18n:COMPONENT.motionStreak.color"},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(t){this._fastMode=t,this._motionStreak&&this._motionStreak.setFastMode(t)},animatable:!1,tooltip:"i18n:COMPONENT.motionStreak.fastMode"}},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._motionStreak.reset()},__preload:function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL,!1)return void cc.warn("MotionStreak only support WebGL mode.");this._root=new _ccsg.Node;var t=new _ccsg.MotionStreak;t.initWithFade(this._fadeTime,this._minSeg,this._stroke,this.node.color,this._texture||null),t.setFastMode(this._fastMode),this._root.addChild(t);var e=this.node._sgNode;e&&e.addChild(this._root,-10),this._motionStreak=t},lateUpdate:function(t){if(this._motionStreak){var e=this.node,i=e.getNodeToWorldTransform(),n=i.tx-(e.width/2+e.anchorX*e.width),o=i.ty-(e.height/2+e.anchorY*e.height);this._root.setPosition(-n,-o),this._motionStreak.setPosition(n,o),this._motionStreak.update(t)}}});cc.MotionStreak=e.exports=n},{}],143:[function(t,e,i){var n=cc.Class({name:"cc.ParticleAsset","extends":cc.RawAsset});cc.ParticleAsset=e.exports=n},{}],144:[function(t,e,i){var n=cc.BlendFunc.BlendFactor,o=cc.Enum({GRAVITY:0,RADIUS:1}),r=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),s={preview:{"default":!0,editorOnly:!0,notify:!1,animatable:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,t?this._applyCustoms():this._applyFile())},animatable:!1},_file:{"default":"",url:cc.ParticleAsset},file:{get:function(){return this._file},set:function(t,e){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)},animatable:!1,url:cc.ParticleAsset},_texture:{"default":"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._sgNode.texture=t?cc.textureCache.addImage(t):null,!t&&this._file&&this._applyFile()},url:cc.Texture2D},particleCount:{get:function(){return this._sgNode.particleCount},set:function(t){this._sgNode.particleCount=t},visible:!1},_srcBlendFactor:n.SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n},_dstBlendFactor:n.ONE_MINUS_SRC_ALPHA,dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n},playOnLoad:!0,_autoRemoveOnFinish:!1,autoRemoveOnFinish:{get:function(){return this._autoRemoveOnFinish},set:function(t){this._autoRemoveOnFinish!==t&&(this._autoRemoveOnFinish=t,this._applyAutoRemove())},animatable:!1},active:{get:function(){return this._sgNode?this._sgNode.isActive():!1},visible:!1}},c=function(){for(var t={totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,startColor:cc.Color.WHITE,startColorVar:cc.Color.BLACK,endColor:cc.color(255,255,255,0),endColorVar:cc.color(0,0,0,0),angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.p(0,0),posVar:cc.p(0,0),positionType:r.FREE,emitterMode:o.GRAVITY,gravity:cc.p(0,0),speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},e=Object.keys(t),i=0;i<e.length;++i){var n=e[i];!function(t,e){var i="_"+t;s[i]=e;var n=e.constructor,o=s[t]={};cc.isChildClassOf(n,cc.ValueType)?(o.get=function(){return new n(this[i])},o.type=n):o.get=function(){return this[i]},cc.isChildClassOf(n,cc.ValueType)?o.set=function(e){this[i]=new n(e),this._sgNode[t]=e}:o.set=function(e){this[i]=e,this._sgNode[t]=e}}(n,t[n])}return e}();s.positionType.type=r,s.emitterMode.type=o;var a=cc.Class({name:"cc.ParticleSystem","extends":cc._RendererUnderSG,editor:!1,ctor:function(){this._previewTimer=null,this._focused=!1,this._willStart=!1,this._blendFunc=new cc.BlendFunc(0,0)},properties:s,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:o,PositionType:r},__preload:function(){this._super(),this.playOnLoad&&this.resetSystem(),this._applyAutoRemove()},onDestroy:function(){this._autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._super()},onFocusInEditor:!1,onLostFocusInEditor:!1,_createSgNode:function(){return new _ccsg.ParticleSystem},_initSgNode:function(){var t=this._sgNode;if(this._file)if(this._custom){var e=!this._texture;e?this._applyFile():this._applyCustoms()}else this._applyFile();else this._custom&&this._applyCustoms();t.stopSystem()},addParticle:function(){return this._sgNode.addParticle()},stopSystem:function(){this._sgNode.stopSystem()},resetSystem:function(){this._sgNode.resetSystem()},isFull:function(){return this.particleCount>=this._totalParticles},setDisplayFrame:function(t){if(t){var e=t.getTexture();e&&(this._texture=e.url),this._sgNode.setDisplayFrame(t)}},setTextureWithRect:function(t,e){t instanceof cc.Texture2D&&(this._texture=t.url),this._sgNode.setTextureWithRect(t,e)},_applyFile:function(){var t=this._sgNode,e=this._file;if(e){var i=this;cc.loader.load(e,function(n,o){if(n||!o)throw n||new Error("Unkown error");if(i.isValid){t.particleCount=0;var r=t.isActive();t.initWithFile(e),o.textureUuid&&cc.AssetLibrary.queryAssetInfo(o.textureUuid,function(t,e,n){i.texture=e}),o.emissionRate&&(i.emissionRate=o.emissionRate),t.setPosition(0,0),r||t.stopSystem(),i._applyAutoRemove(),i._custom&&i._applyCustoms()}})}},_applyCustoms:function(){for(var t=this._sgNode,e=t.isActive(),i=0;i<c.length;i++){var n=c[i];t[n]=this["_"+n]}this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc),this._texture&&(t.texture=cc.textureCache.addImage(this._texture)),e||t.stopSystem(),this._applyAutoRemove()},_applyAutoRemove:function(){var t=this._sgNode,e=this._autoRemoveOnFinish;if(t.autoRemoveOnFinish=e,e){cc.assert(!t.onExit);var i=this;t.onExit=function(){_ccsg.Node.prototype.onExit.call(this),i.node.destroy()}}else t.hasOwnProperty("onExit")&&(t.onExit=_ccsg.Node.prototype.onExit)}});cc.ParticleSystem=e.exports=a},{}],145:[function(t,e,i){var n=cc.Class({name:"cc.TiledLayer","extends":cc._SGComponent,onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null)},_initSgNode:function(){var t=this._sgNode;if(t){this.enabledInHierarchy||t.setVisible(!1),this._registSizeProvider();var e=this.node;t.setAnchorPoint(e.getAnchorPoint())}},_replaceSgNode:function(t){t!==this._sgNode&&(this._removeSgNode(),this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),t&&t instanceof _ccsg.TMXLayer?(this._sgNode=t,t.retain(),this._initSgNode()):this._sgNode=null);
},getLayerName:function(){return this._sgNode?this._sgNode.getLayerName():""},setLayerName:function(t){this._sgNode&&this._sgNode.setLayerName(t)},getProperty:function(t){return this._sgNode?this._sgNode.getProperty(t):null},getPositionAt:function(t,e){return this._sgNode?(void 0!==e&&(t=cc.p(t,e)),this._sgNode.getPositionAt(t)):null},removeTileAt:function(t,e){this._sgNode&&(void 0!==e&&(t=cc.p(t,e)),this._sgNode.removeTileAt(t))},setTileGID:function(t,e,i,n){if(this._sgNode){if(void 0===e)throw new Error("_ccsg.TMXLayer.setTileGID(): pos should be non-null");var o;void 0===n&&e instanceof cc.Vec2?(o=e,n=i):o=cc.p(e,i),this._sgNode.setTileGID(t,o,n)}},getTileGIDAt:function(t,e){return this._sgNode?(void 0!==e&&(t=cc.p(t,e)),this._sgNode.getTileGIDAt(t)):0},getTileAt:function(t,e){return this._sgNode?(void 0!==e&&(t=cc.p(t,e)),this._sgNode.getTileAt(t)):null},releaseMap:function(){this._sgNode&&this._sgNode.releaseMap()},setContentSize:function(t,e){this._sgNode&&(void 0!==e&&(t=cc.size(t,e)),this._sgNode.setContentSize(t))},getTexture:function(){return this._sgNode?this._sgNode.getTexture():null},setTexture:function(t){this._sgNode&&this._sgNode.setTexture(t)},setTileOpacity:function(t){this._sgNode&&this._sgNode.setTileOpacity(t)},getLayerSize:function(){return this._sgNode?this._sgNode.getLayerSize():cc.size(0,0)},setLayerSize:function(t){this._sgNode&&this._sgNode.setLayerSize(t)},getMapTileSize:function(){return this._sgNode?this._sgNode.getMapTileSize():cc.size(0,0)},setMapTileSize:function(t){this._sgNode&&this._sgNode.setMapTileSize(t)},getTiles:function(){return this._sgNode?this._sgNode.getTiles():null},setTiles:function(t){this._sgNode&&this._sgNode.setTiles(t)},getTileSet:function(){return this._sgNode?this._sgNode.getTileSet():null},setTileSet:function(t){this._sgNode&&this._sgNode.setTileSet(t)},getLayerOrientation:function(){return this._sgNode?this._sgNode.getLayerOrientation():0},setLayerOrientation:function(t){this._sgNode&&this._sgNode.setLayerOrientation(t)},getProperties:function(){return this._sgNode?this._sgNode.getProperties():null},setProperties:function(t){this._sgNode&&this._sgNode.setProperties(t)},_tryRemoveNode:function(){this.node.removeComponent(cc.TiledLayer),1===this.node._components.length&&0===this.node.getChildren().length&&this.node.removeFromParent()}});cc.TiledLayer=e.exports=n},{}],146:[function(t,e,i){var n=cc.Enum({ORTHO:0,HEX:1,ISO:2}),o=cc.Enum({NONE:0,MAP:1,LAYER:2,OBJECTGROUP:3,OBJECT:4,TILE:5}),r=cc.Enum({HORIZONTAL:2147483648,VERTICAL:1073741824,DIAGONAL:536870912,FLIPPED_ALL:3758096384,FLIPPED_MASK:536870911}),s=cc.Enum({STAGGERAXIS_X:0,STAGGERAXIS_Y:1}),c=cc.Enum({STAGGERINDEX_ODD:0,STAGGERINDEX_EVEN:1}),a=cc.Enum({RECT:0,ELLIPSE:1,POLYGON:2,POLYLINE:3,IMAGE:4}),h=cc.Class({name:"cc.TiledMap","extends":cc._RendererInSG,editor:!1,statics:{Orientation:n,Property:o,TileFlag:r,StaggerAxis:s,StaggerIndex:c,TMXObjectType:a},properties:{_detachedChildren:{"default":[],serializable:!1},_tmxFile:{"default":null,type:cc.TiledMapAsset},tmxAsset:{get:function(){return this._tmxFile},set:function(t,e){this._tmxFile!==t&&(this._tmxFile=t,this._applyFile())},type:cc.TiledMapAsset}},getMapSize:function(){return this._sgNode.getMapSize()},setMapSize:function(t){this._sgNode.setMapSize(t)},getTileSize:function(){return this._sgNode.getTileSize()},setTileSize:function(t){this._sgNode.setTileSize(t)},getMapOrientation:function(){return this._sgNode.getMapOrientation()},setMapOrientation:function(t){this._sgNode.setMapOrientation(t)},getObjectGroups:function(){for(var t=this.node.children,e=[],i=0,n=t.length;n>i;i++){var o=t[i],r=o.getComponent(cc.TiledObjectGroup);r&&e.push(r)}return e},getProperties:function(){return this._sgNode.getProperties()},setProperties:function(t){this._sgNode.setProperties(t)},initWithTMXFile:function(t){cc.error('Method "initWithTMXFile" is no effect now, please set property "tmxAsset" instead.')},initWithXML:function(t,e){cc.error('Method "initWithXML" is no effect now, please set property "tmxAsset" instead.')},allLayers:function(){for(var t=this.node.children,e=[],i=0,n=t.length;n>i;i++){var o=t[i],r=o.getComponent(cc.TiledLayer);r&&e.push(r)}return e},getLayer:function(t){for(var e=this.node.children,i=0,n=e.length;n>i;i++){var o=e[i],r=o.getComponent(cc.TiledLayer);if(r&&r.getLayerName()===t)return r}return null},getObjectGroup:function(t){for(var e=this.node.children,i=0,n=e.length;n>i;i++){var o=e[i],r=o.getComponent(cc.TiledObjectGroup);if(r&&r.getGroupName()===t)return r}return null},getProperty:function(t){return this._sgNode.getProperty(t)},getPropertiesForGID:function(t){return this._sgNode.getPropertiesForGID(t)},onEnable:function(){0===this._detachedChildren.length&&this._moveLayersInSgNode(this._sgNode),this._super(),this._tmxFile&&this._refreshLayerEntities(),this.node.on("anchor-changed",this._anchorChanged,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-reorder",this._syncChildrenOrder,this)},onDisable:function(){this._super(),this._setLayersEnabled(!1);var t=this._plainNode;this._moveLayersInSgNode(t),this.node.off("anchor-changed",this._anchorChanged,this),this.node.off("child-added",this._childAdded,this),this.node.off("child-reorder",this._syncChildrenOrder,this)},onDestroy:function(){this._super(),this._removeLayerEntities()},_createSgNode:function(){return new _ccsg.TMXTiledMap},_initSgNode:function(){this._applyFile()},_resetSgSize:function(){this.node.setContentSize(this._sgNode.getContentSize()),this._sgNode.setContentSize(0,0)},_onMapLoaded:function(){this._refreshLayerEntities(),this._enabled?this._anchorChanged():this._moveLayersInSgNode(this._sgNode),this._setLayersEnabled(this._enabled),this._resetSgSize()},_setLayersEnabled:function(t){for(var e=this.node.getChildren(),i=e.length-1;i>=0;i--){var n=e[i],o=n.getComponent(cc.TiledLayer);o&&(o.enabled=t)}},_moveLayersInSgNode:function(t){this._detachedChildren.length=0;for(var e=t.getChildren(),i=e.length-1;i>=0;i--){var n=e[i];if(n instanceof _ccsg.TMXLayer||n instanceof _ccsg.TMXObjectGroup){t.removeChild(n);var o=n.getLocalZOrder();this._detachedChildren.push({sgNode:n,zorder:o})}}},_removeLayerEntities:function(){for(var t=this.node.getChildren(),e=t.length-1;e>=0;e--){var i=t[e];if(i.isValid){var n=i.getComponent(cc.TiledLayer);n&&n._tryRemoveNode();var o=i.getComponent(cc.TiledObjectGroup);o&&o._tryRemoveNode()}}},_refreshLayerEntities:function(){var t,e,i=this.node.getChildren(),n=[],o=[],r=[];for(t=0;t<this._detachedChildren.length;t++){var s=this._detachedChildren[t];this._sgNode.addChild(s.sgNode,s.zorder,s.zorder)}this._detachedChildren.length=0;var c=this._sgNode.allLayers().map(function(t){return t.getLayerName()}),a=this._sgNode.getObjectGroups().map(function(t){return t.getGroupName()});for(t=i.length-1;t>=0;t--){var h=i[t],l=h.getComponent(cc.TiledLayer),u=h.getComponent(cc.TiledObjectGroup);if(l){var d=l.getLayerName();if(d||(d=h._name),c.indexOf(d)<0)l._tryRemoveNode();else{n.push(h);var p=this._sgNode.getLayer(d);l._replaceSgNode(p),l.enabled=!0}}else if(u){var _=u.getGroupName();if(_||(_=h._name),a.indexOf(_)<0)u._tryRemoveNode();else{o.push(h);var f=this._sgNode.getObjectGroup(_);u._replaceSgNode(f),u.enabled=f.isVisible()}}else r.push({child:h,index:h.getSiblingIndex()})}var g=n.map(function(t){var e=t.getComponent(cc.TiledLayer);return e.getLayerName()});for(t=0,e=c.length;e>t;t++){var v=c[t],m=this._sgNode.getLayer(v),y=g.indexOf(v);if(0>y){var C=this.node.getChildByName(v),T=null;C&&!C.getComponent(cc._SGComponent)?T=C.addComponent(cc.TiledLayer):(C=new cc.Node(v),this.node.addChild(C),T=C.addComponent(cc.TiledLayer)),C&&T||cc.error("Add component TiledLayer into node failed."),T._replaceSgNode(m),C.setSiblingIndex(m.getLocalZOrder()),C.setAnchorPoint(this.node.getAnchorPoint())}else n[y].setSiblingIndex(m.getLocalZOrder())}var b=o.map(function(t){var e=t.getComponent(cc.TiledObjectGroup);return e.getGroupName()});for(t=0,e=a.length;e>t;t++){v=a[t];var E=this._sgNode.getObjectGroup(v);if(y=b.indexOf(v),0>y){C=this.node.getChildByName(v);var S=null;C&&!C.getComponent(cc._SGComponent)?S=C.addComponent(cc.TiledObjectGroup):(C=new cc.Node(v),this.node.addChild(C),S=C.addComponent(cc.TiledObjectGroup)),C&&S||cc.error("Add component TiledLayer into node failed."),S._replaceSgNode(E),C.setSiblingIndex(E.getLocalZOrder()),C.setAnchorPoint(this.node.getAnchorPoint()),S.enabled=E.isVisible()}else o[y].setSiblingIndex(E.getLocalZOrder())}for(t=0,e=r.length;e>t;t++)s=r[t],s.child.setSiblingIndex(s.index);this._syncChildrenOrder()},_anchorChanged:function(){for(var t=this.node.children,e=this.node.getAnchorPoint(),i=0,n=t.length;n>i;i++){var o=t[i],r=o.getComponent(cc.TiledLayer);r&&o.setAnchorPoint(e)}},_childAdded:function(t){var e=t.detail;if(e){var i=e.getComponent(cc.TiledLayer),n=e.getComponent(cc.TiledObjectGroup);if(!i&&!n){var o=this.node.getChildrenCount();e.setSiblingIndex(o),e._sgNode&&e._sgNode.setLocalZOrder(o)}}},_syncChildrenOrder:function(){for(var t=this.node.children,e=0,i=t.length;i>e;e++){var n=t[e],o=n.getComponent(cc.TiledLayer),r=n.getComponent(cc.TiledObjectGroup),s=n.getSiblingIndex();o&&o._sgNode&&o._sgNode.setLocalZOrder(s),r&&r._sgNode&&r._sgNode.setLocalZOrder(s),n._sgNode&&n._sgNode.setLocalZOrder(s)}},_applyFile:function(){var t=this._sgNode,e=this._tmxFile,i=this;if(e){var n=cc.url._rawAssets+e.tmxFolderPath;n=cc.path._setEndWithSep(n,!1);var o=t.initWithXML(e.tmxXmlStr,n);o&&(i._detachedChildren.length=0,i._onMapLoaded())}else{for(var r=t.allLayers(),s=0,c=r.length;c>s;s++)t.removeChild(r[s]);var a=t.getObjectGroups();for(s=0,c=a.length;c>s;s++)t.removeChild(a[s]);this._detachedChildren.length=0,i._removeLayerEntities()}}});cc.TiledMap=e.exports=h,cc.js.obsolete(cc.TiledMap.prototype,"cc.TiledMap.tmxFile","tmxAsset",!0),cc.js.get(cc.TiledMap.prototype,"mapLoaded",function(){return cc.error('Property "mapLoaded" is unused now. Please write the logic to the callback "start".'),[]},!1)},{}],147:[function(t,e,i){var n=cc.Class({name:"cc.TiledMapAsset","extends":cc.Asset,properties:{tmxXmlStr:{"default":""},tmxFolderPath:{"default":""},textures:{"default":[],url:[cc.Texture2D]},tsxFiles:{"default":[],url:[cc.RawAsset]}},statics:{preventDeferredLoadDependents:!0},createNode:!1});cc.TiledMapAsset=n,e.exports=n},{}],148:[function(t,e,i){var n=cc.Class({name:"cc.TiledObjectGroup","extends":cc._SGComponent,onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null)},_initSgNode:function(){var t=this._sgNode;t&&(this._registSizeProvider(),t.setAnchorPoint(this.node.getAnchorPoint()))},_replaceSgNode:function(t){t!==this._sgNode&&(this._removeSgNode(),this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),t&&t instanceof _ccsg.TMXObjectGroup?(this._sgNode=t,t.retain(),this._initSgNode()):this._sgNode=null)},getPositionOffset:function(){return this._sgNode?this._sgNode.getPositionOffset():cc.p(0,0)},setPositionOffset:function(t){this._sgNode&&this._sgNode.setPositionOffset(t)},getProperties:function(){return this._sgNode?this._sgNode.getProperties():null},setProperties:function(t){this._sgNode&&this._sgNode.setProperties(t)},getGroupName:function(){return this._sgNode?this._sgNode.getGroupName():""},setGroupName:function(t){this._sgNode&&this._sgNode.setGroupName(t)},getProperty:function(t){return this._sgNode?this._sgNode.propertyNamed(t):null},getObject:function(t){return this._sgNode?this._sgNode.getObject(t):null},getObjects:function(){return this._sgNode?this._sgNode.getObjects():[]},_tryRemoveNode:function(){this.node.removeComponent(cc.TiledObjectGroup),1===this.node._components.length&&0===this.node.getChildren().length&&this.node.removeFromParent()}});cc.TiledObjectGroup=e.exports=n},{}],149:[function(t,e,i){t("./cocos2d/core"),t("./cocos2d/animation"),t("./cocos2d/particle/CCParticleAsset"),t("./cocos2d/particle/CCParticleSystem"),t("./cocos2d/motion-streak/CCMotionStreak"),t("./cocos2d/tilemap/CCTiledMapAsset"),cc.runtime||(t("./cocos2d/tilemap/CCTiledMap"),t("./cocos2d/tilemap/CCTiledLayer"),t("./cocos2d/tilemap/CCTiledObjectGroup")),t("./extensions/cocostudio/CCStudioComponent"),t("./extensions/spine"),cc.runtime||t("./extensions/dragonbones"),t("./extensions/ccpool/CCNodePool.js"),t("./extensions/ccpool/CCPool.js"),t("./cocos2d/deprecated")},{"./cocos2d/actions":7,"./cocos2d/animation":17,"./cocos2d/core":87,"./cocos2d/deprecated":141,"./cocos2d/motion-streak/CCMotionStreak":142,"./cocos2d/particle/CCParticleAsset":143,"./cocos2d/particle/CCParticleSystem":144,"./cocos2d/tilemap/CCTiledLayer":145,"./cocos2d/tilemap/CCTiledMap":146,"./cocos2d/tilemap/CCTiledMapAsset":147,"./cocos2d/tilemap/CCTiledObjectGroup":148,"./extensions/ccpool/CCNodePool.js":150,"./extensions/ccpool/CCPool.js":151,"./extensions/cocostudio/CCStudioComponent":152,"./extensions/dragonbones":156,"./extensions/spine":159,"./external/chipmunk/chipmunk.js":160}],150:[function(t,e,i){cc.NodePool=function(t){this.poolHandlerComp=t,this._pool=[]},cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return this._pool.length},clear:function(){for(var t=this._pool.length,e=0;t>e;++e)this._pool[e].destroy();this._pool.length=0},put:function(t){if(t&&-1===this._pool.indexOf(t)){t.removeFromParent(!1);var e=this.poolHandlerComp?t.getComponent(this.poolHandlerComp):null;e&&e.unuse&&e.unuse(),this._pool.push(t)}},get:function(){var t=this._pool.length-1;if(0>t)return null;var e=this._pool[t];this._pool.length=t;var i=this.poolHandlerComp?e.getComponent(this.poolHandlerComp):null;return i&&i.reuse&&i.reuse.apply(i,arguments),e}},e.exports=cc.NodePool},{}],151:[function(t,e,i){cc.pool={_pool:{},_releaseCB:function(){this.release()},_autoRelease:function(t){var e=void 0===t._running?!1:!t._running;cc.director.getScheduler().schedule(this._releaseCB,t,0,0,0,e)},putInPool:function(t){var e=cc.js._getClassId(t.constructor);e&&(this._pool[e]||(this._pool[e]=[]),t.retain&&t.retain(),t.unuse&&t.unuse(),this._pool[e].push(t))},hasObject:function(t){var e=cc.js._getClassId(t),i=this._pool[e];return!(!i||0===i.length)},removeObject:function(t){var e=cc.js._getClassId(t.constructor);if(e){var i=this._pool[e];if(i)for(var n=0;n<i.length;n++)t===i[n]&&(t.release&&t.release(),i.splice(n,1))}},getFromPool:function(t){if(this.hasObject(t)){var e=cc.js._getClassId(t),i=this._pool[e],n=Array.prototype.slice.call(arguments);n.shift();var o=i.pop();return o.reuse&&o.reuse.apply(o,n),o.release&&this._autoRelease(o),o}},drainAllPools:function(){for(var t in this._pool)for(var e=0;e<this._pool[t].length;e++){var i=this._pool[t][e];i.release&&i.release()}this._pool={}}}},{}],152:[function(t,e,i){var n=cc.Enum({NONE:0,CHECKBOX:1,TEXT_ATLAS:2,SLIDER_BAR:3,LIST_VIEW:4,PAGE_VIEW:5}),o=cc.Enum({VERTICAL:0,HORIZONTAL:1}),r=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),s=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),c=cc.Class({name:"cc.StudioComponent","extends":cc.Component,editor:!1,properties:!1,statics:{ComponentType:n,ListDirection:o,VerticalAlign:r,HorizontalAlign:s}});cc.StudioComponent=e.exports=c},{}],153:[function(t,e,i){var n=cc.Enum({"default":-1}),o=cc.Enum({"<None>":0});dragonBones.ArmatureDisplay=cc.Class({name:"dragonBones.ArmatureDisplay","extends":cc._RendererUnderSG,editor:!1,properties:{_factory:{"default":null,type:dragonBones.CCFactory,serializable:!1},_dragonBonesData:{"default":null,type:dragonBones.DragonBonesData,serializable:!1},dragonAsset:{"default":null,type:dragonBones.DragonBonesAsset,notify:function(){this._parseDragonAsset(),this._refresh(),this._defaultArmatureIndex=0,this._animationIndex=0},tooltip:"i18n:COMPONENT.dragon_bones.dragon_bones_asset"},dragonAtlasAsset:{"default":null,type:dragonBones.DragonBonesAtlasAsset,notify:function(){this._parseDragonAtlasAsset(),this._refreshSgNode()},tooltip:"i18n:COMPONENT.dragon_bones.dragon_bones_atlas_asset"},_armatureName:"",armatureName:{get:function(){return this._armatureName},set:function(t){this._armatureName=t;var e=this.getAnimationNames(this._armatureName);this.animationName=e[0],this._refresh()},visible:!1},_animationName:"",animationName:{get:function(){return this._animationName},set:function(t){this._animationName=t},visible:!1},_defaultArmatureIndex:{"default":0,notify:function(){var t="";if(this.dragonAsset){var e;if(this.dragonAsset&&(e=this.dragonAsset.getArmatureEnum()),!e)return cc.error('Failed to set _defaultArmatureIndex for "%s" because its dragonAsset is invalid.',this.name);t=e[this._defaultArmatureIndex]}void 0!==t?this.armatureName=t:cc.error('Failed to set _defaultArmatureIndex for "%s" because the index is out of range.',this.name)},type:n,visible:!0,editorOnly:!0,displayName:"Armature",tooltip:"i18n:COMPONENT.dragon_bones.armature_name"},_animationIndex:{"default":0,notify:function(){if(0===this._animationIndex)return void(this.animationName="");var t;if(this.dragonAsset&&(t=this.dragonAsset.getAnimsEnum(this.armatureName)),t){var e=t[this._animationIndex];void 0!==e?this.animationName=e:cc.error('Failed to set _animationIndex for "%s" because the index is out of range.',this.name)}},type:o,visible:!0,editorOnly:!0,displayName:"Animation",tooltip:"i18n:COMPONENT.dragon_bones.animation_name"},timeScale:{"default":1,notify:function(){this._sgNode&&(this._sgNode.animation().timeScale=this.timeScale)},tooltip:"i18n:COMPONENT.dragon_bones.time_scale"},playTimes:{"default":-1,tooltip:"i18n:COMPONENT.dragon_bones.play_times"},debugBones:{"default":!1,notify:function(){this._sgNode&&this._sgNode.setDebugBones(this.debugBones)},editorOnly:!0,tooltip:"i18n:COMPONENT.dragon_bones.debug_bones"}},ctor:function(){this._factory=new dragonBones.CCFactory},__preload:function(){this._parseDragonAsset(),this._parseDragonAtlasAsset(),this._refresh()},_createSgNode:function(){return this.dragonAsset&&this.dragonAtlasAsset&&this.armatureName?this._factory.buildArmatureDisplay(this.armatureName):null},_initSgNode:function(){var t=this._sgNode;t.animation().timeScale=this.timeScale,this.animationName&&this.playAnimation(this.animationName,this.playTimes)},_parseDragonAsset:function(){if(this.dragonAsset){this._dragonBonesData=this._factory.parseDragonBonesData(this.dragonAsset.dragonBonesJson)}},_parseDragonAtlasAsset:function(){if(this.dragonAtlasAsset){this._factory.parseTextureAtlasData(this.dragonAtlasAsset.atlasJson,this.dragonAtlasAsset.texture)}},_refreshSgNode:function(){var t=this;t._sgNode&&(t.node._sizeProvider===t._sgNode&&(t.node._sizeProvider=null),t._removeSgNode(),t._sgNode=null);var e=t._sgNode=t._createSgNode();e&&(e.retain(),t.enabledInHierarchy||e.setVisible(!1),t._initSgNode(),t._appendSgNode(e),t._registSizeProvider())},_refresh:function(){this._refreshSgNode()},_updateAnimEnum:!1,_updateArmatureEnum:!1,playAnimation:function(t,e){return this._sgNode?(this.animationName=t,this._sgNode.animation().play(t,e)):null},getArmatureNames:function(){return this._dragonBonesData?this._dragonBonesData.armatureNames:[]},getAnimationNames:function(t){var e=[];if(this._dragonBonesData){var i=this._dragonBonesData.getArmature(t);if(i)for(var n in i.animations)i.animations.hasOwnProperty(n)&&e.push(n)}return e},addEventListener:function(t,e,i){this._sgNode&&this._sgNode.addEvent(t,e,i)},removeEventListener:function(t,e,i){this._sgNode&&this._sgNode.removeEvent(t,e,i)},buildArmature:function(t){return this._factory?this._factory.buildArmature(t):null},armature:function(){return this._sgNode?this._sgNode.armature():null}})},{}],154:[function(t,e,i){var n=cc.Class({name:"dragonBones.DragonBonesAsset","extends":cc.Asset,properties:{_dragonBonesJson:"",dragonBonesJson:{get:function(){return this._dragonBonesJson},set:function(t){this._dragonBonesJson=t,this.reset()}}},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){},getRuntimeData:!1,getArmatureEnum:!1,getAnimsEnum:!1});dragonBones.DragonBonesAsset=e.exports=n},{}],155:[function(t,e,i){var n=cc.Class({name:"dragonBones.DragonBonesAtlasAsset","extends":cc.Asset,properties:{_atlasJson:"",atlasJson:{get:function(){return this._atlasJson},set:function(t){this._atlasJson=t}},texture:{"default":"",url:cc.Texture2D}},statics:{preventDeferredLoadDependents:!0},createNode:!1});dragonBones.DragonBonesAtlasAsset=e.exports=n},{}],156:[function(t,e,i){dragonBones=dragonBones,dragonBones.DisplayType={Image:0,Armature:1,Mesh:2},dragonBones.ArmatureType={Armature:0,MovieClip:1,Stage:2},dragonBones.ExtensionType={FFD:0,AdjustColor:10,BevelFilter:11,BlurFilter:12,DropShadowFilter:13,GlowFilter:14,GradientBevelFilter:15,GradientGlowFilter:16},dragonBones.EventType={Frame:0,Sound:1},dragonBones.ActionType={Play:0,Stop:1,GotoAndPlay:2,GotoAndStop:3,FadeIn:4,FadeOut:5},dragonBones.AnimationFadeOutMode={None:0,SameLayer:1,SameGroup:2,SameLayerAndGroup:3,All:4},t("./DragonBonesAsset"),t("./DragonBonesAtlasAsset"),t("./ArmatureDisplay")},{"./ArmatureDisplay":153,"./CCArmatureDisplay":184,"./CCFactory":184,"./CCSlot":184,"./CCTextureData":184,"./DragonBonesAsset":154,"./DragonBonesAtlasAsset":155,"./lib/dragonBones":184}],157:[function(t,e,i){var n=cc.Enum({"default":-1}),o=cc.Enum({"<None>":0});sp.Skeleton=cc.Class({name:"sp.Skeleton","extends":cc._RendererUnderSG,editor:!1,properties:{_paused:!1,paused:{get:function(){return this._paused},set:function(t){this._paused=t,this._sgNode&&(t?this._sgNode.pause():this._sgNode.resume())},visible:!1},skeletonData:{"default":null,type:sp.SkeletonData,notify:function(){this.defaultSkin="",this.defaultAnimation="",this._refresh()},tooltip:"i18n:COMPONENT.skeleton.skeleton_data"},defaultSkin:{"default":"",visible:!1},defaultAnimation:{"default":"",visible:!1},animation:{get:function(){var t=this.getCurrent(0);return t&&t.animation.name||""},set:function(t){this.defaultAnimation=t,t?this.setAnimation(0,t,this.loop):(this.clearTrack(0),this.setToSetupPose())},visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData&&this.defaultSkin){var t=this.skeletonData.getSkinsEnum();if(t){var e=t[this.defaultSkin];if(void 0!==e)return e}}return 0},set:function(t){var e;if(this.skeletonData&&(e=this.skeletonData.getSkinsEnum()),!e)return cc.error('Failed to set _defaultSkinIndex for "%s" because its skeletonData is invalid.',this.name);var i=e[t];void 0!==i?this.defaultSkin=i:cc.error('Failed to set _defaultSkinIndex for "%s" because the index is out of range.',this.name)},type:n,visible:!0,displayName:"Default Skin",tooltip:"i18n:COMPONENT.skeleton.default_skin"},_animationIndex:{get:function(){var t=this.animation;if(this.skeletonData&&t){var e=this.skeletonData.getAnimsEnum();if(e){var i=e[t];if(void 0!==i)return i}}return 0},set:function(t){if(0===t)return void(this.animation="");var e;if(this.skeletonData&&(e=this.skeletonData.getAnimsEnum()),!e)return cc.error('Failed to set _animationIndex for "%s" because its skeletonData is invalid.',this.name);var i=e[t];void 0!==i?this.animation=i:cc.error('Failed to set _animationIndex for "%s" because the index is out of range.',this.name)},type:o,visible:!0,displayName:"Animation",tooltip:"i18n:COMPONENT.skeleton.animation"},loop:{"default":!0,tooltip:"i18n:COMPONENT.skeleton.loop"},_premultipliedAlpha:!0,premultipliedAlpha:{get:function(){return this._premultipliedAlpha},set:function(t){this._premultipliedAlpha=t,this._sgNode&&this._sgNode.setPremultipliedAlpha(t)},tooltip:"i18n:COMPONENT.skeleton.premultipliedAlpha"},timeScale:{"default":1,notify:function(){this._sgNode&&this._sgNode.setTimeScale(this.timeScale)},tooltip:"i18n:COMPONENT.skeleton.time_scale"},debugSlots:{"default":!1,notify:function(){this._sgNode&&this._sgNode.setDebugSlotsEnabled(this.debugSlots)},editorOnly:!0,tooltip:"i18n:COMPONENT.skeleton.debug_slots"},debugBones:{"default":!1,notify:function(){this._sgNode&&this._sgNode.setDebugBonesEnabled(this.debugBones)},editorOnly:!0,tooltip:"i18n:COMPONENT.skeleton.debug_bones"}},__preload:function(){this.node.setContentSize(0,0),this._refresh()},_createSgNode:function(){if(this.skeletonData){var t=this.skeletonData._uuid;if(!t)return cc.error("Can not render dynamic created SkeletonData"),null;var e=this.skeletonData.rawUrl,i=this.skeletonData.atlasUrl;if(i)return"string"!=typeof i?(cc.error("Invalid type of atlasFile, atlas should be registered as raw asset."),null):new sp._SGSkeletonAnimation(e,i,this.skeletonData.scale)}return null},_initSgNode:function(){var t=this._sgNode;t.setTimeScale(this.timeScale);var e=this;if(t.onEnter=function(){_ccsg.Node.prototype.onEnter.call(this),e._paused&&this.pause()},this.defaultSkin)try{t.setSkin(this.defaultSkin)}catch(i){cc._throw(i)}t.setPremultipliedAlpha(this._premultipliedAlpha),this.animation=this.defaultAnimation},_getLocalBounds:!1,updateWorldTransform:function(){this._sgNode&&this._sgNode.updateWorldTransform()},setToSetupPose:function(){this._sgNode&&this._sgNode.setToSetupPose()},setBonesToSetupPose:function(){this._sgNode&&this._sgNode.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._sgNode&&this._sgNode.setSlotsToSetupPose()},findBone:function(t){return this._sgNode?this._sgNode.findBone(t):null},findSlot:function(t){return this._sgNode?this._sgNode.findSlot(t):null},setSkin:function(t){return this._sgNode?this._sgNode.setSkin(t):null},getAttachment:function(t,e){return this._sgNode?this._sgNode.getAttachment(t,e):null},setAttachment:function(t,e){this._sgNode&&this._sgNode.setAttachment(t,e)},setSkeletonData:function(t,e){this._sgNode&&this._sgNode.setSkeletonData(t,e)},setAnimationStateData:function(t){return this._sgNode?this._sgNode.setAnimationStateData(t):void 0},setMix:function(t,e,i){this._sgNode&&this._sgNode.setMix(t,e,i)},setAnimationListener:function(t,e){this._sgNode&&this._sgNode.setAnimationListener(t,e)},setAnimation:function(t,e,i){if(this._sgNode){var n=this._sgNode.setAnimation(t,e,i);return n}return null},_sample:function(){this._sgNode&&this._sgNode.update(0)},addAnimation:function(t,e,i,n){return this._sgNode?this._sgNode.addAnimation(t,e,i,n):null},getCurrent:function(t){return this._sgNode?this._sgNode.getCurrent(t):null},clearTracks:function(){this._sgNode&&this._sgNode.clearTracks()},clearTrack:function(t){this._sgNode&&this._sgNode.clearTrack(t)},_updateAnimEnum:!1,_updateSkinEnum:!1,setStartListener:function(t){this._sgNode&&this._sgNode.setStartListener(t)},setEndListener:function(t){this._sgNode&&this._sgNode.setEndListener(t)},setCompleteListener:function(t){this._sgNode&&this._sgNode.setCompleteListener(t)},setEventListener:function(t){this._sgNode&&this._sgNode.setEventListener(t)},setTrackStartListener:function(t,e){this._sgNode&&this._sgNode.setTrackStartListener(t,e)},setTrackEndListener:function(t,e){this._sgNode&&this._sgNode.setTrackEndListener(t,e)},setTrackCompleteListener:function(t,e){this._sgNode&&this._sgNode.setTrackCompleteListener(t,e)},setTrackEventListener:function(t,e){this._sgNode&&this._sgNode.setTrackEventListener(t,e)},getState:function(){return this._sgNode?this._sgNode.getState():void 0},_refresh:function(){var t=this;t._sgNode&&(t.node._sizeProvider===t._sgNode&&(t.node._sizeProvider=null),t._removeSgNode(),t._sgNode=null);var e=t._sgNode=t._createSgNode();e&&(e.retain(),t.enabledInHierarchy||e.setVisible(!1),e.setContentSize(0,0),t._initSgNode(),t._appendSgNode(e),t._registSizeProvider())}})},{}],158:[function(t,e,i){var n=(cc.Class({ctor:function(){this.asset=arguments[0]},getTexture:function(t){for(var e=this.asset.textures,i=0;i<e.length;i++){var n=e[i];if(n.endsWith(t))return cc.textureCache.addImage(n)}return null},load:function(t,e,i){var n=this.getTexture(e);n?cc._renderType===cc.game.RENDER_TYPE_WEBGL?(t.rendererObject=new cc.TextureAtlas(n,128),t.width=n.getPixelWidth(),t.height=n.getPixelHeight()):t._texture=n:cc.error('Failed to load spine atlas "$s"',e)},unload:function(t){}}),cc.Class({name:"sp.SkeletonData","extends":cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJson:{get:function(){return this._skeletonJson},set:function(t){this._skeletonJson=t,this.reset()}},_atlasText:"",atlasText:{get:function(){return this._atlasText},set:function(t){this._atlasText=t,this.reset()}},atlasUrl:{"default":"",url:cc.RawAsset},textures:{"default":[],url:[cc.Texture2D]},scale:1},statics:{preventDeferredLoadDependents:!0},createNode:function(t){var e=new cc.Node(this.name),i=e.addComponent(sp.Skeleton);return i.skeletonData=this,t(null,e)},reset:function(){this._skeletonCache=null,this._atlasCache=null},getRuntimeData:!1,getSkinsEnum:!1,getAnimsEnum:!1,_getAtlas:!1}));sp.SkeletonData=e.exports=n},{}],159:[function(t,e,i){sp=sp,sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.AnimationEventType=cc.Enum({START:0,END:1,COMPLETE:2,EVENT:3}),t("./SkeletonData"),t("./Skeleton")},{"./SGSkeleton":184,"./SGSkeletonAnimation":184,"./SGSkeletonCanvasRenderCmd":184,"./SGSkeletonWebGLRenderCmd":184,"./Skeleton":157,"./SkeletonData":158,"./lib/spine":184}],160:[function(t,e,i){Object.create=Object.create||function(t){function e(){}return e.prototype=t,new e};var n,o,r=function(t,e){if(!t)throw new Error("Assertion failed: "+e)},s=function(t,e){!t&&console&&console.warn&&(console.warn("ASSERTION FAILED: "+e),console.trace&&console.trace())},c=function(t,e){return e>t?t:e},a=function(t,e){return t>e?t:e};"object"==typeof window&&window.navigator.userAgent.indexOf("Firefox")>-1?(n=Math.min,o=Math.max):(n=c,o=a);var h=function(t,e){return e>t?t+" "+e:e+" "+t},l=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return t[i]=t[t.length-1],void t.length--},u=function(t,e,i){var n=x(e,i),o=m(T(n,x(t,i))/F(n));return A(i,N(n,o))},d=function(t,e,i,n,o,r){var s=i-o,c=n-r,a=m(b(s,c,t-o,e-r)/B(s,c));return new y(o+s*a,r+c*a)};cp.momentForCircle=function(t,e,i,n){return t*(.5*(e*e+i*i)+F(n))},cp.areaForCircle=function(t,e){return Math.PI*Math.abs(t*t-e*e)},cp.momentForSegment=function(t,e,i){var n=N(A(e,i),.5);return t*(V(i,e)/12+F(n))},cp.areaForSegment=function(t,e,i){return i*(Math.PI*i+2*j(t,e))},cp.momentForPoly=function(t,e,i){for(var n=0,o=0,r=e.length,s=0;r>s;s+=2){var c=e[s]+i.x,a=e[s+1]+i.y,h=e[(s+2)%r]+i.x,l=e[(s+3)%r]+i.y,u=I(h,l,c,a),d=b(c,a,c,a)+b(c,a,h,l)+b(h,l,h,l);n+=u*d,o+=u}return t*n/(6*o)},cp.areaForPoly=function(t){for(var e=0,i=0,n=t.length;n>i;i+=2)e+=w(new y(t[i],t[i+1]),new y(t[(i+2)%n],t[(i+3)%n]));return-e/2},cp.centroidForPoly=function(t){for(var e=0,i=new y(0,0),n=0,o=t.length;o>n;n+=2){var r=new y(t[n],t[n+1]),s=new y(t[(n+2)%o],t[(n+3)%o]),c=w(r,s);e+=c,i=A(i,N(A(r,s),c))}return N(i,1/(3*e))},cp.recenterPoly=function(t){for(var e=cp.centroidForPoly(t),i=0;i<t.length;i+=2)t[i]-=e.x,t[i+1]-=e.y},cp.momentForBox=function(t,e,i){return t*(e*e+i*i)/12},cp.momentForBox2=function(t,e){var i=e.r-e.l,n=e.t-e.b,o=N([e.l+e.r,e.b+e.t],.5);return cp.momentForBox(t,i,n)+t*F(o)};var p=cp.loopIndexes=function(t){var e,i,n,o,r=0,s=0;e=n=t[0],i=o=t[1];for(var c=t.length>>1,a=1;c>a;a++){var h=t[2*a],l=t[2*a+1];e>h||h==e&&i>l?(e=h,i=l,r=a):(h>n||h==n&&l>o)&&(n=h,o=l,s=a)}return[r,s]},_=function(t,e,i){var n=t[2*e];t[2*e]=t[2*i],t[2*i]=n,n=t[2*e+1],t[2*e+1]=t[2*i+1],t[2*i+1]=n},f=function(t,e,i,n,o,r){if(0===i)return 0;for(var s=0,c=e,a=x(o,n),h=r*E(a),l=e,u=e+i-1;u>=l;){var d=new y(t[2*l],t[2*l+1]),p=w(a,x(d,n));p>h?(p>s&&(s=p,c=l),l++):(_(t,l,u),u--)}return c!=e&&_(t,e,c),l-e},g=function(t,e,i,n,o,r,s,c){if(0>n)return 0;if(0==n)return e[2*c]=r.x,e[2*c+1]=r.y,1;var a=f(e,i,n,o,r,t),h=new y(e[2*i],e[2*i+1]),l=g(t,e,i+1,a-1,o,h,r,c),u=c+l++;e[2*u]=r.x,e[2*u+1]=r.y;var d=f(e,i+a,n-a,r,s,t),p=new y(e[2*(i+a)],e[2*(i+a)+1]);return l+g(t,e,i+a+1,d-1,r,p,s,c+l)};cp.convexHull=function(t,e,i){if(e)for(var n=0;n<t.length;n++)e[n]=t[n];else e=t;var o=p(t),r=o[0],c=o[1];if(r==c)return e.length=2,e;_(e,0,r),_(e,1,0==c?r:c);var a=new y(e[0],e[1]),h=new y(e[2],e[3]),l=t.length>>1,u=g(i,e,2,l-2,a,h,a,1)+1;return e.length=2*u,s(it(e),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can."),
e};var v=function(t,e,i){return n(o(t,e),i)},m=function(t){return o(0,n(t,1))},y=cp.Vect=function(t,e){this.x=t,this.y=e};cp.v=function(t,e){return new y(t,e)};var C=cp.vzero=new y(0,0),T=cp.v.dot=function(t,e){return t.x*e.x+t.y*e.y},b=function(t,e,i,n){return t*i+e*n},E=cp.v.len=function(t){return Math.sqrt(T(t,t))},S=cp.v.len2=function(t,e){return Math.sqrt(t*t+e*e)},A=(cp.v.eql=function(t,e){return t.x===e.x&&t.y===e.y},cp.v.add=function(t,e){return new y(t.x+e.x,t.y+e.y)});y.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this};var x=cp.v.sub=function(t,e){return new y(t.x-e.x,t.y-e.y)};y.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this};var O=cp.v.neg=function(t){return new y(-t.x,-t.y)};y.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};var N=cp.v.mult=function(t,e){return new y(t.x*e,t.y*e)};y.prototype.mult=function(t){return this.x*=t,this.y*=t,this};var w=cp.v.cross=function(t,e){return t.x*e.y-t.y*e.x},I=function(t,e,i,n){return t*n-e*i},P=cp.v.perp=function(t){return new y(-t.y,t.x)},L=(cp.v.pvrperp=function(t){return new y(t.y,-t.x)},cp.v.project=function(t,e){return N(e,T(t,e)/F(e))});y.prototype.project=function(t){return this.mult(T(this,t)/F(t)),this};var R=cp.v.rotate=function(t,e){return new y(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)};y.prototype.rotate=function(t){return this.x=this.x*t.x-this.y*t.y,this.y=this.x*t.y+this.y*t.x,this};var M=cp.v.unrotate=function(t,e){return new y(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},F=cp.v.lengthsq=function(t){return T(t,t)},B=cp.v.lengthsq2=function(t,e){return t*t+e*e},D=cp.v.lerp=function(t,e,i){return A(N(t,1-i),N(e,i))},z=cp.v.normalize=function(t){return N(t,1/E(t))},k=cp.v.normalize_safe=function(t){return 0===t.x&&0===t.y?C:z(t)},W=cp.v.clamp=function(t,e){return T(t,t)>e*e?N(z(t),e):t},j=(cp.v.lerpconst=function(t,e,i){return A(t,W(x(e,t),i))},cp.v.dist=function(t,e){return E(x(t,e))}),V=cp.v.distsq=function(t,e){return F(x(t,e))},H=(cp.v.near=function(t,e,i){return V(t,e)<i*i},cp.v.slerp=function(t,e,i){var n=Math.acos(T(t,e));if(n){var o=1/Math.sin(n);return A(N(t,Math.sin((1-i)*n)*o),N(e,Math.sin(i*n)*o))}return t}),U=(cp.v.slerpconst=function(t,e,i){var o=Math.acos(T(t,e));return H(t,e,n(i,o)/o)},cp.v.forangle=function(t){return new y(Math.cos(t),Math.sin(t))},cp.v.toangle=function(t){return Math.atan2(t.y,t.x)},cp.v.str=function(t){return"("+t.x.toFixed(3)+", "+t.y.toFixed(3)+")"},0),G=cp.BB=function(t,e,i,n){this.l=t,this.b=e,this.r=i,this.t=n,U++};cp.bb=function(t,e,i,n){return new G(t,e,i,n)};var Y=function(t,e){return new G(t.x-e,t.y-e,t.x+e,t.y+e)},X=function(t,e,i,n,o){return t.l<=n&&e<=t.r&&t.b<=o&&i<=t.t},Q=0,q=(cp.NO_GROUP=0,cp.ALL_LAYERS=-1);cp.resetShapeIdCounter=function(){Q=0};var Z=cp.Shape=function(t){this.body=t,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=Q++,this.sensor=!1,this.e=0,this.u=0,this.surface_v=C,this.collision_type=0,this.group=0,this.layers=q,this.space=null,this.collisionCode=this.collisionCode};Z.prototype.setElasticity=function(t){this.e=t},Z.prototype.setFriction=function(t){this.body.activate(),this.u=t},Z.prototype.setLayers=function(t){this.body.activate(),this.layers=t},Z.prototype.setSensor=function(t){this.body.activate(),this.sensor=t},Z.prototype.setCollisionType=function(t){this.body.activate(),this.collision_type=t},Z.prototype.getBody=function(){return this.body},Z.prototype.active=function(){return this.body&&-1!==this.body.shapeList.indexOf(this)},Z.prototype.setBody=function(t){r(!this.active(),"You cannot change the body on an active shape. You must remove the shape from the space before changing the body."),this.body=t},Z.prototype.cacheBB=function(){return this.update(this.body.p,this.body.rot)},Z.prototype.update=function(t,e){r(!isNaN(e.x),"Rotation is NaN"),r(!isNaN(t.x),"Position is NaN"),this.cacheData(t,e)},Z.prototype.pointQuery=function(t){var e=this.nearestPointQuery(t);return e.d<0?e:void 0},Z.prototype.getBB=function(){return new G(this.bb_l,this.bb_b,this.bb_r,this.bb_t)};var J=function(t,e,i){this.shape=t,this.p=e,this.d=i},K=function(t,e,i){this.shape=t,this.t=e,this.n=i};K.prototype.hitPoint=function(t,e){return D(t,e,this.t)},K.prototype.hitDist=function(t,e){return j(t,e)*this.t};var $=cp.CircleShape=function(t,e,i){this.c=this.tc=i,this.r=e,this.type="circle",Z.call(this,t)};$.prototype=Object.create(Z.prototype),$.prototype.cacheData=function(t,e){var i=this.tc=R(this.c,e).add(t),n=this.r;this.bb_l=i.x-n,this.bb_b=i.y-n,this.bb_r=i.x+n,this.bb_t=i.y+n},$.prototype.nearestPointQuery=function(t){var e=t.x-this.tc.x,i=t.y-this.tc.y,n=S(e,i),o=this.r,r=new y(this.tc.x+e*o/n,this.tc.y+i*o/n);return new J(this,r,n-o)};var tt=function(t,e,i,n,o,r){n=x(n,e),o=x(o,e);var s=T(n,n)-2*T(n,o)+T(o,o),c=-2*T(n,n)+2*T(n,o),a=T(n,n)-i*i,h=c*c-4*s*a;if(h>=0){var l=(-c-Math.sqrt(h))/(2*s);if(l>=0&&1>=l)return new K(t,l,z(D(n,o,l)))}};$.prototype.segmentQuery=function(t,e){return tt(this,this.tc,this.r,t,e)};var et=cp.SegmentShape=function(t,e,i,n){this.a=e,this.b=i,this.n=P(z(x(i,e))),this.ta=this.tb=this.tn=null,this.r=n,this.a_tangent=C,this.b_tangent=C,this.type="segment",Z.call(this,t)};et.prototype=Object.create(Z.prototype),et.prototype.cacheData=function(t,e){this.ta=A(t,R(this.a,e)),this.tb=A(t,R(this.b,e)),this.tn=R(this.n,e);var i,n,o,r;this.ta.x<this.tb.x?(i=this.ta.x,n=this.tb.x):(i=this.tb.x,n=this.ta.x),this.ta.y<this.tb.y?(o=this.ta.y,r=this.tb.y):(o=this.tb.y,r=this.ta.y);var s=this.r;this.bb_l=i-s,this.bb_b=o-s,this.bb_r=n+s,this.bb_t=r+s},et.prototype.nearestPointQuery=function(t){var e=u(t,this.ta,this.tb),i=t.x-e.x,n=t.y-e.y,o=S(i,n),r=this.r,s=o?A(e,N(new y(i,n),r/o)):e;return new J(this,s,o-r)},et.prototype.segmentQuery=function(t,e){var i=this.tn,n=T(x(this.ta,t),i),o=this.r,r=n>0?O(i):i,s=x(N(r,o),t),c=A(this.ta,s),a=A(this.tb,s),h=x(e,t);if(w(h,c)*w(h,a)<=0){var l=n+(n>0?-o:o),u=-l,d=T(h,i)-l;if(0>u*d)return new K(this,u/(u-d),r)}else if(0!==o){var p=tt(this,this.ta,this.r,t,e),_=tt(this,this.tb,this.r,t,e);return p?_&&_.t<p.t?_:p:_}},et.prototype.setNeighbors=function(t,e){this.a_tangent=x(t,this.a),this.b_tangent=x(e,this.b)},et.prototype.setEndpoints=function(t,e){this.a=t,this.b=e,this.n=P(z(x(e,t)))};var it=function(t){for(var e=t.length,i=0;e>i;i+=2){var n=t[i],o=t[i+1],r=t[(i+2)%e],s=t[(i+3)%e],c=t[(i+4)%e],a=t[(i+5)%e];if(I(r-n,s-o,c-r,a-s)>0)return!1}return!0},nt=cp.PolyShape=function(t,e,i){this.setVerts(e,i),this.type="poly",Z.call(this,t)};nt.prototype=Object.create(Z.prototype);var ot=function(t,e){this.n=t,this.d=e};ot.prototype.compare=function(t){return T(this.n,t)-this.d},nt.prototype.setVerts=function(t,e){r(t.length>=4,"Polygons require some verts"),r("number"==typeof t[0],"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),r(it(t),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var i=t.length,n=i>>1;this.verts=new Array(i),this.tVerts=new Array(i),this.planes=new Array(n),this.tPlanes=new Array(n);for(var o=0;i>o;o+=2){var s=t[o]+e.x,c=t[o+1]+e.y,a=t[(o+2)%i]+e.x,h=t[(o+3)%i]+e.y,l=z(P(new y(a-s,h-c)));this.verts[o]=s,this.verts[o+1]=c,this.planes[o>>1]=new ot(l,b(l.x,l.y,s,c)),this.tPlanes[o>>1]=new ot(new y(0,0),0)}};var rt=(cp.BoxShape=function(t,e,i){var n=e/2,o=i/2;return rt(t,new G(-n,-o,n,o))},cp.BoxShape2=function(t,e){var i=[e.l,e.b,e.l,e.t,e.r,e.t,e.r,e.b];return new nt(t,i,C)});nt.prototype.transformVerts=function(t,e){for(var i=this.verts,r=this.tVerts,s=1/0,c=-(1/0),a=1/0,h=-(1/0),l=0;l<i.length;l+=2){var u=i[l],d=i[l+1],p=t.x+u*e.x-d*e.y,_=t.y+u*e.y+d*e.x;r[l]=p,r[l+1]=_,s=n(s,p),c=o(c,p),a=n(a,_),h=o(h,_)}this.bb_l=s,this.bb_b=a,this.bb_r=c,this.bb_t=h},nt.prototype.transformAxes=function(t,e){for(var i=this.planes,n=this.tPlanes,o=0;o<i.length;o++){var r=R(i[o].n,e);n[o].n=r,n[o].d=T(t,r)+i[o].d}},nt.prototype.cacheData=function(t,e){this.transformAxes(t,e),this.transformVerts(t,e)},nt.prototype.nearestPointQuery=function(t){for(var e=this.tPlanes,i=this.tVerts,n=i[i.length-2],o=i[i.length-1],r=1/0,s=C,c=!1,a=0;a<e.length;a++){e[a].compare(t)>0&&(c=!0);var h=i[2*a],l=i[2*a+1],u=d(t.x,t.y,n,o,h,l),p=j(t,u);r>p&&(r=p,s=u),n=h,o=l}return new J(this,s,c?r:-r)},nt.prototype.segmentQuery=function(t,e){for(var i=this.tPlanes,n=this.tVerts,o=i.length,r=2*o,s=0;o>s;s++){var c=i[s].n,a=T(t,c);if(!(i[s].d>a)){var h=T(e,c),l=(i[s].d-a)/(h-a);if(!(0>l||l>1)){var u=D(t,e,l),d=-w(c,u),p=-I(c.x,c.y,n[2*s],n[2*s+1]),_=-I(c.x,c.y,n[(2*s+2)%r],n[(2*s+3)%r]);if(d>=p&&_>=d)return new K(this,l,c)}}}},nt.prototype.valueOnAxis=function(t,e){for(var i=this.tVerts,o=b(t.x,t.y,i[0],i[1]),r=2;r<i.length;r+=2)o=n(o,b(t.x,t.y,i[r],i[r+1]));return o-e},nt.prototype.containsVert=function(t,e){for(var i=this.tPlanes,n=0;n<i.length;n++){var o=i[n].n,r=b(o.x,o.y,t,e)-i[n].d;if(r>0)return!1}return!0},nt.prototype.containsVertPartial=function(t,e,i){for(var n=this.tPlanes,o=0;o<n.length;o++){var r=n[o].n;if(!(T(r,i)<0)){var s=b(r.x,r.y,t,e)-n[o].d;if(s>0)return!1}}return!0},nt.prototype.getNumVerts=function(){return this.verts.length/2},nt.prototype.getVert=function(t){return new y(this.verts[2*t],this.verts[2*t+1])};var st=cp.Body=function(t,e){this.p=new y(0,0),this.vx=this.vy=0,this.f=new y(0,0),this.w=0,this.t=0,this.v_limit=1/0,this.w_limit=1/0,this.v_biasx=this.v_biasy=0,this.w_bias=0,this.space=null,this.shapeList=[],this.arbiterList=null,this.constraintList=null,this.nodeRoot=null,this.nodeNext=null,this.nodeIdleTime=0,this.setMass(t),this.setMoment(e),this.rot=new y(0,0),this.setAngle(0)},ct=function(){var t=new st(1/0,1/0);return t.nodeIdleTime=1/0,t};if(cp.StaticBody=ct,"undefined"!=typeof DEBUG&&DEBUG){var at=function(t,e){r(t.x==t.x&&t.y==t.y,e)},ht=function(t,e){r(Math.abs(t.x)!==1/0&&Math.abs(t.y)!==1/0,e)},lt=function(t,e){at(t,e),ht(t,e)};st.prototype.sanityCheck=function(){r(this.m===this.m&&this.m_inv===this.m_inv,"Body's mass is invalid."),r(this.i===this.i&&this.i_inv===this.i_inv,"Body's moment is invalid."),lt(this.p,"Body's position is invalid."),lt(this.f,"Body's force is invalid."),r(this.vx===this.vx&&Math.abs(this.vx)!==1/0,"Body's velocity is invalid."),r(this.vy===this.vy&&Math.abs(this.vy)!==1/0,"Body's velocity is invalid."),r(this.a===this.a&&Math.abs(this.a)!==1/0,"Body's angle is invalid."),r(this.w===this.w&&Math.abs(this.w)!==1/0,"Body's angular velocity is invalid."),r(this.t===this.t&&Math.abs(this.t)!==1/0,"Body's torque is invalid."),lt(this.rot,"Body's rotation vector is invalid."),r(this.v_limit===this.v_limit,"Body's velocity limit is invalid."),r(this.w_limit===this.w_limit,"Body's angular velocity limit is invalid.")}}else st.prototype.sanityCheck=function(){};st.prototype.getPos=function(){return this.p},st.prototype.getVel=function(){return new y(this.vx,this.vy)},st.prototype.getAngVel=function(){return this.w},st.prototype.isSleeping=function(){return null!==this.nodeRoot},st.prototype.isStatic=function(){return this.nodeIdleTime===1/0},st.prototype.isRogue=function(){return null===this.space},st.prototype.setMass=function(t){r(t>0,"Mass must be positive and non-zero."),this.activate(),this.m=t,this.m_inv=1/t},st.prototype.setMoment=function(t){r(t>0,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=t,this.i_inv=1/t},st.prototype.addShape=function(t){this.shapeList.push(t)},st.prototype.removeShape=function(t){l(this.shapeList,t)};var ut=function(t,e,i){return t===i?t.next(e):(t.a===e?t.next_a=ut(t.next_a,e,i):t.next_b=ut(t.next_b,e,i),t)};st.prototype.removeConstraint=function(t){this.constraintList=ut(this.constraintList,this,t)},st.prototype.setPos=function(t){this.activate(),this.sanityCheck(),t===C&&(t=cp.v(0,0)),this.p=t},st.prototype.setVel=function(t){this.activate(),this.vx=t.x,this.vy=t.y},st.prototype.setAngVel=function(t){this.activate(),this.w=t},st.prototype.setAngleInternal=function(t){r(!isNaN(t),"Internal Error: Attempting to set body's angle to NaN"),this.a=t,this.rot.x=Math.cos(t),this.rot.y=Math.sin(t)},st.prototype.setAngle=function(t){this.activate(),this.sanityCheck(),this.setAngleInternal(t)},st.prototype.velocity_func=function(t,e,i){var n=this.vx*e+(t.x+this.f.x*this.m_inv)*i,o=this.vy*e+(t.y+this.f.y*this.m_inv)*i,r=this.v_limit,s=n*n+o*o,c=s>r*r?r/Math.sqrt(s):1;this.vx=n*c,this.vy=o*c;var a=this.w_limit;this.w=v(this.w*e+this.t*this.i_inv*i,-a,a),this.sanityCheck()},st.prototype.position_func=function(t){this.p.x+=(this.vx+this.v_biasx)*t,this.p.y+=(this.vy+this.v_biasy)*t,this.setAngleInternal(this.a+(this.w+this.w_bias)*t),this.v_biasx=this.v_biasy=0,this.w_bias=0,this.sanityCheck()},st.prototype.resetForces=function(){this.activate(),this.f=new y(0,0),this.t=0},st.prototype.applyForce=function(t,e){this.activate(),this.f=A(this.f,t),this.t+=w(e,t)},st.prototype.applyImpulse=function(t,e){this.activate(),pe(this,t.x,t.y,e)},st.prototype.getVelAtPoint=function(t){return A(new y(this.vx,this.vy),N(P(t),this.w))},st.prototype.getVelAtWorldPoint=function(t){return this.getVelAtPoint(x(t,this.p))},st.prototype.getVelAtLocalPoint=function(t){return this.getVelAtPoint(R(t,this.rot))},st.prototype.eachShape=function(t){for(var e=0,i=this.shapeList.length;i>e;e++)t(this.shapeList[e])},st.prototype.eachConstraint=function(t){for(var e=this.constraintList;e;){var i=e.next(this);t(e),e=i}},st.prototype.eachArbiter=function(t){for(var e=this.arbiterList;e;){var i=e.next(this);e.swappedColl=this===e.body_b,t(e),e=i}},st.prototype.local2World=function(t){return A(this.p,R(t,this.rot))},st.prototype.world2Local=function(t){return M(x(t,this.p),this.rot)},st.prototype.kineticEnergy=function(){var t=this.vx*this.vx+this.vy*this.vy,e=this.w*this.w;return(t?t*this.m:0)+(e?e*this.i:0)};var dt=cp.SpatialIndex=function(t){if(this.staticIndex=t,t){if(t.dynamicIndex)throw new Error("This static index is already associated with a dynamic index.");t.dynamicIndex=this}};dt.prototype.collideStatic=function(t,e){if(t.count>0){var i=t.query;this.each(function(t){i(t,new G(t.bb_l,t.bb_b,t.bb_r,t.bb_t),e)})}};var pt=cp.BBTree=function(t){dt.call(this,t),this.velocityFunc=null,this.leaves={},this.count=0,this.root=null,this.pooledNodes=null,this.pooledPairs=null,this.stamp=0};pt.prototype=Object.create(dt.prototype);var _t=0,ft=function(t,e,i){this.obj=null,this.bb_l=n(e.bb_l,i.bb_l),this.bb_b=n(e.bb_b,i.bb_b),this.bb_r=o(e.bb_r,i.bb_r),this.bb_t=o(e.bb_t,i.bb_t),this.parent=null,this.setA(e),this.setB(i)};pt.prototype.makeNode=function(t,e){var i=this.pooledNodes;return i?(this.pooledNodes=i.parent,i.constructor(this,t,e),i):(_t++,new ft(this,t,e))};var gt=0,vt=function(t,e){this.obj=e,t.getBB(e,this),this.parent=null,this.stamp=1,this.pairs=null,gt++};pt.prototype.getBB=function(t,e){var i=this.velocityFunc;if(i){var r=.1,s=(t.bb_r-t.bb_l)*r,c=(t.bb_t-t.bb_b)*r,a=N(i(t),.1);e.bb_l=t.bb_l+n(-s,a.x),e.bb_b=t.bb_b+n(-c,a.y),e.bb_r=t.bb_r+o(s,a.x),e.bb_t=t.bb_t+o(c,a.y)}else e.bb_l=t.bb_l,e.bb_b=t.bb_b,e.bb_r=t.bb_r,e.bb_t=t.bb_t},pt.prototype.getStamp=function(){var t=this.dynamicIndex;return t&&t.stamp?t.stamp:this.stamp},pt.prototype.incrementStamp=function(){this.dynamicIndex&&this.dynamicIndex.stamp?this.dynamicIndex.stamp++:this.stamp++};var mt=0,yt=function(t,e,i,n){this.prevA=null,this.leafA=t,this.nextA=e,this.prevB=null,this.leafB=i,this.nextB=n};pt.prototype.makePair=function(t,e,i,n){var o=this.pooledPairs;return o?(this.pooledPairs=o.prevA,o.prevA=null,o.leafA=t,o.nextA=e,o.prevB=null,o.leafB=i,o.nextB=n,o):(mt++,new yt(t,e,i,n))},yt.prototype.recycle=function(t){this.prevA=t.pooledPairs,t.pooledPairs=this};var Ct=function(t,e,i){i&&(i.leafA===e?i.prevA=t:i.prevB=t),t?t.leafA===e?t.nextA=i:t.nextB=i:e.pairs=i};vt.prototype.clearPairs=function(t){var e,i=this.pairs;for(this.pairs=null;i;)i.leafA===this?(e=i.nextA,Ct(i.prevB,i.leafB,i.nextB)):(e=i.nextB,Ct(i.prevA,i.leafA,i.nextA)),i.recycle(t),i=e};var Tt=function(t,e,i){var n=t.pairs,o=e.pairs,r=i.makePair(t,n,e,o);t.pairs=e.pairs=r,n&&(n.leafA===t?n.prevA=r:n.prevB=r),o&&(o.leafA===e?o.prevA=r:o.prevB=r)};ft.prototype.recycle=function(t){this.parent=t.pooledNodes,t.pooledNodes=this},vt.prototype.recycle=function(t){},ft.prototype.setA=function(t){this.A=t,t.parent=this},ft.prototype.setB=function(t){this.B=t,t.parent=this},vt.prototype.isLeaf=!0,ft.prototype.isLeaf=!1,ft.prototype.otherChild=function(t){return this.A==t?this.B:this.A},ft.prototype.replaceChild=function(t,e,i){s(t==this.A||t==this.B,"Node is not a child of parent."),this.A==t?(this.A.recycle(i),this.setA(e)):(this.B.recycle(i),this.setB(e));for(var r=this;r;r=r.parent){var c=r.A,a=r.B;r.bb_l=n(c.bb_l,a.bb_l),r.bb_b=n(c.bb_b,a.bb_b),r.bb_r=o(c.bb_r,a.bb_r),r.bb_t=o(c.bb_t,a.bb_t)}},ft.prototype.bbArea=vt.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)};var bt=function(t,e){return(o(t.bb_r,e.bb_r)-n(t.bb_l,e.bb_l))*(o(t.bb_t,e.bb_t)-n(t.bb_b,e.bb_b))},Et=function(t,e){return Math.abs(t.bb_l+t.bb_r-e.bb_l-e.bb_r)+Math.abs(t.bb_b+t.bb_t-e.bb_b-e.bb_t)},St=function(t,e,i){if(null==t)return e;if(t.isLeaf)return i.makeNode(e,t);var r=t.B.bbArea()+bt(t.A,e),s=t.A.bbArea()+bt(t.B,e);return r===s&&(r=Et(t.A,e),s=Et(t.B,e)),r>s?t.setB(St(t.B,e,i)):t.setA(St(t.A,e,i)),t.bb_l=n(t.bb_l,e.bb_l),t.bb_b=n(t.bb_b,e.bb_b),t.bb_r=o(t.bb_r,e.bb_r),t.bb_t=o(t.bb_t,e.bb_t),t};ft.prototype.intersectsBB=vt.prototype.intersectsBB=function(t){return this.bb_l<=t.r&&t.l<=this.bb_r&&this.bb_b<=t.t&&t.b<=this.bb_t};var At=function(t,e,i){t.intersectsBB(e)&&(t.isLeaf?i(t.obj):(At(t.A,e,i),At(t.B,e,i)))},xt=function(t,e,i){var r=1/(i.x-e.x),s=t.bb_l==e.x?-(1/0):(t.bb_l-e.x)*r,c=t.bb_r==e.x?1/0:(t.bb_r-e.x)*r,a=n(s,c),h=o(s,c),l=1/(i.y-e.y),u=t.bb_b==e.y?-(1/0):(t.bb_b-e.y)*l,d=t.bb_t==e.y?1/0:(t.bb_t-e.y)*l,p=n(u,d),_=o(u,d);if(h>=p&&_>=a){var f=o(a,p),g=n(h,_);if(g>=0&&1>=f)return o(f,0)}return 1/0},Ot=function(t,e,i,o,r){if(t.isLeaf)return r(t.obj);var s=xt(t.A,e,i),c=xt(t.B,e,i);return c>s?(o>s&&(o=n(o,Ot(t.A,e,i,o,r))),o>c&&(o=n(o,Ot(t.B,e,i,o,r)))):(o>c&&(o=n(o,Ot(t.B,e,i,o,r))),o>s&&(o=n(o,Ot(t.A,e,i,o,r)))),o};pt.prototype.subtreeRecycle=function(t){t.isLeaf&&(this.subtreeRecycle(t.A),this.subtreeRecycle(t.B),t.recycle(this))};var Nt=function(t,e,i){if(e==t)return null;var n=e.parent;if(n==t){var o=t.otherChild(e);return o.parent=t.parent,t.recycle(i),o}return n.parent.replaceChild(n,n.otherChild(e),i),t},wt=function(t,e){return t.bb_l<=e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t};vt.prototype.markLeafQuery=function(t,e,i,n){wt(t,this)&&(e?Tt(t,this,i):(this.stamp<t.stamp&&Tt(this,t,i),n&&n(t.obj,this.obj)))},ft.prototype.markLeafQuery=function(t,e,i,n){wt(t,this)&&(this.A.markLeafQuery(t,e,i,n),this.B.markLeafQuery(t,e,i,n))},vt.prototype.markSubtree=function(t,e,i){if(this.stamp==t.getStamp()){e&&e.markLeafQuery(this,!1,t,i);for(var n=this;n.parent;n=n.parent)n==n.parent.A?n.parent.B.markLeafQuery(this,!0,t,i):n.parent.A.markLeafQuery(this,!1,t,i)}else for(var o=this.pairs;o;)this===o.leafB?(i&&i(o.leafA.obj,this.obj),o=o.nextB):o=o.nextA},ft.prototype.markSubtree=function(t,e,i){this.A.markSubtree(t,e,i),this.B.markSubtree(t,e,i)},vt.prototype.containsObj=function(t){return this.bb_l<=t.bb_l&&this.bb_r>=t.bb_r&&this.bb_b<=t.bb_b&&this.bb_t>=t.bb_t},vt.prototype.update=function(t){var e=t.root,i=this.obj;return this.containsObj(i)?!1:(t.getBB(this.obj,this),e=Nt(e,this,t),t.root=St(e,this,t),this.clearPairs(t),this.stamp=t.getStamp(),!0)},vt.prototype.addPairs=function(t){var e=t.dynamicIndex;if(e){var i=e.root;i&&i.markLeafQuery(this,!0,e,null)}else{var n=t.staticIndex.root;this.markSubtree(t,n,null)}},pt.prototype.insert=function(t,e){var i=new vt(this,t);this.leaves[e]=i,this.root=St(this.root,i,this),this.count++,i.stamp=this.getStamp(),i.addPairs(this),this.incrementStamp()},pt.prototype.remove=function(t,e){var i=this.leaves[e];delete this.leaves[e],this.root=Nt(this.root,i,this),this.count--,i.clearPairs(this),i.recycle(this)},pt.prototype.contains=function(t,e){return null!=this.leaves[e]};var It=function(t,e){};pt.prototype.reindexQuery=function(t){if(this.root){var e,i=this.leaves;for(e in i)i[e].update(this);var n=this.staticIndex,o=n&&n.root;this.root.markSubtree(this,o,t),n&&!o&&this.collideStatic(this,n,t),this.incrementStamp()}},pt.prototype.reindex=function(){this.reindexQuery(It)},pt.prototype.reindexObject=function(t,e){var i=this.leaves[e];i&&(i.update(this)&&i.addPairs(this),this.incrementStamp())},pt.prototype.pointQuery=function(t,e){this.query(new G(t.x,t.y,t.x,t.y),e)},pt.prototype.segmentQuery=function(t,e,i,n){this.root&&Ot(this.root,t,e,i,n)},pt.prototype.query=function(t,e){this.root&&At(this.root,t,e)},pt.prototype.count=function(){return this.count},pt.prototype.each=function(t){var e;for(e in this.leaves)t(this.leaves[e].obj)};var Pt=function(t,e,i,r,s){return(o(t.bb_r,r)-n(t.bb_l,e))*(o(t.bb_t,s)-n(t.bb_b,i))},Lt=function(t,e,i,r){if(1==r)return e[i];if(2==r)return t.makeNode(e[i],e[i+1]);for(var s=e[i],c=s.bb_l,a=s.bb_b,h=s.bb_r,l=s.bb_t,u=i+r,d=i+1;u>d;d++)s=e[d],c=n(c,s.bb_l),a=n(a,s.bb_b),h=o(h,s.bb_r),l=o(l,s.bb_t);var p=h-c>l-a,_=new Array(2*r);if(p)for(var d=i;u>d;d++)_[2*d+0]=e[d].bb_l,_[2*d+1]=e[d].bb_r;else for(var d=i;u>d;d++)_[2*d+0]=e[d].bb_b,_[2*d+1]=e[d].bb_t;_.sort(function(t,e){return t-e});var f=.5*(_[r-1]+_[r]),g=c,v=a,m=h,y=l,C=c,T=a,b=h,E=l;p?m=C=f:y=T=f;for(var S=u,A=i;S>A;){var s=e[A];Pt(s,C,T,b,E)<Pt(s,g,v,m,y)?(S--,e[A]=e[S],e[S]=s):A++}if(S==r){for(var s=null,d=i;u>d;d++)s=St(s,e[d],t);return s}return NodeNew(t,Lt(t,e,i,S-i),Lt(t,e,S,u-S))};pt.prototype.optimize=function(){var t=new Array(this.count),e=0;for(var i in this.leaves)t[e++]=this.nodes[i];tree.subtreeRecycle(root),this.root=Lt(tree,t,t.length)};var Rt=function(t,e){!t.isLeaf&&10>=e&&(Rt(t.A,e+1),Rt(t.B,e+1));for(var i="",n=0;e>n;n++)i+=" ";console.log(i+t.bb_b+" "+t.bb_t)};pt.prototype.log=function(){this.root&&Rt(this.root,0)};var Mt=cp.CollisionHandler=function(){this.a=this.b=0};Mt.prototype.begin=function(t,e){return!0},Mt.prototype.preSolve=function(t,e){return!0},Mt.prototype.postSolve=function(t,e){},Mt.prototype.separate=function(t,e){};var Ft=function(t,e){this.e=0,this.u=0,this.surface_vr=C,this.a=t,this.body_a=t.body,this.b=e,this.body_b=e.body,this.thread_a_next=this.thread_a_prev=null,this.thread_b_next=this.thread_b_prev=null,this.contacts=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first coll"};Ft.prototype.getShapes=function(){return this.swappedColl?[this.b,this.a]:[this.a,this.b]},Ft.prototype.totalImpulse=function(){for(var t=this.contacts,e=new y(0,0),i=0,n=t.length;n>i;i++){var o=t[i];e.add(N(o.n,o.jnAcc))}return this.swappedColl?e:e.neg()},Ft.prototype.totalImpulseWithFriction=function(){for(var t=this.contacts,e=new y(0,0),i=0,n=t.length;n>i;i++){var o=t[i];e.add(new y(o.jnAcc,o.jtAcc).rotate(o.n))}return this.swappedColl?e:e.neg()},Ft.prototype.totalKE=function(){for(var t=(1-this.e)/(1+this.e),e=0,i=this.contacts,n=0,o=i.length;o>n;n++){var r=i[n],s=r.jnAcc,c=r.jtAcc;e+=t*s*s/r.nMass+c*c/r.tMass}return e},Ft.prototype.ignore=function(){this.state="ignore"},Ft.prototype.getA=function(){return this.swappedColl?this.b:this.a},Ft.prototype.getB=function(){return this.swappedColl?this.a:this.b},Ft.prototype.isFirstContact=function(){return"first coll"===this.state};var Bt=function(t,e,i){this.point=t,this.normal=e,this.dist=i};Ft.prototype.getContactPointSet=function(){var t,e=new Array(this.contacts.length);for(t=0;t<e.length;t++)e[t]=new Bt(this.contacts[t].p,this.contacts[t].n,this.contacts[t].dist);return e},Ft.prototype.getNormal=function(t){var e=this.contacts[t].n;return this.swappedColl?O(e):e},Ft.prototype.getPoint=function(t){return this.contacts[t].p},Ft.prototype.getDepth=function(t){return this.contacts[t].dist};var Dt=function(t,e,i,n){i?i.body_a===e?i.thread_a_next=n:i.thread_b_next=n:e.arbiterList=n,n&&(n.body_a===e?n.thread_a_prev=i:n.thread_b_prev=i)};Ft.prototype.unthread=function(){Dt(this,this.body_a,this.thread_a_prev,this.thread_a_next),Dt(this,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_a_prev=this.thread_a_next=null,this.thread_b_prev=this.thread_b_next=null},Ft.prototype.update=function(t,e,i,n){if(this.contacts)for(var o=0;o<this.contacts.length;o++)for(var r=this.contacts[o],s=0;s<t.length;s++){var c=t[s];c.hash===r.hash&&(c.jnAcc=r.jnAcc,c.jtAcc=r.jtAcc)}this.contacts=t,this.handler=e,this.swappedColl=i.collision_type!==e.a,this.e=i.e*n.e,this.u=i.u*n.u,this.surface_vr=x(i.surface_v,n.surface_v),this.a=i,this.body_a=i.body,this.b=n,this.body_b=n.body,"cached"==this.state&&(this.state="first coll")},Ft.prototype.preStep=function(t,e,i){for(var o=this.body_a,r=this.body_b,s=0;s<this.contacts.length;s++){var c=this.contacts[s];c.r1=x(c.p,o.p),c.r2=x(c.p,r.p),c.nMass=1/ve(o,r,c.r1,c.r2,c.n),c.tMass=1/ve(o,r,c.r1,c.r2,P(c.n)),c.bias=-i*n(0,c.dist+e)/t,c.jBias=0,c.bounce=de(o,r,c.r1,c.r2,c.n)*this.e}},Ft.prototype.applyCachedImpulse=function(t){if(!this.isFirstContact())for(var e=this.body_a,i=this.body_b,n=0;n<this.contacts.length;n++){var o=this.contacts[n],r=o.n.x,s=o.n.y,c=r*o.jnAcc-s*o.jtAcc,a=r*o.jtAcc+s*o.jnAcc;_e(e,i,o.r1,o.r2,c*t,a*t)}};var zt=0,kt=0;Ft.prototype.applyImpulse=function(){zt++;for(var t=this.body_a,e=this.body_b,i=this.surface_vr,n=this.u,r=0;r<this.contacts.length;r++){kt++;var s=this.contacts[r],c=s.nMass,a=s.n,h=s.r1,l=s.r2,u=e.vx-l.y*e.w-(t.vx-h.y*t.w),d=e.vy+l.x*e.w-(t.vy+h.x*t.w),p=a.x*(e.v_biasx-l.y*e.w_bias-t.v_biasx+h.y*t.w_bias)+a.y*(l.x*e.w_bias+e.v_biasy-h.x*t.w_bias-t.v_biasy),_=b(u,d,a.x,a.y),f=b(u+i.x,d+i.y,-a.y,a.x),g=(s.bias-p)*c,m=s.jBias;s.jBias=o(m+g,0);var y=-(s.bounce+_)*c,C=s.jnAcc;s.jnAcc=o(C+y,0);var T=n*s.jnAcc,E=-f*s.tMass,S=s.jtAcc;s.jtAcc=v(S+E,-T,T);var A=a.x*(s.jBias-m),x=a.y*(s.jBias-m);fe(t,-A,-x,h),fe(e,A,x,l);var O=s.jnAcc-C,N=s.jtAcc-S;_e(t,e,h,l,a.x*O-a.y*N,a.x*N+a.y*O)}},Ft.prototype.callSeparate=function(t){var e=t.lookupHandler(this.a.collision_type,this.b.collision_type);e.separate(this,t)},Ft.prototype.next=function(t){return this.body_a==t?this.thread_a_next:this.thread_b_next};var Wt=0,jt=function(t,e,i,n){this.p=t,this.n=e,this.dist=i,this.r1=this.r2=C,this.nMass=this.tMass=this.bounce=this.bias=0,this.jnAcc=this.jtAcc=this.jBias=0,this.hash=n,Wt++},Vt=[],Ht=function(t,e,i,n){var o=i+n,r=x(e,t),s=F(r);if(!(s>=o*o)){var c=Math.sqrt(s);return new jt(A(t,N(r,.5+(i-.5*o)/(c?c:1/0))),c?N(r,1/c):new y(1,0),c-o,0)}},Ut=function(t,e){var i=Ht(t.tc,e.tc,t.r,e.r);return i?[i]:Vt},Gt=function(t,e){var i=e.ta,n=e.tb,o=t.tc,r=x(n,i),s=m(T(r,x(o,i))/F(r)),c=A(i,N(r,s)),a=Ht(o,c,t.r,e.r);if(a){var h=a.n;return 0===s&&T(h,e.a_tangent)<0||1===s&&T(h,e.b_tangent)<0?Vt:[a]}return Vt},Yt=0,Xt=function(t,e){var i=0,n=t.valueOnAxis(e[0].n,e[0].d);if(n>0)return-1;for(var o=1;o<e.length;o++){var r=t.valueOnAxis(e[o].n,e[o].d);if(r>0)return-1;r>n&&(n=r,i=o)}return Yt=n,i},Qt=function(t,e,i,n){for(var o=[],r=t.tVerts,s=0;s<r.length;s+=2){var c=r[s],a=r[s+1];e.containsVertPartial(c,a,O(i))&&o.push(new jt(new y(c,a),i,n,h(t.hashid,s)))}for(var l=e.tVerts,s=0;s<l.length;s+=2){var c=l[s],a=l[s+1];t.containsVertPartial(c,a,i)&&o.push(new jt(new y(c,a),i,n,h(e.hashid,s)))}return o},qt=function(t,e,i,n){for(var o=[],r=t.tVerts,s=0;s<r.length;s+=2){var c=r[s],a=r[s+1];e.containsVert(c,a)&&o.push(new jt(new y(c,a),i,n,h(t.hashid,s>>1)))}for(var l=e.tVerts,s=0;s<l.length;s+=2){var c=l[s],a=l[s+1];t.containsVert(c,a)&&o.push(new jt(new y(c,a),i,n,h(e.hashid,s>>1)))}return o.length?o:Qt(t,e,i,n)},Zt=function(t,e){var i=Xt(e,t.tPlanes);if(-1==i)return Vt;var n=Yt,o=Xt(t,e.tPlanes);if(-1==o)return Vt;var r=Yt;return n>r?qt(t,e,t.tPlanes[i].n,n):qt(t,e,O(e.tPlanes[o].n),r)},Jt=function(t,e,i){var o=T(e,t.ta)-t.r,r=T(e,t.tb)-t.r;return n(o,r)-i},Kt=function(t,e,i,n,o){for(var r=w(e.tn,e.ta),s=w(e.tn,e.tb),c=N(e.tn,o),a=i.tVerts,l=0;l<a.length;l+=2){var u=a[l],d=a[l+1];if(b(u,d,c.x,c.y)<T(e.tn,e.ta)*o+e.r){var p=I(e.tn.x,e.tn.y,u,d);r>=p&&p>=s&&t.push(new jt(new y(u,d),c,n,h(i.hashid,l)))}}},$t=function(t,e){var i=[],n=e.tPlanes,o=n.length,r=T(t.tn,t.ta),s=e.valueOnAxis(t.tn,r)-t.r,c=e.valueOnAxis(O(t.tn),-r)-t.r;if(c>0||s>0)return Vt;var a=0,l=Jt(t,n[0].n,n[0].d);if(l>0)return Vt;for(var u=0;o>u;u++){var d=Jt(t,n[u].n,n[u].d);if(d>0)return Vt;d>l&&(l=d,a=u)}var p=O(n[a].n),_=A(t.ta,N(p,t.r)),f=A(t.tb,N(p,t.r));if(e.containsVert(_.x,_.y)&&i.push(new jt(_,p,l,h(t.hashid,0))),e.containsVert(f.x,f.y)&&i.push(new jt(f,p,l,h(t.hashid,1))),(s>=l||c>=l)&&(s>c?Kt(i,t,e,s,1):Kt(i,t,e,c,-1)),0===i.length){var g,v=2*a,m=e.tVerts,C=new y(m[v],m[v+1]);if(g=Ht(t.ta,C,t.r,0,i))return[g];if(g=Ht(t.tb,C,t.r,0,i))return[g];var b=2*o,E=new y(m[(v+2)%b],m[(v+3)%b]);if(g=Ht(t.ta,E,t.r,0,i))return[g];if(g=Ht(t.tb,E,t.r,0,i))return[g]}return i},te=function(t,e){for(var i=e.tPlanes,n=0,o=T(i[0].n,t.tc)-i[0].d-t.r,r=0;r<i.length;r++){var s=T(i[r].n,t.tc)-i[r].d-t.r;if(s>0)return Vt;s>o&&(o=s,n=r)}var c=i[n].n,a=e.tVerts,h=a.length,l=n<<1,u=a[l],d=a[l+1],p=a[(l+2)%h],_=a[(l+3)%h],f=I(c.x,c.y,u,d),g=I(c.x,c.y,p,_),v=w(c,t.tc);if(g>v){var m=Ht(t.tc,new y(p,_),t.r,0,m);return m?[m]:Vt}if(f>v)return[new jt(x(t.tc,N(c,t.r+o/2)),O(c),o,0)];var m=Ht(t.tc,new y(u,d),t.r,0,m);return m?[m]:Vt};$.prototype.collisionCode=0,et.prototype.collisionCode=1,nt.prototype.collisionCode=2,$.prototype.collisionTable=[Ut,Gt,te],et.prototype.collisionTable=[null,function(t,e){return Vt},$t],nt.prototype.collisionTable=[null,null,Zt];var ee=cp.collideShapes=function(t,e){return r(t.collisionCode<=e.collisionCode,"Collided shapes must be sorted by type"),t.collisionTable[e.collisionCode](t,e)},ie=new Mt,ne=cp.Space=function(){this.stamp=0,this.curr_dt=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new pt(null),this.activeShapes=new pt(this.staticShapes),this.arbiters=[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=ie,this.postStepCallbacks=[],this.iterations=10,this.gravity=C,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new st(1/0,1/0),this.staticBody.nodeIdleTime=1/0,this.collideShapes=this.makeCollideShapes()};ne.prototype.getCurrentTimeStep=function(){return this.curr_dt},ne.prototype.setIterations=function(t){this.iterations=t},ne.prototype.isLocked=function(){return this.locked};var oe=function(t){r(!t.locked,"This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.")};ne.prototype.addCollisionHandler=function(t,e,i,n,o,r){oe(this),this.removeCollisionHandler(t,e);var s=new Mt;s.a=t,s.b=e,i&&(s.begin=i),n&&(s.preSolve=n),o&&(s.postSolve=o),r&&(s.separate=r),this.collisionHandlers[h(t,e)]=s},ne.prototype.removeCollisionHandler=function(t,e){oe(this),delete this.collisionHandlers[h(t,e)]},ne.prototype.setDefaultCollisionHandler=function(t,e,i,n){oe(this);var o=new Mt;t&&(o.begin=t),e&&(o.preSolve=e),i&&(o.postSolve=i),n&&(o.separate=n),this.defaultHandler=o},ne.prototype.lookupHandler=function(t,e){return this.collisionHandlers[h(t,e)]||this.defaultHandler},ne.prototype.addShape=function(t){var e=t.body;return e.isStatic()?this.addStaticShape(t):(r(!t.space,"This shape is already added to a space and cannot be added to another."),oe(this),e.activate(),e.addShape(t),t.update(e.p,e.rot),this.activeShapes.insert(t,t.hashid),t.space=this,t)},ne.prototype.addStaticShape=function(t){r(!t.space,"This shape is already added to a space and cannot be added to another."),oe(this);var e=t.body;return e.addShape(t),t.update(e.p,e.rot),this.staticShapes.insert(t,t.hashid),t.space=this,t},ne.prototype.addBody=function(t){return r(!t.isStatic(),"Static bodies cannot be added to a space as they are not meant to be simulated."),r(!t.space,"This body is already added to a space and cannot be added to another."),oe(this),this.bodies.push(t),t.space=this,t},ne.prototype.addConstraint=function(t){r(!t.space,"This shape is already added to a space and cannot be added to another."),
oe(this);var e=t.a,i=t.b;return e.activate(),i.activate(),this.constraints.push(t),t.next_a=e.constraintList,e.constraintList=t,t.next_b=i.constraintList,i.constraintList=t,t.space=this,t},ne.prototype.filterArbiters=function(t,e){for(var i in this.cachedArbiters){var n=this.cachedArbiters[i];(t!==n.body_a||e!==n.a&&null!==e)&&(t!==n.body_b||e!==n.b&&null!==e)||(e&&"cached"!==n.state&&n.callSeparate(this),n.unthread(),l(this.arbiters,n),delete this.cachedArbiters[i])}},ne.prototype.removeShape=function(t){var e=t.body;e.isStatic()?this.removeStaticShape(t):(r(this.containsShape(t),"Cannot remove a shape that was not added to the space. (Removed twice maybe?)"),oe(this),e.activate(),e.removeShape(t),this.filterArbiters(e,t),this.activeShapes.remove(t,t.hashid),t.space=null)},ne.prototype.removeStaticShape=function(t){r(this.containsShape(t),"Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)"),oe(this);var e=t.body;e.isStatic()&&e.activateStatic(t),e.removeShape(t),this.filterArbiters(e,t),this.staticShapes.remove(t,t.hashid),t.space=null},ne.prototype.removeBody=function(t){r(this.containsBody(t),"Cannot remove a body that was not added to the space. (Removed twice maybe?)"),oe(this),t.activate(),l(this.bodies,t),t.space=null},ne.prototype.removeConstraint=function(t){r(this.containsConstraint(t),"Cannot remove a constraint that was not added to the space. (Removed twice maybe?)"),oe(this),t.a.activate(),t.b.activate(),l(this.constraints,t),t.a.removeConstraint(t),t.b.removeConstraint(t),t.space=null},ne.prototype.containsShape=function(t){return t.space===this},ne.prototype.containsBody=function(t){return t.space==this},ne.prototype.containsConstraint=function(t){return t.space==this},ne.prototype.uncacheArbiter=function(t){delete this.cachedArbiters[h(t.a.hashid,t.b.hashid)],l(this.arbiters,t)},ne.prototype.eachBody=function(t){this.lock();for(var e=this.bodies,i=0;i<e.length;i++)t(e[i]);for(var n=this.sleepingComponents,i=0;i<n.length;i++)for(var o=n[i],r=o;r;){var s=r.nodeNext;t(r),r=s}this.unlock(!0)},ne.prototype.eachShape=function(t){this.lock(),this.activeShapes.each(t),this.staticShapes.each(t),this.unlock(!0)},ne.prototype.eachConstraint=function(t){this.lock();for(var e=this.constraints,i=0;i<e.length;i++)t(e[i]);this.unlock(!0)},ne.prototype.reindexStatic=function(){r(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete."),this.staticShapes.each(function(t){var e=t.body;t.update(e.p,e.rot)}),this.staticShapes.reindex()},ne.prototype.reindexShape=function(t){r(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.");var e=t.body;t.update(e.p,e.rot),this.activeShapes.reindexObject(t,t.hashid),this.staticShapes.reindexObject(t,t.hashid)},ne.prototype.reindexShapesForBody=function(t){for(var e=t.shapeList;e;e=e.next)this.reindexShape(e)},ne.prototype.useSpatialHash=function(t,e){throw new Error("Spatial Hash not implemented.")},ne.prototype.activateBody=function(t){if(r(!t.isRogue(),"Internal error: Attempting to activate a rogue body."),this.locked)-1===this.rousedBodies.indexOf(t)&&this.rousedBodies.push(t);else{this.bodies.push(t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.staticShapes.remove(i,i.hashid),this.activeShapes.insert(i,i.hashid)}for(var n=t.arbiterList;n;n=n.next(t)){var o=n.body_a;if(t===o||o.isStatic()){var s=n.a,c=n.b;this.cachedArbiters[h(s.hashid,c.hashid)]=n,n.stamp=this.stamp,n.handler=this.lookupHandler(s.collision_type,c.collision_type),this.arbiters.push(n)}}for(var a=t.constraintList;a;a=a.nodeNext){var o=a.a;(t===o||o.isStatic())&&this.constraints.push(a)}}},ne.prototype.deactivateBody=function(t){r(!t.isRogue(),"Internal error: Attempting to deactivate a rogue body."),l(this.bodies,t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.activeShapes.remove(i,i.hashid),this.staticShapes.insert(i,i.hashid)}for(var n=t.arbiterList;n;n=n.next(t)){var o=n.body_a;(t===o||o.isStatic())&&this.uncacheArbiter(n)}for(var s=t.constraintList;s;s=s.nodeNext){var o=s.a;(t===o||o.isStatic())&&l(this.constraints,s)}};var re=function(t){return t?t.nodeRoot:null},se=function(t){if(t&&t.isSleeping(t)){r(!t.isRogue(),"Internal Error: componentActivate() called on a rogue body.");for(var e=t.space,i=t;i;){var n=i.nodeNext;i.nodeIdleTime=0,i.nodeRoot=null,i.nodeNext=null,e.activateBody(i),i=n}l(e.sleepingComponents,t)}};st.prototype.activate=function(){this.isRogue()||(this.nodeIdleTime=0,se(re(this)))},st.prototype.activateStatic=function(t){r(this.isStatic(),"Body.activateStatic() called on a non-static body.");for(var e=this.arbiterList;e;e=e.next(this))t&&t!=e.a&&t!=e.b||(e.body_a==this?e.body_b:e.body_a).activate()},st.prototype.pushArbiter=function(t){s(null===(t.body_a===this?t.thread_a_next:t.thread_b_next),"Internal Error: Dangling contact graph pointers detected. (A)"),s(null===(t.body_a===this?t.thread_a_prev:t.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (B)");var e=this.arbiterList;s(null===e||null===(e.body_a===this?e.thread_a_prev:e.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (C)"),t.body_a===this?t.thread_a_next=e:t.thread_b_next=e,e&&(e.body_a===this?e.thread_a_prev=t:e.thread_b_prev=t),this.arbiterList=t};var ce=function(t,e){e.nodeRoot=t,e!==t&&(e.nodeNext=t.nodeNext,t.nodeNext=e)},ae=function(t,e){if(!e.isRogue()){var i=re(e);if(null==i){ce(t,e);for(var n=e.arbiterList;n;n=n.next(e))ae(t,e==n.body_a?n.body_b:n.body_a);for(var o=e.constraintList;o;o=o.next(e))ae(t,e==o.a?o.b:o.a)}else s(i===t,"Internal Error: Inconsistency detected in the contact graph.")}},he=function(t,e){for(var i=t;i;i=i.nodeNext)if(i.nodeIdleTime<e)return!0;return!1};ne.prototype.processComponents=function(t){for(var e=this.sleepTimeThreshold!==1/0,i=this.bodies,n=0;n<i.length;n++){var o=i[n];s(null===o.nodeNext,"Internal Error: Dangling next pointer detected in contact graph."),s(null===o.nodeRoot,"Internal Error: Dangling root pointer detected in contact graph.")}if(e)for(var r=this.idleSpeedThreshold,c=r?r*r:F(this.gravity)*t*t,n=0;n<i.length;n++){var o=i[n],a=c?o.m*c:0;o.nodeIdleTime=o.kineticEnergy()>a?0:o.nodeIdleTime+t}for(var h=this.arbiters,n=0,l=h.length;l>n;n++){var u=h[n],d=u.body_a,p=u.body_b;e&&((p.isRogue()&&!p.isStatic()||d.isSleeping())&&d.activate(),(d.isRogue()&&!d.isStatic()||p.isSleeping())&&p.activate()),d.pushArbiter(u),p.pushArbiter(u)}if(e){for(var _=this.constraints,n=0;n<_.length;n++){var f=_[n],d=f.a,p=f.b;p.isRogue()&&!p.isStatic()&&d.activate(),d.isRogue()&&!d.isStatic()&&p.activate()}for(var n=0;n<i.length;){var o=i[n];if(null!==re(o)||(ae(o,o),he(o,this.sleepTimeThreshold)))n++,o.nodeRoot=null,o.nodeNext=null;else{this.sleepingComponents.push(o);for(var g=o;g;g=g.nodeNext)this.deactivateBody(g)}}}},st.prototype.sleep=function(){this.sleepWithGroup(null)},st.prototype.sleepWithGroup=function(t){r(!this.isStatic()&&!this.isRogue(),"Rogue and static bodies cannot be put to sleep.");var e=this.space;if(r(e,"Cannot put a rogue body to sleep."),r(!e.locked,"Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback."),r(null===t||t.isSleeping(),"Cannot use a non-sleeping body as a group identifier."),this.isSleeping())return void r(re(this)===re(t),"The body is already sleeping and it's group cannot be reassigned.");for(var i=0;i<this.shapeList.length;i++)this.shapeList[i].update(this.p,this.rot);if(e.deactivateBody(this),t){var n=re(t);this.nodeRoot=n,this.nodeNext=n.nodeNext,this.nodeIdleTime=0,n.nodeNext=this}else this.nodeRoot=this,this.nodeNext=null,this.nodeIdleTime=0,e.sleepingComponents.push(this);l(e.bodies,this)},ne.prototype.activateShapesTouchingShape=function(t){this.sleepTimeThreshold!==1/0&&this.shapeQuery(t,function(t,e){t.body.activate()})},ne.prototype.pointQuery=function(t,e,i,n){var o=function(o){(!o.group||i!==o.group)&&e&o.layers&&o.pointQuery(t)&&n(o)},r=new G(t.x,t.y,t.x,t.y);this.lock(),this.activeShapes.query(r,o),this.staticShapes.query(r,o),this.unlock(!0)},ne.prototype.pointQueryFirst=function(t,e,i){var n=null;return this.pointQuery(t,e,i,function(t){t.sensor||(n=t)}),n},ne.prototype.nearestPointQuery=function(t,e,i,n,o){var r=function(r){if((!r.group||n!==r.group)&&i&r.layers){var s=r.nearestPointQuery(t);s.d<e&&o(r,s.d,s.p)}},s=Y(t,e);this.lock(),this.activeShapes.query(s,r),this.staticShapes.query(s,r),this.unlock(!0)},ne.prototype.nearestPointQueryNearest=function(t,e,i,n){var o,r=function(r){if((!r.group||n!==r.group)&&i&r.layers&&!r.sensor){var s=r.nearestPointQuery(t);s.d<e&&(!o||s.d<o.d)&&(o=s)}},s=Y(t,e);return this.activeShapes.query(s,r),this.staticShapes.query(s,r),o},ne.prototype.segmentQuery=function(t,e,i,n,o){var r=function(r){var s;return(!r.group||n!==r.group)&&i&r.layers&&(s=r.segmentQuery(t,e))&&o(r,s.t,s.n),1};this.lock(),this.staticShapes.segmentQuery(t,e,1,r),this.activeShapes.segmentQuery(t,e,1,r),this.unlock(!0)},ne.prototype.segmentQueryFirst=function(t,e,i,n){var o=null,r=function(r){var s;return(!r.group||n!==r.group)&&i&r.layers&&!r.sensor&&(s=r.segmentQuery(t,e))&&(null===o||s.t<o.t)&&(o=s),o?o.t:1};return this.staticShapes.segmentQuery(t,e,1,r),this.activeShapes.segmentQuery(t,e,o?o.t:1,r),o},ne.prototype.bbQuery=function(t,e,i,n){var o=function(o){(!o.group||i!==o.group)&&e&o.layers&&X(t,o.bb_l,o.bb_b,o.bb_r,o.bb_t)&&n(o)};this.lock(),this.activeShapes.query(t,o),this.staticShapes.query(t,o),this.unlock(!0)},ne.prototype.shapeQuery=function(t,e){var i=t.body;i&&t.update(i.p,i.rot);var n=new G(t.bb_l,t.bb_b,t.bb_r,t.bb_t),o=!1,r=function(i){var n=t;if((!n.group||n.group!==i.group)&&n.layers&i.layers&&n!==i){var r;if(n.collisionCode<=i.collisionCode)r=ee(n,i);else{r=ee(i,n);for(var s=0;s<r.length;s++)r[s].n=O(r[s].n)}if(r.length&&(o=!(n.sensor||i.sensor),e)){for(var c=new Array(r.length),s=0;s<r.length;s++)c[s]=new Bt(r[s].p,r[s].n,r[s].dist);e(i,c)}}};return this.lock(),this.activeShapes.query(n,r),this.staticShapes.query(n,r),this.unlock(!0),o},ne.prototype.addPostStepCallback=function(t){s(this.locked,"Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query."),this.postStepCallbacks.push(t)},ne.prototype.runPostStepCallbacks=function(){for(var t=0;t<this.postStepCallbacks.length;t++)this.postStepCallbacks[t]();this.postStepCallbacks=[]},ne.prototype.lock=function(){this.locked++},ne.prototype.unlock=function(t){if(this.locked--,r(this.locked>=0,"Internal Error: Space lock underflow."),0===this.locked&&t){for(var e=this.rousedBodies,i=0;i<e.length;i++)this.activateBody(e[i]);e.length=0,this.runPostStepCallbacks()}},ne.prototype.makeCollideShapes=function(){var t=this;return function(e,i){var n=t;if(e.bb_l<=i.bb_r&&i.bb_l<=e.bb_r&&e.bb_b<=i.bb_t&&i.bb_b<=e.bb_t&&e.body!==i.body&&(!e.group||e.group!==i.group)&&e.layers&i.layers){var o=n.lookupHandler(e.collision_type,i.collision_type),r=e.sensor||i.sensor;if(!r||o!==ie){if(e.collisionCode>i.collisionCode){var s=e;e=i,i=s}var c=ee(e,i);if(0!==c.length){var a=h(e.hashid,i.hashid),l=n.cachedArbiters[a];l||(l=n.cachedArbiters[a]=new Ft(e,i)),l.update(c,o,e,i),"first coll"!=l.state||o.begin(l,n)||l.ignore(),"ignore"!==l.state&&o.preSolve(l,n)&&!r?n.arbiters.push(l):(l.contacts=null,"ignore"!==l.state&&(l.state="normal")),l.stamp=n.stamp}}}}},ne.prototype.arbiterSetFilter=function(t){var e=this.stamp-t.stamp,i=t.body_a,n=t.body_b;return(i.isStatic()||i.isSleeping())&&(n.isStatic()||n.isSleeping())?!0:(e>=1&&"cached"!=t.state&&(t.callSeparate(this),t.state="cached"),e>=this.collisionPersistence?(t.contacts=null,!1):!0)};var le=function(t){var e=t.body;t.update(e.p,e.rot)};ne.prototype.step=function(t){if(0!==t){r(0===C.x&&0===C.y,"vzero is invalid"),this.stamp++;var e=this.curr_dt;this.curr_dt=t;var i,n,o,s=this.bodies,c=this.constraints,a=this.arbiters;for(i=0;i<a.length;i++){var h=a[i];h.state="normal",h.body_a.isSleeping()||h.body_b.isSleeping()||h.unthread()}for(a.length=0,this.lock(),i=0;i<s.length;i++)s[i].position_func(t);this.activeShapes.each(le),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(t),this.lock();for(o in this.cachedArbiters)this.arbiterSetFilter(this.cachedArbiters[o])||delete this.cachedArbiters[o];var l=this.collisionSlop,u=1-Math.pow(this.collisionBias,t);for(i=0;i<a.length;i++)a[i].preStep(t,l,u);for(i=0;i<c.length;i++){var d=c[i];d.preSolve(this),d.preStep(t)}var p=Math.pow(this.damping,t),_=this.gravity;for(i=0;i<s.length;i++)s[i].velocity_func(_,p,t);var f=0===e?0:t/e;for(i=0;i<a.length;i++)a[i].applyCachedImpulse(f);for(i=0;i<c.length;i++)c[i].applyCachedImpulse(f);for(i=0;i<this.iterations;i++){for(n=0;n<a.length;n++)a[n].applyImpulse();for(n=0;n<c.length;n++)c[n].applyImpulse()}for(i=0;i<c.length;i++)c[i].postSolve(this);for(i=0;i<a.length;i++)a[i].handler.postSolve(a[i],this);this.unlock(!0)}};var ue=function(t,e,i,n){var o=t.vx+-i.y*t.w,r=t.vy+i.x*t.w,s=e.vx+-n.y*e.w,c=e.vy+n.x*e.w;return new y(s-o,c-r)},de=function(t,e,i,n,o){var r=t.vx+-i.y*t.w,s=t.vy+i.x*t.w,c=e.vx+-n.y*e.w,a=e.vy+n.x*e.w;return b(c-r,a-s,o.x,o.y)},pe=function(t,e,i,n){t.vx+=e*t.m_inv,t.vy+=i*t.m_inv,t.w+=t.i_inv*(n.x*i-n.y*e)},_e=function(t,e,i,n,o,r){pe(t,-o,-r,i),pe(e,o,r,n)},fe=function(t,e,i,n){t.v_biasx+=e*t.m_inv,t.v_biasy+=i*t.m_inv,t.w_bias+=t.i_inv*I(n.x,n.y,e,i)},ge=function(t,e,i){var n=w(e,i);return t.m_inv+t.i_inv*n*n},ve=function(t,e,i,n,o){var r=ge(t,i,o)+ge(e,n,o);return s(0!==r,"Unsolvable collision or constraint."),r},me=function(t,e,i,n,o,r){var c,a,h,l,u=t.m_inv+e.m_inv;c=u,a=0,h=0,l=u;var d=t.i_inv,p=i.x*i.x*d,_=i.y*i.y*d,f=-i.x*i.y*d;c+=_,a+=f,h+=f,l+=p;var g=e.i_inv,v=n.x*n.x*g,m=n.y*n.y*g,y=-n.x*n.y*g;c+=m,a+=y,h+=y,l+=v;var C=c*l-a*h;s(0!==C,"Unsolvable constraint.");var T=1/C;o.x=l*T,o.y=-a*T,r.x=-h*T,r.y=c*T},ye=function(t,e,i){return new y(T(t,e),T(t,i))},Ce=function(t,e){return 1-Math.pow(t,e)},Te=cp.Constraint=function(t,e){this.a=t,this.b=e,this.space=null,this.next_a=null,this.next_b=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0};Te.prototype.activateBodies=function(){this.a&&this.a.activate(),this.b&&this.b.activate()},Te.prototype.preStep=function(t){},Te.prototype.applyCachedImpulse=function(t){},Te.prototype.applyImpulse=function(){},Te.prototype.getImpulse=function(){return 0},Te.prototype.preSolve=function(t){},Te.prototype.postSolve=function(t){},Te.prototype.next=function(t){return this.a===t?this.next_a:this.next_b};var be=cp.PinJoint=function(t,e,i,n){Te.call(this,t,e),this.anchr1=i,this.anchr2=n;var o=t?A(t.p,R(i,t.rot)):i,r=e?A(e.p,R(n,e.rot)):n;this.dist=E(x(r,o)),s(this.dist>0,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.r1=this.r2=null,this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};be.prototype=Object.create(Te.prototype),be.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot);var n=x(A(i.p,this.r2),A(e.p,this.r1)),o=E(n);this.n=N(n,1/(o?o:1/0)),this.nMass=1/ve(e,i,this.r1,this.r2,this.n);var r=this.maxBias;this.bias=v(-Ce(this.errorBias,t)*(o-this.dist)/t,-r,r),this.jnMax=this.maxForce*t},be.prototype.applyCachedImpulse=function(t){var e=N(this.n,this.jnAcc*t);_e(this.a,this.b,this.r1,this.r2,e.x,e.y)},be.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=de(t,e,this.r1,this.r2,i),o=(this.bias-n)*this.nMass,r=this.jnAcc;this.jnAcc=v(r+o,-this.jnMax,this.jnMax),o=this.jnAcc-r,_e(t,e,this.r1,this.r2,i.x*o,i.y*o)},be.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Ee=cp.SlideJoint=function(t,e,i,n,o,r){Te.call(this,t,e),this.anchr1=i,this.anchr2=n,this.min=o,this.max=r,this.r1=this.r2=this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};Ee.prototype=Object.create(Te.prototype),Ee.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot);var n=x(A(i.p,this.r2),A(e.p,this.r1)),o=E(n),r=0;o>this.max?(r=o-this.max,this.n=k(n)):o<this.min?(r=this.min-o,this.n=O(k(n))):(this.n=C,this.jnAcc=0),this.nMass=1/ve(e,i,this.r1,this.r2,this.n);var s=this.maxBias;this.bias=v(-Ce(this.errorBias,t)*r/t,-s,s),this.jnMax=this.maxForce*t},Ee.prototype.applyCachedImpulse=function(t){var e=this.jnAcc*t;_e(this.a,this.b,this.r1,this.r2,this.n.x*e,this.n.y*e)},Ee.prototype.applyImpulse=function(){if(0!==this.n.x||0!==this.n.y){var t=this.a,e=this.b,i=this.n,n=this.r1,o=this.r2,r=ue(t,e,n,o),s=T(r,i),c=(this.bias-s)*this.nMass,a=this.jnAcc;this.jnAcc=v(a+c,-this.jnMax,0),c=this.jnAcc-a,_e(t,e,this.r1,this.r2,i.x*c,i.y*c)}},Ee.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Se=cp.PivotJoint=function(t,e,i,n){if(Te.call(this,t,e),"undefined"==typeof n){var o=i;i=t?t.world2Local(o):o,n=e?e.world2Local(o):o}this.anchr1=i,this.anchr2=n,this.r1=this.r2=C,this.k1=new y(0,0),this.k2=new y(0,0),this.jAcc=C,this.jMaxLen=0,this.bias=C};Se.prototype=Object.create(Te.prototype),Se.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot),me(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var n=x(A(i.p,this.r2),A(e.p,this.r1));this.bias=W(N(n,-Ce(this.errorBias,t)/t),this.maxBias)},Se.prototype.applyCachedImpulse=function(t){_e(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Se.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,o=ue(t,e,i,n),r=ye(x(this.bias,o),this.k1,this.k2),s=this.jAcc;this.jAcc=W(A(this.jAcc,r),this.jMaxLen),_e(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},Se.prototype.getImpulse=function(){return E(this.jAcc)};var Ae=cp.GrooveJoint=function(t,e,i,n,o){Te.call(this,t,e),this.grv_a=i,this.grv_b=n,this.grv_n=P(z(x(n,i))),this.anchr2=o,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new y(0,0),this.k2=new y(0,0),this.jAcc=C,this.jMaxLen=0,this.bias=null};Ae.prototype=Object.create(Te.prototype),Ae.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.local2World(this.grv_a),o=e.local2World(this.grv_b),r=R(this.grv_n,e.rot),s=T(n,r);this.grv_tn=r,this.r2=R(this.anchr2,i.rot);var c=w(A(i.p,this.r2),r);c<=w(n,r)?(this.clamp=1,this.r1=x(n,e.p)):c>=w(o,r)?(this.clamp=-1,this.r1=x(o,e.p)):(this.clamp=0,this.r1=x(A(N(P(r),-c),N(r,s)),e.p)),me(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var a=x(A(i.p,this.r2),A(e.p,this.r1));this.bias=W(N(a,-Ce(this.errorBias,t)/t),this.maxBias)},Ae.prototype.applyCachedImpulse=function(t){_e(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Ae.prototype.grooveConstrain=function(t){var e=this.grv_tn,i=this.clamp*w(t,e)>0?t:L(t,e);return W(i,this.jMaxLen)},Ae.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,o=ue(t,e,i,n),r=ye(x(this.bias,o),this.k1,this.k2),s=this.jAcc;this.jAcc=this.grooveConstrain(A(s,r)),_e(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},Ae.prototype.getImpulse=function(){return E(this.jAcc)},Ae.prototype.setGrooveA=function(t){this.grv_a=t,this.grv_n=P(z(x(this.grv_b,t))),this.activateBodies()},Ae.prototype.setGrooveB=function(t){this.grv_b=t,this.grv_n=P(z(x(t,this.grv_a))),this.activateBodies()};var xe=function(t,e){return(t.restLength-e)*t.stiffness},Oe=cp.DampedSpring=function(t,e,i,n,o,r,s){Te.call(this,t,e),this.anchr1=i,this.anchr2=n,this.restLength=o,this.stiffness=r,this.damping=s,this.springForceFunc=xe,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null};Oe.prototype=Object.create(Te.prototype),Oe.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=R(this.anchr1,e.rot),this.r2=R(this.anchr2,i.rot);var n=x(A(i.p,this.r2),A(e.p,this.r1)),o=E(n);this.n=N(n,1/(o?o:1/0));var r=ve(e,i,this.r1,this.r2,this.n);s(0!==r,"Unsolvable this."),this.nMass=1/r,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*t*r);var c=this.springForceFunc(this,o);_e(e,i,this.r1,this.r2,this.n.x*c*t,this.n.y*c*t)},Oe.prototype.applyCachedImpulse=function(t){},Oe.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=this.r1,o=this.r2,r=de(t,e,n,o,i),s=(this.target_vrn-r)*this.v_coef;this.target_vrn=r+s,s*=this.nMass,_e(t,e,this.r1,this.r2,this.n.x*s,this.n.y*s)},Oe.prototype.getImpulse=function(){return 0};var Ne=function(t,e){return(e-t.restAngle)*t.stiffness},we=cp.DampedRotarySpring=function(t,e,i,n,o){Te.call(this,t,e),this.restAngle=i,this.stiffness=n,this.damping=o,this.springTorqueFunc=Ne,this.target_wrn=0,this.w_coef=0,this.iSum=0};we.prototype=Object.create(Te.prototype),we.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.i_inv+i.i_inv;s(0!==n,"Unsolvable spring."),this.iSum=1/n,this.w_coef=1-Math.exp(-this.damping*t*n),this.target_wrn=0;var o=this.springTorqueFunc(this,e.a-i.a)*t;e.w-=o*e.i_inv,i.w+=o*i.i_inv},we.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=t.w-e.w,n=(this.target_wrn-i)*this.w_coef;this.target_wrn=i+n;var o=n*this.iSum;t.w+=o*t.i_inv,e.w-=o*e.i_inv};var Ie=cp.RotaryLimitJoint=function(t,e,i,n){Te.call(this,t,e),this.min=i,this.max=n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Ie.prototype=Object.create(Te.prototype),Ie.prototype.preStep=function(t){var e=this.a,i=this.b,n=i.a-e.a,o=0;n>this.max?o=this.max-n:n<this.min&&(o=this.min-n),this.iSum=1/(1/e.i+1/i.i);var r=this.maxBias;this.bias=v(-Ce(this.errorBias,t)*o/t,-r,r),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},Ie.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Ie.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=-(this.bias+i)*this.iSum,o=this.jAcc;this.bias<0?this.jAcc=v(o+n,0,this.jMax):this.jAcc=v(o+n,-this.jMax,0),n=this.jAcc-o,t.w-=n*t.i_inv,e.w+=n*e.i_inv}},Ie.prototype.getImpulse=function(){return Math.abs(joint.jAcc)};var Pe=cp.RatchetJoint=function(t,e,i,n){Te.call(this,t,e),this.angle=0,this.phase=i,this.ratchet=n,this.angle=(e?e.a:0)-(t?t.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0};Pe.prototype=Object.create(Te.prototype),Pe.prototype.preStep=function(t){var e=this.a,i=this.b,n=this.angle,o=this.phase,r=this.ratchet,s=i.a-e.a,c=n-s,a=0;c*r>0?a=c:this.angle=Math.floor((s-o)/r)*r+o,this.iSum=1/(e.i_inv+i.i_inv);var h=this.maxBias;this.bias=v(-Ce(this.errorBias,t)*a/t,-h,h),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},Pe.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Pe.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=this.ratchet,o=-(this.bias+i)*this.iSum,r=this.jAcc;this.jAcc=v((r+o)*n,0,this.jMax*Math.abs(n))/n,o=this.jAcc-r,t.w-=o*t.i_inv,e.w+=o*e.i_inv}},Pe.prototype.getImpulse=function(t){return Math.abs(t.jAcc)};var Le=cp.GearJoint=function(t,e,i,n){Te.call(this,t,e),this.phase=i,this.ratio=n,this.ratio_inv=1/n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Le.prototype=Object.create(Te.prototype),Le.prototype.preStep=function(t){var e=this.a,i=this.b;this.iSum=1/(e.i_inv*this.ratio_inv+this.ratio*i.i_inv);var n=this.maxBias;this.bias=v(-Ce(this.errorBias,t)*(i.a*this.ratio-e.a-this.phase)/t,-n,n),this.jMax=this.maxForce*t},Le.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv*this.ratio_inv,i.w+=n*i.i_inv},Le.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w*this.ratio-t.w,n=(this.bias-i)*this.iSum,o=this.jAcc;this.jAcc=v(o+n,-this.jMax,this.jMax),n=this.jAcc-o,t.w-=n*t.i_inv*this.ratio_inv,e.w+=n*e.i_inv},Le.prototype.getImpulse=function(){return Math.abs(this.jAcc)},Le.prototype.setRatio=function(t){this.ratio=t,this.ratio_inv=1/t,this.activateBodies()};var Re=cp.SimpleMotor=function(t,e,i){Te.call(this,t,e),this.rate=i,this.jAcc=0,this.iSum=this.jMax=0};Re.prototype=Object.create(Te.prototype),Re.prototype.preStep=function(t){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*t},Re.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Re.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w-t.w+this.rate,n=-i*this.iSum,o=this.jAcc;this.jAcc=v(o+n,-this.jMax,this.jMax),n=this.jAcc-o,t.w-=n*t.i_inv,e.w+=n*e.i_inv},Re.prototype.getImpulse=function(){return Math.abs(this.jAcc)}},{}],161:[function(require,module,exports){"use strict";var _engineNumberVersion=function(){var t=/Cocos2d\-JS\sv([\d]+)\.([\d]+)/.exec(cc.ENGINE_VERSION);return t&&t[1]?{major:parseInt(t[1]),minor:parseInt(t[2])}:null}();_engineNumberVersion&&3===_engineNumberVersion.major&&(_engineNumberVersion.minor<6&&require("./versions/jsb-polyfill-v3.5"),_engineNumberVersion.minor<9&&require("./versions/jsb-polyfill-v3.8"),_engineNumberVersion.minor<10&&require("./versions/jsb-polyfill-v3.9"));var originLog=console.log;cc.initEngine=function(t,e){require("script/jsb.js"),cc._renderType=cc.game.RENDER_TYPE_OPENGL,cc._engineLoaded=!0,originLog(cc.ENGINE_VERSION),e&&e()};try{console.log=function(){originLog.call(console,cc.js.formatStr.apply(null,arguments))}}catch(e){}eval('if(typeof CC_TEST=="undefined")window.CC_TEST=typeof describe!="undefined"||typeof QUnit=="object";if(typeof CC_EDITOR=="undefined")window.CC_EDITOR=typeof Editor=="object"&&typeof process=="object"&&"electron" in process.versions;if(typeof CC_DEV=="undefined")window.CC_DEV=CC_EDITOR||CC_TEST;if(typeof CC_JSB=="undefined")window.CC_JSB=true;'),require("./jsb-predefine"),require("./jsb-loader"),require("./jsb-game"),require("./jsb-director"),require("./jsb-tex-sprite-frame"),require("./jsb-scale9sprite"),require("./jsb-label"),require("./jsb-editbox"),require("./jsb-videoplayer"),require("./jsb-webview.js"),require("./jsb-particle"),require("./jsb-spine"),require("./jsb-enums"),require("./jsb-event"),require("./jsb-action"),require("./jsb-etc"),require("./jsb-audio"),require("./jsb-tiledmap"),cc.runtime&&require("./versions/jsb-polyfill-runtime")},{"./jsb-action":162,"./jsb-audio":163,"./jsb-director":164,"./jsb-editbox":165,"./jsb-enums":166,"./jsb-etc":167,"./jsb-event":168,"./jsb-game":169,"./jsb-label":170,"./jsb-loader":171,"./jsb-particle":172,"./jsb-predefine":173,"./jsb-scale9sprite":174,"./jsb-spine":175,"./jsb-tex-sprite-frame":176,"./jsb-tiledmap":177,"./jsb-videoplayer":178,"./jsb-webview.js":179,"./versions/jsb-polyfill-runtime":180,"./versions/jsb-polyfill-v3.5":181,"./versions/jsb-polyfill-v3.8":182,"./versions/jsb-polyfill-v3.9":183,"script/jsb.js":void 0}],162:[function(t,e,i){function n(t){var e=t._ctor;t._ctor=function(){e.apply(this,arguments),this.retain(),this._retained=!0}}function o(t,e){var i=t[0].toLowerCase()+t.substr(1);cc[i]=function(){var t=e.create.apply(this,arguments);return t.retain(),t._retained=!0,t}}function r(t,e,i){if(t)for(var n=t._owner.getComponentsInChildren(cc._SGComponent),o=0;o<n.length;++o){var r=n[o];r.enabled=e?!r.enabled:i}}function s(t,e){var i=t[e];t[e]=function(){this._retained&&(this.release(),this._retained=!1);var t=i.apply(this,arguments);return t.retain(),t._retained=!0,t}}function c(t){return t instanceof cc.Component?t=t.node._sgNode:t instanceof cc.Node?t=t._sgNode:t instanceof _ccsg.Node||(t=null),t}function a(t,e){var i=cc.ActionManager.prototype,n=i[t];i[t]=function(){return arguments[e]=c(arguments[e]),arguments[e]?n.apply(this,arguments):void 0}}function h(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&(e._owner.x=e.getPositionX(),e._owner.y=e.getPositionY())}function l(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&(e._owner.rotation=e.getRotation())}function u(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&(e._owner.scaleX=e.getScaleX(),e._owner.scaleY=e.getScaleY())}function d(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&e._owner.removeFromParent()}function p(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&(e._owner.skewX=e.getSkewX(),e._owner.skewY=e.getSkewY())}function _(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&(e._owner.opacity=e.getOpacity())}function f(t){this._jsbUpdate(t);var e=this.getTarget();e._owner&&(e._owner.color=e.getColor())}for(var g=["ActionEase","EaseExponentialIn","EaseExponentialOut","EaseExponentialInOut","EaseSineIn","EaseSineOut","EaseSineInOut","EaseBounce","EaseBounceIn","EaseBounceOut","EaseBounceInOut","EaseBackIn","EaseBackOut","EaseBackInOut","EaseRateAction","EaseIn","EaseElastic","EaseElasticIn","EaseElasticOut","EaseElasticInOut","RemoveSelf","FlipX","FlipY","Place","CallFunc","DelayTime","Sequence","Spawn","Speed","Repeat","RepeatForever","Follow","TargetedAction","Animate","OrbitCamera","GridAction","ProgressTo","ProgressFromTo","ActionInterval","RotateTo","RotateBy","MoveBy","MoveTo","SkewTo","SkewBy","JumpTo","JumpBy","ScaleTo","ScaleBy","Blink","FadeTo","FadeIn","FadeOut","TintTo","TintBy"],v=0;v<g.length;++v){var m=g[v],y=cc[m];if(y){var C=y.prototype;n(C),-1===m.indexOf("Ease")&&o(m,y)}}cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)},cc.TargetedAction.prototype._ctor=function(t,e){var i=t._sgNode||t;i._owner=t,e&&this.initWithTarget(i,e)},cc.follow=function(t,e){return new cc.Follow(t._sgNode,e)},cc.Follow.prototype.update=function(t){var e=this.getTarget();e._owner&&e._owner.setPosition(e.getPosition())};var T=cc.FlipX;cc.FlipX=T.extend({_flippedX:!1,ctor:function(t){T.prototype.ctor.call(this),this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=!!t,!0},update:function(t){var e=this.getTarget();e.scaleX=Math.abs(e.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){return new cc.FlipX(this._flippedX)}}),cc.flipX=function(t){return new cc.FlipX(t)};var b=cc.FlipY;cc.FlipY=b.extend({_flippedY:!1,ctor:function(t){b.prototype.ctor.call(this),this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=!!t,!0},update:function(t){var e=this.getTarget();e.scaleY=Math.abs(e.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){return new cc.FlipY(this._flippedY)}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Show.prototype.update=function(t){r(this.getTarget(),!1,!0)},cc.Hide.prototype.update=function(t){r(this.getTarget(),!1,!1)},cc.ToggleVisibility.prototype.update=function(t){r(this.getTarget(),!0)},cc.callFunc=function(t,e,i){var n=function(e,i){e&&(e=e._owner||e),t.call(this,e,i)},o=cc.CallFunc.create(n,e,i);return o.retain(),o._retained=!0,o},cc.CallFunc.prototype._ctor=function(t,e,i){if(void 0!==t){var n=function(e,i){e&&(e=e._owner||e),t.call(this,e,i)};void 0===e?this.initWithFunction(n):this.initWithFunction(n,e,i)}this.retain(),this._retained=!0},s(cc.ActionInterval.prototype,"repeat"),s(cc.ActionInterval.prototype,"repeatForever"),s(cc.ActionInterval.prototype,"easing");var E=cc.Node.prototype.runAction;cc.Node.prototype.runAction=function(t){return E.call(this,t),t._retained&&(t.release(),t._retained=!1),t};var S=cc.ActionManager.prototype.addAction;cc.ActionManager.prototype.addAction=function(t,e,i){e=c(e),e&&(S.call(this,t,e,i),t._retained&&(t.release(),t._retained=!1))};for(var A=[["removeAllActionsFromTarget",0],["removeActionByTag",1],["getActionByTag",1],["getNumberOfRunningActionsInTarget",0],["pauseTarget",0],["resumeTarget",0]],v=0;v<A.length;++v)a.apply(null,A[v]);cc.ActionManager.prototype.resumeTargets=function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},cc.ActionManager.prototype.pauseTargets=function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.pauseTarget(t[e])};var x={MoveBy:h,JumpBy:h,Place:h,CardinalSplineTo:h,RotateTo:l,RotateBy:l,ScaleTo:u,RemoveSelf:d,SkewTo:p,Blink:_,FadeIn:_,FadeOut:_,FadeTo:_,TintTo:f,TintBy:f,BezierBy:h};for(var O in x){var N=cc[O];N.prototype._jsbUpdate=N.prototype.update,N.prototype.update=x[O]}},{}],163:[function(t,e,i){cc.Audio=function(t){this.src=t,this.volume=1,this.loop=!1,
this.id=-1,this._eventList={},this.type=cc.Audio.Type.NATIVE},cc.Audio.Type={DOM:"AUDIO",WEBAUDIO:"WEBAUDIO",NATIVE:"NATIVE",UNKNOWN:"UNKNOWN"},function(e,i){cc.audioEngine=i,i.play=i.play2d,i.setMaxWebAudioSize=function(){};var n=t("../cocos2d/audio/deprecated");n.removed(i),n.deprecated(i),e.State=i.AudioState,e.play=function(){i.stop(this.id),this.id=i.play2d(this.src,this.loop,this.volume)},e.pause=function(){i.pause(this.id)},e.resume=function(){i.resume(this.id)},e.stop=function(){i.stop(this.id)},e.setLoop=function(t){this.loop=t,i.setLoop(this.id,t)},e.getLoop=function(){return i.getLoop(this.id)},e.setVolume=function(t){return this.volume=t,i.setVolume(this.id,t)},e.getVolume=function(){return i.getVolume(this.id)},e.setCurrentTime=function(t){i.setCurrentTime(this.id,t)},e.getCurrentTime=function(){return i.getCurrentTime(this.id)},e.getDuration=function(){return i.getDuration(this.id)},e.getState=function(){return i.getState(this.id)},e.preload=function(){this._loaded=!0,this.emit("load")},e.on=function(t,e){var i=this._eventList[t];i||(i=this._eventList[t]=[]),i.push(e)},e.once=function(t,e){var i=function(n){e.call(this,n),this.off(t,i)};this.on(t,i)},e.emit=function(t){var e=this._eventList[t];if(e)for(var i=0;i<e.length;i++)e[i].call(this,this)},e.off=function(t,e){var i=this._eventList[t];if(!i)return!1;if(!e)return this._eventList[t]=[],!0;for(var n=0;n<i.length;n++)if(i[n]===e){i.splice(n,1);break}return!0}}(cc.Audio.prototype,jsb.AudioEngine)},{"../cocos2d/audio/deprecated":21}],164:[function(t,e,i){"use strict";var n=t("../cocos2d/core/load-pipeline/auto-release-utils");cc.js.mixin(cc.director,{sharedInit:function(){cc.AnimationManager?(this._animationManager=new cc.AnimationManager,this.getScheduler().scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._animationManager=null,cc.CollisionManager?(this._collisionManager=new cc.CollisionManager,this.getScheduler().scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._collisionManager=null,cc._widgetManager.init(this)},reset:function(){this.purgeDirector(),cc.eventManager&&cc.eventManager.setEnabled(!0);var t=this.getActionManager();t&&this.getScheduler().scheduleUpdate(t,cc.Scheduler.PRIORITY_SYSTEM,!1),this._animationManager&&this.getScheduler().scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._collisionManager&&this.getScheduler().scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this.startAnimation()},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getScene:function(){return this._scene},runSceneImmediate:function(t,e,i){var o,r,s=cc.game,c=s._persistRootNodes;t instanceof cc.Scene&&t._load();for(o in c)r=c[o],s._ignoreRemovePersistNode=r,r.parent=null,s._ignoreRemovePersistNode=null;var a=this._scene,h=a&&a.autoReleaseAssets&&a.dependAssets;n.autoRelease(cc.loader,h,t.dependAssets),cc.isValid(a)&&a.destroy(),this._scene=null,cc.Object._deferredDestroy(),e&&e(),this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,t);var l=t;if(t instanceof cc.Scene){this._scene=t,l=t._sgNode;for(o in c){r=c[o];var u=t.getChildByUuid(o);if(u){var d=u.getSiblingIndex();u._destroyImmediate(),r.parent=t,r.setSiblingIndex(d)}else r.parent=t}t._activate()}this.getRunningScene()?this.replaceScene(l):this.runWithScene(l),i&&i(null,t),this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,t)},runScene:function(t,e,i){cc.assert(t,cc._LogInfos.Director.pushScene),t instanceof cc.Scene&&t._load(),this.once(cc.Director.EVENT_AFTER_UPDATE,function(){this.runSceneImmediate(t,e,i)})},_getSceneUuid:function(t){var e=cc.game._sceneInfos;if("string"==typeof t){t.endsWith(".fire")||(t+=".fire"),"/"===t[0]||t.startsWith("db://assets/")||(t="/"+t);for(var i=0;i<e.length;i++){var n=e[i];if(n.url.endsWith(t))return n}}else if("number"==typeof t){if(t>=0&&t<e.length)return e[t];cc.error("loadScene: The scene index to load (%s) is out of range.",t)}else cc.error('loadScene: Unknown name type to load: "%s"',t);return null},setRuntimeLaunchScene:function(t){var e=this._getSceneUuid(t);this._launchSceneUuid=e.uuid},loadScene:function(t,e,i){if(this._loadingScene)return cc.error('loadScene: Failed to load scene "%s" because "%s" is already loading',t,this._loadingScene),!1;var n=this._getSceneUuid(t);if(n){var o=n.uuid;if(this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),this._loadingScene=t,cc.runtime&&o!==this._launchSceneUuid){var r=this,s=cc.path.basename(n.url)+"_"+n.uuid;console.log("==> start preload: "+s);var c=!1;cc.LoaderLayer.preload([s],function(){console.log("==> end preload: "+s),c?r._loadSceneByUuid(o,e,i):setTimeout(function(){r._loadSceneByUuid(o,e,i)},0)}),c=!0}else this._loadSceneByUuid(o,e,i);return!0}return cc.error('loadScene: Can not load the scene "%s" because it was not in the build settings before playing.',t),!1},preloadScene:function(t,e){var i=this._getSceneUuid(t);if(i)this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),cc.loader.load({id:i.uuid,type:"uuid"},function(i,n){i&&cc.error('Failed to preload "%s", %s',t,i.message),e&&e(i,n)});else{var n='Can not preload the scene "'+t+'" because it is not in the build settings.';e(new Error(n)),cc.error("preloadScene: "+n)}},_loadSceneByUuid:function(t,e,i){cc.AssetLibrary.loadAsset(t,function(n,o){var r=cc.director;r._loadingScene="";var s;n?(n="Failed to load scene: "+n,cc.error(n)):o instanceof cc.SceneAsset?(s=o.scene,s._id=o._uuid,s._name=o._name,r.runSceneImmediate(s,i,e)):(n="The asset "+t+" is not a scene",cc.error(n),s=null),n&&e&&e(n)})}}),cc.EventTarget.call(cc.director),cc.js.addon(cc.director,cc.EventTarget.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.EVENT_BEFORE_VISIT="director_before_visit",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director.EVENT_COMPONENT_UPDATE="director_component_update",cc.Director.EVENT_COMPONENT_LATE_UPDATE="director_component_late_update",cc.eventManager.addCustomListener(cc.Director.EVENT_BEFORE_UPDATE,function(){var t=cc.director.getDeltaTime();cc.director.emit(cc.Director.EVENT_BEFORE_UPDATE),cc.director.emit(cc.Director.EVENT_COMPONENT_UPDATE,t)}),cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_UPDATE,function(){var t=cc.director.getDeltaTime();cc.director.emit(cc.Director.EVENT_COMPONENT_LATE_UPDATE,t),cc.director.emit(cc.Director.EVENT_AFTER_UPDATE),cc.Object._deferredDestroy(),cc.director.emit(cc.Director.EVENT_BEFORE_VISIT,this)}),cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_VISIT,function(){cc.director.emit(cc.Director.EVENT_AFTER_VISIT,this)}),cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_DRAW,function(){cc.director.emit(cc.Director.EVENT_AFTER_DRAW,this)})},{"../cocos2d/core/load-pipeline/auto-release-utils":92}],165:[function(t,e,i){"use strict";var n=cc.EditBox.prototype;n._setMaxLength=n.setMaxLength,n.setMaxLength=function(t){0>t&&(t=65535),this._setMaxLength(t)},cc.defineGetterSetter(n,"font",null,n.setFont),cc.defineGetterSetter(n,"fontName",null,n.setFontName),cc.defineGetterSetter(n,"fontSize",null,n.setFontSize),cc.defineGetterSetter(n,"fontColor",null,n.setFontColor),cc.defineGetterSetter(n,"string",n.getString,n.setString),cc.defineGetterSetter(n,"maxLength",n.getMaxLength,n.setMaxLength),cc.defineGetterSetter(n,"placeholder",n.getPlaceHolder,n.setPlaceHolder),cc.defineGetterSetter(n,"placeholderFont",null,n.setPlaceholderFont),cc.defineGetterSetter(n,"placeholderFontName",null,n.setPlaceholderFontName),cc.defineGetterSetter(n,"placeholderFontSize",null,n.setPlaceholderFontSize),cc.defineGetterSetter(n,"placeholderFontColor",null,n.setPlaceholderFontColor),cc.defineGetterSetter(n,"inputFlag",null,n.setInputFlag),cc.defineGetterSetter(n,"delegate",null,n.setDelegate),cc.defineGetterSetter(n,"inputMode",null,n.setInputMode),cc.defineGetterSetter(n,"returnType",null,n.setReturnType),n.setLineHeight=function(){},n.setTabIndex=function(){},n.getTabIndex=function(){return-1},n.setFocus=function(){},n.isFocused=function(){return!1},n.stayOnTop=function(){}},{}],166:[function(t,e,i){"use strict";cc.ProgressTimer.Type=cc.Enum({RADIAL:0,BAR:1}),cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(cc.VideoPlayer={}),cc.sys.os!==cc.sys.OS_OSX&&cc.sys.os!==cc.sys.OS_WINDOWS||(cc.WebView={}),cc.VideoPlayer.EventType={PLAYING:0,PAUSED:1,STOPPED:2,COMPLETED:3,META_LOADED:4,CLICKED:5,READY_TO_PLAY:6},cc.WebView.EventType={LOADING:0,LOADED:1,ERROR:2,JS_EVALUATED:3},cc.EditBox.InputMode=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),cc.EditBox.InputFlag=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5}),cc.EditBox.KeyboardReturnType=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4}),cc.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),ccui.RelativeLayoutParameter.Type=cc.Enum({NONE:0,PARENT_TOP_LEFT:1,PARENT_TOP_CENTER_HORIZONTAL:2,PARENT_TOP_RIGHT:3,PARENT_LEFT_CENTER_VERTICAL:4,CENTER_IN_PARENT:5,PARENT_RIGHT_CENTER_VERTICAL:6,PARENT_LEFT_BOTTOM:7,PARENT_BOTTOM_CENTER_HORIZONTAL:8,PARENT_RIGHT_BOTTOM:9,LOCATION_ABOVE_LEFTALIGN:10,LOCATION_ABOVE_CENTER:11,LOCATION_ABOVE_RIGHTALIGN:12,LOCATION_LEFT_OF_TOPALIGN:13,LOCATION_LEFT_OF_CENTER:14,LOCATION_LEFT_OF_BOTTOMALIGN:15,LOCATION_RIGHT_OF_TOPALIGN:16,LOCATION_RIGHT_OF_CENTER:17,LOCATION_RIGHT_OF_BOTTOMALIGN:18,LOCATION_BELOW_LEFTALIGN:19,LOCATION_BELOW_CENTER:20,LOCATION_BELOW_RIGHTALIGN:21}),ccui.Layout.Type=cc.Enum({ABSOLUTE:0,LINEAR_VERTICAL:1,LINEAR_HORIZONTAL:2,RELATIVE:3}),ccui.LoadingBar.Type=cc.Enum({LEFT:0,RIGHT:1}),ccui.ScrollView.Dir=cc.Enum({NONE:0,VERTICAL:1,HORIZONTAL:2,BOTH:3})},{}],167:[function(t,e,i){"use strict";cc.sys.now=function(){return Date.now()};var n=/[^\.\/]+\/\.\.\//;cc.js.mixin(cc.path,{_normalize:function(t){var e=t=String(t);do e=t,t=t.replace(n,"");while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",_setEndWithSep:function(t,e){var i=cc.path.sep;"undefined"==typeof e?e=!0:"string"==typeof e&&(i=e,e=!!e);var n=t[t.length-1],o="\\"===n||"/"===n;return!o&&e?t+=i:o&&!e&&(t=t.slice(0,-1)),t}}),cc.Scheduler.prototype.schedule=function(t,e,i,n,o,r){n=isFinite(n)?n:cc.macro.REPEAT_FOREVER,o=o||0,r=!!r,this.scheduleCallbackForTarget(e,t,i,n,o,r)},cc.Scheduler.prototype.scheduleUpdate=cc.Scheduler.prototype.scheduleUpdateForTarget,cc.Scheduler.prototype._unschedule=cc.Scheduler.prototype.unschedule,cc.Scheduler.prototype.unschedule=function(t,e){if("function"==typeof e){var i=e;e=t,t=i}this._unschedule(e,t)};var o=cc.Node.prototype;cc.defineGetterSetter(o,"_parent",o.getParent,o.setParent),cc.view.isViewReady=cc.view.isOpenGLReady,cc.view.setOrientation=function(){};var r=0,s={},c=function(t){this._intervalId=r++,this._code=t};c.prototype.fun=function(){if(this._code){var t=this._code;"string"==typeof t?Function(t)():"function"==typeof t&&t.apply(null,this._args)}},window.setTimeout=function(t,e){var i=new c(t);arguments.length>2&&(i._args=Array.prototype.slice.call(arguments,2));var n=i.fun;return i.fun=function(){n.apply(this,arguments),clearTimeout(i._intervalId)},cc.director.getScheduler()._schedule(i.fun,i,e/1e3,0,0,!1,i._intervalId+""),s[i._intervalId]=i,i._intervalId},window.setInterval=function(t,e){var i=new c(t);return arguments.length>2&&(i._args=Array.prototype.slice.call(arguments,2)),cc.director.getScheduler()._schedule(i.fun,i,e/1e3,cc.REPEAT_FOREVER,0,!1,i._intervalId+""),s[i._intervalId]=i,i._intervalId},window.clearInterval=function(t){var e=s[t];e&&(cc.director.getScheduler()._unschedule(e._intervalId+"",e),delete s[t])},window.clearTimeout=clearInterval,window.SocketIO&&(window.io=window.SocketIO),SocketIO.prototype._jsbEmit=SocketIO.prototype.emit,SocketIO.prototype.emit=function(t,e){"object"==typeof e&&(e=JSON.stringify(e)),this._jsbEmit(t,e)},cc.Node.prototype.setIgnoreAnchorPointForPosition=cc.Node.prototype.ignoreAnchorPointForPosition,window._ccsg={Node:cc.Node,Scene:cc.Scene,Sprite:cc.Sprite,ParticleSystem:cc.ParticleSystem,Label:cc.Label,EditBox:cc.EditBox,VideoPlayer:cc.VideoPlayer,WebView:cc.WebView,TMXTiledMap:cc.TMXTiledMap,TMXObjectGroup:cc.TMXObjectGroup,TMXObject:cc.TMXObject,TMXObjectImage:cc.TMXObjetImage,TMXObjectShape:cc.TMXObjectShape,TMXLayer:cc.TMXLayer,MotionStreak:cc.MotionStreak},window.__errorHandler=function(t){},cc._Class=cc.Class,cc.formatStr=cc.js.formatStr,cc.Image&&cc.Image.setPNGPremultipliedAlphaEnabled&&cc.Image.setPNGPremultipliedAlphaEnabled(!1)},{}],168:[function(t,e,i){"use strict";cc.Event.NO_TYPE="no_type",cc.Event.NONE=0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3,cc.Event.EventMouse=cc.EventMouse,cc.Event.EventTouch=cc.EventTouch,cc.Event.EventAcceleration=cc.EventAcceleration,cc.Event.EventKeyboard=cc.EventKeyboard;var n=cc.Event.prototype;n._getCurrentTarget=n.getCurrentTarget,n.getCurrentTarget=function(){return this._currentTarget||this._getCurrentTarget()},n._stopPropagation=n.stopPropagation,n.stopPropagation=function(){this._propagationStopped=!0,this._stopPropagation()},n._isStopped=n.isStopped,n.isStopped=function(){return this._propagationStopped||this._propagationImmediateStopped||this._isStopped()},cc.js.mixin(n,{type:"no_type",_target:null,_currentTarget:null,eventPhase:0,bubbles:!1,_propagationStopped:!1,_propagationImmediateStopped:!1,unuse:function(){this.type=cc.Event.NO_TYPE,this._target=null,this._currentTarget=null,this.eventPhase=cc.Event.NONE,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(t,e){this.type=t,this.bubbles=e||!1},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0}}),cc.js.getset(n,"target",function(){if(!this._target){var t=this._currentTarget||this._getCurrentTarget();this._target=t._entity||t}return this._target},function(t){this._target=t}),cc.js.getset(n,"currentTarget",n.getCurrentTarget,function(t){this._currentTarget=t}),cc.Event.EventCustom=function(t,e){this.target=null,this.currentTarget=null,this.eventPhase=0,this._propagationStopped=!1,this._propagationImmediateStopped=!1,this.type=t,this.bubbles=e||!1,this.detail=null},cc.js.extend(cc.Event.EventCustom,cc.Event),cc.js.mixin(cc.Event.EventCustom.prototype,{stopPropagation:function(){this._propagationStopped=!0},isStopped:function(){return this._propagationStopped||this._propagationImmediateStopped},getCurrentTarget:function(){return this.currentTarget},getType:function(){return this.type},setUserData:function(t){this.detail=t},getUserData:function(){return this.detail},getEventName:cc.Event.prototype.getType}),cc.eventManager.addListener=function(t,e){if(t instanceof cc.EventListener||(t=cc.EventListener.create(t)),"number"==typeof e){if(0===e)return void cc.log("0 priority is forbidden for fixed priority since it's used for scene graph based priority.");cc.eventManager.addEventListenerWithFixedPriority(t,e)}else{var i=e;e instanceof cc.Component&&(i=e.node._sgNode),e instanceof cc.Node&&(i=e._sgNode),cc.eventManager.addEventListenerWithSceneGraphPriority(t,i)}return t},cc.eventManager._removeListeners=cc.eventManager.removeListeners,cc.eventManager.removeListeners=function(t,e){if(t instanceof cc.Component&&(t=t.node._sgNode),t instanceof cc.Node)t=t._sgNode;else if(!(t instanceof _ccsg.Node))return;this._removeListeners(t,e||!1)},cc.eventManager._pauseTarget=cc.eventManager.pauseTarget,cc.eventManager.pauseTarget=function(t,e){var i=t;if(t._eventPaused=!0,t instanceof cc.Component)i=t.node._sgNode;else if(t instanceof cc.Node)i=t._sgNode;else if(!(i instanceof _ccsg.Node))return;if(i!==t&&!i.isRunning()){var n=i.onEnter;i.onEnter=function(){n.call(this),t._eventPaused&&cc.eventManager._pauseTarget(this,e||!1),this.onEnter=n}}this._pauseTarget(i,e||!1)},cc.eventManager._resumeTarget=cc.eventManager.resumeTarget,cc.eventManager.resumeTarget=function(t,e){if(t._eventPaused=!1,t instanceof cc.Component&&(t=t.node._sgNode),t instanceof cc.Node)t=t._sgNode;else if(!(t instanceof _ccsg.Node))return;this._resumeTarget(t,e||!1)},cc.js.mixin(cc.EventTouch.prototype,{setLocation:function(t,e){this.touch&&this.touch.setTouchInfo(this.touch.getID(),t,e)},getLocation:function(){return this.touch?this.touch.getLocation():cc.v2()},getLocationInView:function(){return this.touch?this.touch.getLocationInView():cc.v2()},getPreviousLocation:function(){return this.touch?this.touch.getPreviousLocation():cc.v2()},getStartLocation:function(){return this.touch?this.touch.getStartLocation():cc.v2()},getID:function(){return this.touch?this.touch.getID():null},getDelta:function(){return this.touch?this.touch.getDelta():cc.v2()},getDeltaX:function(){return this.touch?this.touch.getDelta().x:0},getDeltaY:function(){return this.touch?this.touch.getDelta().y:0},getLocationX:function(){return this.touch?this.touch.getLocationX():0},getLocationY:function(){return this.touch?this.touch.getLocationY():0}})},{}],169:[function(t,e,i){"use strict";cc.js.mixin(cc.game,{_paused:!1,_sceneInfos:[],_persistRootNodes:{},_ignoreRemovePersistNode:null,RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,EVENT_GAME_INITED:"game_inited",CONFIG_KEY:{width:"width",height:"height",engineDir:"engineDir",modules:"modules",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",registerSystemEvent:"registerSystemEvent",jsList:"jsList",scenes:"scenes"},pause:function(){this._paused=!0,cc.director.pause()},resume:function(){this._paused=!1,cc.director.resume()},isPaused:function(){return this._paused},prepare:function(t){var e=this,i=e.config,n=e.CONFIG_KEY;if(this._loadConfig(),this._prepared)return void(t&&t());if(!this._prepareCalled){if(cc._engineLoaded){this._prepareCalled=!0,cc.director.sharedInit();var o=i[n.jsList];return void(o?cc.loader.load(o,function(i){if(i)throw new Error(JSON.stringify(i));e._prepared=!0,e.emit(e.EVENT_GAME_INITED),t&&t()}):(e.emit(e.EVENT_GAME_INITED),t&&t()))}cc.initEngine(this.config,function(){e.prepare(t)})}},run:function(t,e){"function"==typeof t?cc.game.onStart=t:(t&&(cc.game.config=t),"function"==typeof e&&(cc.game.onStart=e)),cc.director.startAnimation(),this.prepare(cc.game.onStart&&cc.game.onStart.bind(cc.game))},addPersistRootNode:function(t){if(!(t instanceof cc.Node&&t.uuid))return void cc.warn("The target can not be made persist because it's not a cc.Node or it doesn't have _id property.");var e=t.uuid;if(!this._persistRootNodes[e]){var i=cc.director._scene;if(cc.isValid(i)){if(t.parent){if(!(t.parent instanceof cc.Scene))return void cc.warn("The node can not be made persist because it's not under root node.");if(t.parent!==i)return void cc.warn("The node can not be made persist because it's not in current scene.")}else t.parent=i;this._persistRootNodes[e]=t,t._persistNode=!0}}},removePersistRootNode:function(t){if(t!==this._ignoreRemovePersistNode){var e=t._id||"";t===this._persistRootNodes[e]&&(delete this._persistRootNodes[e],t._persistNode=!1)}},isPersistRootNode:function(t){return t._persistNode},_loadConfig:function(){if(this.config)this._initConfig(this.config);else try{var t=jsb.fileUtils.getStringFromFile("project.json"),e=JSON.parse(t);this._initConfig(e||{})}catch(i){console.log("Failed to read or parse project.json"),this._initConfig({})}},_initConfig:function(t){var e=this.CONFIG_KEY;"number"!=typeof t[e.debugMode]&&(t[e.debugMode]=0),"number"!=typeof t[e.frameRate]&&(t[e.frameRate]=60),"number"!=typeof t[e.renderMode]&&(t[e.renderMode]=0),t[e.showFPS]=e.showFPS in t?!!t[e.showFPS]:!0,t[e.engineDir]=t[e.engineDir]||"frameworks/cocos2d-html5",this.groupList=t.groupList||[],this.collisionMatrix=t.collisionMatrix||[],this._sceneInfos=t[e.scenes]||[],cc.director.setDisplayStats(t[e.showFPS]),cc.director.setAnimationInterval(1/t[e.frameRate]),cc._initDebugSetting(t[e.debugMode]),this.config=t}}),cc.EventTarget.call(cc.game),cc.js.addon(cc.game,cc.EventTarget.prototype),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.game.emit(cc.game.EVENT_HIDE,cc.game)}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.game.emit(cc.game.EVENT_SHOW,cc.game)})},{}],170:[function(t,e,i){"use strict";var n=cc.Label;!n.createWithTTF&&n.prototype.createWithTTF&&(n.createWithTTF=n.prototype.createWithTTF),n.prototype.setHorizontalAlign=n.prototype.setHorizontalAlignment,n.prototype.setVerticalAlign=n.prototype.setVerticalAlignment,n.prototype.setBMFontSize||(n.prototype.setBMFontSize=function(){}),n.prototype.getBMFontSize||(n.prototype.getBMFontSize=function(){}),n.prototype.setOverflow||(n.prototype.setOverflow=function(){}),n.prototype.getOverflow||(n.prototype.getOverflow=function(){}),n.prototype._setOverflow=n.prototype.setOverflow,n.prototype.setOverflow=function(t){this._overFlow=t,this._setOverflow(this._overFlow)},n.prototype.getOverflow=function(){return this._overFlow},n.prototype._enableBold=n.prototype.enableBold,n.prototype.enableBold=function(t){t?this._enableBold():this.disableEffect(5)},n.prototype._enableItalics=n.prototype.enableItalics,n.prototype.enableItalics=function(t){t?this._enableItalics():this.disableEffect(4)},n.prototype._enableUnderline=n.prototype.enableUnderline,n.prototype.enableUnderline=function(t){t?this._enableUnderline():this.disableEffect(6)},n.prototype.setFontSize=function(t){if(this._fontSize=t,this._labelType===_ccsg.Label.Type.SystemFont)this.setSystemFontSize(t);else if(this._labelType===_ccsg.Label.Type.BMFont)this.setBMFontSize(t);else if(this._labelType===_ccsg.Label.Type.TTF){var e=this.getTTFConfig();e.fontSize=t,this.setTTFConfig(e)}},n.prototype.getFontSize=function(){return this._fontSize},n.prototype.enableWrapText=n.prototype.enableWrap||function(){},n.prototype.isWrapTextEnabled=n.prototype.isWrapEnabled||function(){},n.prototype._setLineHeight=n.prototype.setLineHeight,n.prototype.setLineHeight=function(t){this._labelType!==_ccsg.Label.Type.SystemFont&&this._setLineHeight(t)},n.prototype._setTTFConfig=n.prototype.setTTFConfig,n.prototype.setTTFConfig=function(t){this._setTTFConfig(t),this._ttfConfig=t},n.prototype.getTTFConfig=function(){return this._ttfConfig},n.prototype.setContentSize=function(t,e){var i="number"==typeof t.width?t.width:t,n="number"==typeof t.height?t.height:e;this.getOverflow()===cc.Label.Overflow.NONE&&(i=0,n=0),this.setDimensions(i,n)},n.prototype.setFontFileOrFamily=function(t){t=t||"";var e=cc.path.extname(t);e?".ttf"===e?(this._ttfConfig||(this._ttfConfig={fontFilePath:t,fontSize:40,outlineSize:0,glyphs:0,customGlyphs:"",distanceFieldEnable:!1}),this._labelType=_ccsg.Label.Type.TTF,this._ttfConfig.fontFilePath=t,this.setTTFConfig(this._ttfConfig)):".fnt"===e&&(this._labelType=_ccsg.Label.Type.BMFont,this.setBMFontFilePath(t),this.setFontSize(this.getFontSize())):(this._labelType=_ccsg.Label.Type.SystemFont,this.setSystemFontName(t),this._isSystemFontUsed=!0),this.getContentSize()},n.prototype.setOutlined=function(t){this._outlined=!!t,this._outlined?this.enableOutline(this.getOutlineColor(),this.getOutlineWidth()):this.disableEffect(1)},n.prototype.setOutlineWidth=function(t){this._outlineWidth=t,this._outlined&&this.enableOutline(this.getOutlineColor(),this.getOutlineWidth())},n.prototype.setOutlineColor=function(t){this._outlineColor=cc.color(t),this._outlined&&this.enableOutline(this.getOutlineColor(),this.getOutlineWidth())},n.prototype.setMargin=function(){},n.prototype.isOutlined=function(){return this._outlined},n.prototype.getOutlineWidth=function(){return this._outlineWidth||1},n.prototype.getOutlineColor=function(){return this._outlineColor||cc.color(255,255,255,255)},cc.Label=function(t,e){e=e||"Arial";var i,o=cc.path.extname(e),r=_ccsg.Label.Type.TTF;if(".ttf"===o){var s={fontFilePath:e,fontSize:40,outlineSize:0,glyphs:0,customGlyphs:"",distanceFieldEnable:!1};i=n.createWithTTF(s,t,40),i._ttfConfig=s}else".fnt"===o?(i=n.createWithBMFont(e,t),r=_ccsg.Label.Type.BMFont):(i=n.createWithSystemFont(t||"",e,40),r=_ccsg.Label.Type.SystemFont,i._isSystemFontUsed=!0);return i._labelType=r,i},cc.Label.Type=cc.Enum({TTF:0,BMFont:1,SystemFont:2}),cc.Label.Overflow=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3})},{}],171:[function(t,e,i){"use strict";function n(t,e){e(null,null)}function o(e,i){var n=e.url;t(n),i(null,n)}function r(t,e){e(null,t.url)}function s(t,e){var i=t.url,n=cc.textureCache.getTextureForKey(i);n?e&&e(null,n):i.match(jsb.urlRegExp)?jsb.loadRemoteImg(i,function(t,n){t?e&&e(null,n):e&&e(new Error("Load image failed: "+i))}):cc.textureCache._addImageAsync(i,function(t){t instanceof cc.Texture2D?e&&e(null,t):e&&e(new Error("Load image failed: "+i))})}t("../cocos2d/core/load-pipeline"),cc.loader.addDownloadHandlers({js:o,jsc:o,png:n,jpg:n,bmp:n,jpeg:n,gif:n,ico:n,tiff:n,webp:n,image:n,mp3:r,ogg:r,wav:r,mp4:r,m4a:r,font:n,eot:n,ttf:n,woff:n,svg:n,ttc:n}),cc.loader.addLoadHandlers({png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:s,image:s,"default":n})},{"../cocos2d/core/load-pipeline":94}],172:[function(t,e,i){"use strict";function n(t,e){return function(i){this.getEmitterMode()===e&&t.call(this,i)}}cc.ParticleSystem.Mode=cc.Enum({GRAVITY:0,RADIUS:1}),cc.ParticleSystem.Type=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2});for(var o=[{tangentialAccel:"setTangentialAccel",tangentialAccelVar:"setTangentialAccelVar",radialAccel:"setRadialAccel",radialAccelVar:"setRadialAccelVar",rotationIsDir:"setRotationIsDir",gravity:"setGravity",speed:"setSpeed",speedVar:"setSpeedVar"},{startRadius:"setStartRadius",startRadiusVar:"setStartRadiusVar",endRadius:"setEndRadius",endRadiusVar:"setEndRadiusVar",rotatePerS:"setRotatePerSecond",rotatePerSVar:"setRotatePerSecondVar"}],r=cc.ParticleSystem.prototype,s=0;s<o.length;s++){var c=o[s];for(var a in c){var h=c[a],l=r[h];r[h]=n(l,s);var u=h.replace("set","get");cc.defineGetterSetter(r,a,r[u],r[h])}}},{}],173:[function(t,e,i){cc.initEngine(),cc.ClassManager||(cc.ClassManager=window.ClassManager||{id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}}),t("../cocos2d/core/platform/js"),t("../cocos2d/core/value-types"),t("../cocos2d/core/utils/find"),t("../cocos2d/core/utils/mutable-forward-iterator"),t("../cocos2d/core/event"),t("../cocos2d/core/event-manager/CCSystemEvent"),t("../CCDebugger"),cc._initDebugSetting(cc.game.DEBUG_MODE_INFO)},{"../CCDebugger":1,"../cocos2d/core/event":77,"../cocos2d/core/event-manager/CCSystemEvent":74,"../cocos2d/core/platform/js":116,"../cocos2d/core/utils/find":125,"../cocos2d/core/utils/mutable-forward-iterator":127,"../cocos2d/core/value-types":140}],174:[function(t,e,i){"use strict";var n=!1;cc.Scale9SpriteV2&&(n=!0,cc.Scale9Sprite=cc.Scale9SpriteV2),cc.Scale9Sprite.state={NORMAL:0,GRAY:1,DISTORTION:2},cc.Scale9Sprite.RenderingType=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3}),cc.Scale9Sprite.FillType=cc.Enum({Horizontal:0,Vertical:1,RADIAL:2});var o=cc.Scale9Sprite.prototype;if(n){var r=o.setContentSize;o.setContentSize=function(t,e){void 0!==e&&(t=new cc.Size(t,e)),r.call(this,t)};var s=o.setAnchorPoint;o.setAnchorPoint=function(t,e){void 0!==e&&(t=new cc.Vec2(t,e)),s.call(this,t)}}else o.setFillType=function(){},o.setFillCenter=function(){},o.setFillStart=function(){},o.setFillRange=function(){},o.enableTrimmedContentSize=function(){},o._lazyInit=function(){this._onceInit||(this._onceInit=!0,this._insets={left:0,right:0,top:0,bottom:0},this._trim={left:0,right:0,top:0,bottom:0},this._contentSizeTrimmed=new cc.Size(0,0),this._anchorPointTrimmed=new cc.Vec2(0,0),this._sizeAfterTrimmed=new cc.Size(0,0))},o._applyInsetsContentAnchor=function(){var t=this._renderingType||this.getRenderingType&&this.getRenderingType(),e=1,i=1;t===cc.Scale9Sprite.RenderingType.SIMPLE&&(e=this._contentSizeTrimmed.width/this._sizeAfterTrimmed.width,i=this._contentSizeTrimmed.height/this._sizeAfterTrimmed.height);var n=new cc.Size(0,0);n.width=this._contentSizeTrimmed.width+(this._trim.left+this._trim.right)*e,n.height=this._contentSizeTrimmed.height+(this._trim.top+this._trim.bottom)*i,this._setContentSize(n);var o=new cc.Vec2(0,0);o.x=this._contentSizeTrimmed.width*this._anchorPointTrimmed.x+this._trim.left*e,o.y=this._contentSizeTrimmed.height*this._anchorPointTrimmed.y+this._trim.bottom*i,o.x=o.x/n.width,o.y=o.y/n.height,this._setAnchorPoint(o);var r=new cc.Rect(0,0,0,0);r.x=this._trim.left+this._insets.left,r.y=this._trim.top+this._insets.top,r.width=this._sizeAfterTrimmed.width-this._insets.left-this._insets.right,r.height=this._sizeAfterTrimmed.height-this._insets.top-this._insets.bottom,this.setCapInsets(r)},o._setBlendFunc=o.setBlendFunc,o.setBlendFunc=function(t,e){void 0!==e&&(t={src:t,dst:e}),this._setBlendFunc&&this._setBlendFunc(t)},o._getContentSize=o.getContentSize,o.getContentSize=function(){return new cc.Size(this._contentSizeTrimmed)},o._setContentSize=o.setContentSize,o.setContentSize=function(t,e){this._lazyInit(),void 0!==e&&(t=new cc.Size(t,e)),this._contentSizeTrimmed=new cc.Size(t),this._applyInsetsContentAnchor()},o._getAnchorPoint=o.getAnchorPoint,o.getAnchorPoint=function(){return new cc.Vec2(this._anchorPointTrimmed)},o._setAnchorPoint=o.setAnchorPoint,o.setAnchorPoint=function(t,e){this._lazyInit(),void 0!==e&&(t=new cc.Vec2(t,e)),this._anchorPointTrimmed=new cc.Vec2(t),this._applyInsetsContentAnchor()},o._getInsetLeft=o.getInsetLeft,o._getInsetRight=o.getInsetRight,o._getInsetBottom=o.getInsetBottom,o._getInsetTop=o.getInsetTop,o.getInsetLeft=function(){return this._insets.left},o.getInsetRight=function(){return this._insets.right},o.getInsetBottom=function(){return this._insets.bottom},o.getInsetTop=function(){return this._insets.top},o._setInsetLeft=o.setInsetLeft,o.setInsetLeft=function(t){this._lazyInit(),this._insets.left=t,this._applyInsetsContentAnchor()},o._setInsetRight=o.setInsetRight,o.setInsetRight=function(t){this._lazyInit(),this._insets.right=t,this._applyInsetsContentAnchor()},o._setInsetTop=o.setInsetTop,o.setInsetTop=function(t){this._lazyInit(),this._insets.top=t,this._applyInsetsContentAnchor()},o._setInsetBottom=o.setInsetBottom,o.setInsetBottom=function(t){this._lazyInit(),this._insets.bottom=t,this._applyInsetsContentAnchor()},o._setSpriteFrame=o.setSpriteFrame,o.setSpriteFrame=function(t){this._lazyInit();var e=t.getOriginalSize(),i=t.getRect(),n=t.getOffset(),o=(e.width+2*n.x-i.width)/2,r=e.width-o-i.width,s=(e.height+2*n.y-i.height)/2,c=e.height-s-i.height;this._trim.left=o,this._trim.right=r,this._trim.top=c,this._trim.bottom=s,this._sizeAfterTrimmed=new cc.Size(i.width,i.height),this._setSpriteFrame(t),this._applyInsetsContentAnchor()}},{}],175:[function(t,e,i){sp._SGSkeleton=sp.Skeleton,sp._SGSkeletonAnimation=sp.SkeletonAnimation,sp._SGSkeleton.prototype.setPremultipliedAlpha=sp._SGSkeleton.prototype.setOpacityModifyRGB,sp._SGSkeleton.prototype.setOpacityModifyRGB=function(){}},{}],176:[function(t,e,i){"use strict";t("../cocos2d/core/platform/CCClass"),t("../cocos2d/core/assets/CCAsset"),cc.TextureCache.prototype._addImageAsync||(cc.TextureCache.prototype._addImageAsync=cc.TextureCache.prototype.addImageAsync),cc.TextureCache.prototype.addImageAsync=function(t,e,i){var n=null;return cc.loader.load(t,function(t,o){t&&(o=null),e&&e.call(i,o),n=o}),n},cc.TextureCache.prototype.addImage=function(t,e,i){return"function"==typeof e?this.addImageAsync(t,e,i):e?this._addImage(t,e):this._addImage(t)},cc.textureCache._textures={},cc.textureCache.cacheImage=function(t,e){e instanceof cc.Texture2D&&(this._textures[t]=e)},cc.textureCache._getTextureForKey=cc.textureCache.getTextureForKey,cc.textureCache.getTextureForKey=function(t){
var e=this._getTextureForKey(t);return e||(e=this._textures[t]),e||null},cc.textureCache._removeTextureForKey=cc.textureCache.removeTextureForKey,cc.textureCache.removeTextureForKey=function(t){this._textures[t]&&delete this._textures[t],this._removeTextureForKey(t)},cc.Class._fastDefine("cc.Texture2D",cc.Texture2D,[]),cc.Texture2D.$super=cc.RawAsset;var n=cc.Texture2D.prototype;n.isLoaded=function(){return!0},n.getPixelWidth=n.getPixelsWide,n.getPixelHeight=n.getPixelsHigh,n.description=n.getDescription,cc.js.get(n,"pixelWidth",n.getPixelWidth),cc.js.get(n,"pixelHeight",n.getPixelHeight),cc.Class._fastDefine("cc.SpriteFrame",cc.SpriteFrame,[]),cc.SpriteFrame.$super=cc.Asset,n=cc.SpriteFrame.prototype,cc.js.mixin(n,cc.EventTarget.prototype),n.textureLoaded=function(){return null!==this.getTexture()},n._ctor=function(t,e,i,n,o){this._name="",void 0!==t&&this.initWithTexture(t,e,i,n,o)},n.setTexture=function(t,e,i,n,o){e&&this.setRect(e),n&&this.setOffset(n),o&&this.setOriginalSize(o),this.setRotated(i||!1);var r=t;return cc.js.isString(t)?(this._textureFilename=t,this._loadTexture()):r instanceof cc.Texture2D&&this._refreshTexture(r),!0},n._loadTexture=function(){if(this._textureFilename){var t=cc.textureCache.addImage(this._textureFilename);this._refreshTexture(t)}},n.ensureLoadTexture=function(){this._texture||this._loadTexture()},n._initWithTexture=n.initWithTexture,n.initWithTexture=n.setTexture,n._refreshTexture=function(t){if(this.getTexture()!==t){var e=t.width,i=t.height,n=this.getRect();0===n.width||0===n.height?n=cc.rect(0,0,e,i):this._checkRect(t);var o=this.getOriginalSize();0!==o.width&&0!==o.height||(o=cc.size(e,i));var r=this.getOffset(),s=this.isRotated();void 0===this.insetTop&&(this.insetTop=0,this.insetBottom=0,this.insetLeft=0,this.insetRight=0),this._initWithTexture(t,n,s,r,o),this.emit("load")}},n._deserialize=function(t,e){var i=t.rect;i&&this.setRect(new cc.Rect(i[0],i[1],i[2],i[3])),t.offset&&this.setOffset(new cc.Vec2(t.offset[0],t.offset[1])),t.originalSize&&this.setOriginalSize(new cc.Size(t.originalSize[0],t.originalSize[1])),this.setRotated(1===t.rotated),this._name=t.name;var n=t.capInsets;n&&(this.insetLeft=n[0],this.insetTop=n[1],this.insetRight=n[2],this.insetBottom=n[3]);var o=t.texture;if(o){var r=e.customEnv&&e.customEnv.deferredLoadRaw,s=r?"_textureFilename":"_textureFilenameSetter";e.result.push(this,s,o)}},n._checkRect=function(t){var e=this.getRect(),i=e.x,n=e.y;this.isRotated()?(i+=e.height,n+=e.width):(i+=e.width,n+=e.height),i>t.getPixelWidth()&&cc.error(cc._LogInfos.RectWidth,t.url),n>t.getPixelHeight()&&cc.error(cc._LogInfos.RectHeight,t.url)},n._getTexture=n.getTexture,n.getTexture=function(){var t=this._getTexture();return this._texture=t,t},cc.js.set(n,"_textureFilenameSetter",function(t){this._textureFilename=t,t&&this._loadTexture()}),cc.js.getset(n,"name",function(){return this._name},function(t){this._name=t})},{"../cocos2d/core/assets/CCAsset":24,"../cocos2d/core/platform/CCClass":104}],177:[function(t,e,i){"use strict";if(!cc.runtime){var n=cc.TMXObject.prototype;cc.defineGetterSetter(n,"type",n.getType,null),cc.defineGetterSetter(n,"name",n.getObjectName,n.setObjectName),cc.defineGetterSetter(n,"id",n.getId,null),cc.defineGetterSetter(n,"gid",n.getGid,null),cc.defineGetterSetter(n,"offset",n.getOffset,null),cc.defineGetterSetter(n,"objectSize",n.getObjectSize,null),cc.defineGetterSetter(n,"objectVisible",n.getObjectVisible,null),cc.defineGetterSetter(n,"objectRotation",n.getObjectRotation,null),cc.defineGetterSetter(n,"sgNode",n.getNode,null)}},{}],178:[function(t,e,i){cc.VideoPlayer=ccui.VideoPlayer},{}],179:[function(t,e,i){cc.WebView=ccui.WebView},{}],180:[function(t,e,i){function n(t,e,i,n,o){var r={info:{url:t,suffix:i,picName:e,option:n},cb:[o]};return c.push(r),r}function o(t){for(var e=0,i=c.length;i>e;e++){var n=c[e];if(n.info.picName===t)return n}return null}function r(t){for(var e=0,i=c.length;i>e;e++){var n=c[e];if(n.info.picName===t){c.splice(e,1);break}}}function s(t,e){var i=t.url,s=cc.textureCache.getTextureForKey(i);if(s)e&&e(null,s);else if(i.match(jsb.urlRegExp)){for(var c,a,h=[".png",".jpg",".jpeg",".gif",".bmp"],l=!1,u=0;u<h.length;u++){var d=h[u];if(-1!==i.indexOf(d)){l=!0,a=d;break}}var p=t.option;p?c=cc.md5Encode(i+"cocos"+p.width+"_"+p.height):(cc.log("download default image"),c=cc.md5Encode(i)),cc.log("picName is "+c);var _=p;if(s=cc.textureCache._addImage(c),s instanceof cc.Texture2D)cc.log("loadImg find texture from cache"),e&&e(null,s);else{var f=o(c);if(f)return cc.log("the same picture is downloading"),void f.cb.push(e);f=n(i,c,a,_,e),jsb.loadRemoteImg(JSON.stringify(f.info),function(t){var n=JSON.parse(t);cc.log("callback from loadRemoteImg config is "+t);var s=o(n.picName);if(!s&&e)return void e(new Error("Load image failed: "+i),null);if(s.cb)for(var c=0;c<s.cb.length;c++){cc.log("in callback list now i is "+c);var a=null,h=null;n.isSuccess?(cc.log("begin load texture picName is "+s.info.picName),a=cc.textureCache._addImage(s.info.picName),!a instanceof cc.Texture2D&&(a=null,h=new Error("add image fail: "+i))):h=new Error("download image fail"+i);var l=s.cb[c];l?l(h,a):cc.log("ERROR: callback is null")}r(s)})}}else cc.textureCache._addImageAsync(i,function(t){t instanceof cc.Texture2D?e&&e(null,t):e&&e(new Error("Load image failed: "+i))})}var c=[];cc.loader.addLoadHandlers({png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:s,image:s}),cc.Follow.prototype._ctor=function(t,e){t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))}},{}],181:[function(t,e,i){"use strict";cc.Scheduler.prototype.unscheduleAllForTarget||(cc.Scheduler.prototype.unscheduleAllForTarget=function(t){this.unscheduleAllCallbacksForTarget(t)}),cc.Scheduler.prototype._unschedule||(cc.Scheduler.prototype._unschedule=cc.Scheduler.prototype.unscheduleCallbackForTarget),cc.SpriteFrame.prototype.initWithTexture=function(t,e,i,n,o,r){function s(t){if(t&&t.isLoaded()){var n,o;i?(n=e.x+e.height,o=e.y+e.width):(n=e.x+e.width,o=e.y+e.height),n>t.getPixelWidth()&&cc.error(cc._LogInfos.RectWidth,r),o>t.getPixelHeight()&&cc.error(cc._LogInfos.RectHeight,r)}}n=cc.p(0,0),o=o||e,i=i||!1,void 0===this.insetTop&&(this.insetTop=0,this.insetBottom=0,this.insetLeft=0,this.insetRight=0);var c;if(!t&&r){var a=cc.AssetLibrary._getAssetInfoInRuntime(r);if(!a)return void cc.error('SpriteFrame: Failed to load sprite texture "%s"',r);this._textureFilename=a.url,c=cc.textureCache.addImage(a.url),this._initWithTexture(c,e,i,n,o)}else cc.js.isString(t)?(this._textureFilename=t,c=cc.textureCache.addImage(this._textureFilename),this._initWithTexture(c,e,i,n,o)):t instanceof cc.Texture2D&&(this._textureFilename="",this._initWithTexture(t,e,i,n,o));return this.emit("load"),s(this.getTexture()),!0}},{}],182:[function(t,e,i){"use strict";var n={update:function(t){cc.director.emit(cc.Director.EVENT_BEFORE_UPDATE),cc.director.emit(cc.Director.EVENT_COMPONENT_UPDATE,t)}};cc.Director.getInstance().getScheduler().scheduleUpdateForTarget(n,-1e3,!1)},{}],183:[function(t,e,i){"use strict";cc.Scale9Sprite.prototype.setRenderingType=function(t){this._renderingType!==t&&(this._renderingType=t,this.isScale9Enabled()||this.setScale9Enabled(!0),t===cc.Scale9Sprite.RenderingType.SIMPLE&&(this.setInsetLeft(0),this.setInsetTop(0),this.setInsetBottom(0),this.setInsetRight(0)))}},{}],184:[function(t,e,i){},{}]},{},[161,149]);